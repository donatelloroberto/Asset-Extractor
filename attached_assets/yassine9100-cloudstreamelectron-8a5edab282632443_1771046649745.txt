Directory structure:
└── yassine9100-cloudstreamelectron/
    ├── README.md
    ├── CloudStreamElectron.sln
    ├── LICENSE
    └── CloudStreamElectron/
        ├── appsettings.Development.json
        ├── appsettings.json
        ├── build.txt
        ├── CloudStreamElectron.csproj
        ├── electron.manifest.json
        ├── Program.cs
        ├── Startup.cs
        ├── Controllers/
        │   ├── App.cs
        │   ├── CoreHolder.cs
        │   ├── HomeController.cs
        │   ├── ObjectExtensions.cs
        │   ├── ResultController.cs
        │   └── Core/
        │       ├── CoreHelpers.cs
        │       ├── AnimeProviders/
        │       │   ├── AnimeFeverBloatFreeProvider.cs
        │       │   ├── AnimeParadiseBFProvider.cs
        │       │   ├── AnimeProviderTemplate.cs
        │       │   ├── AnimeSimpleBloatFreeProvider.cs
        │       │   ├── AnimeVibeBloatFreeProvider.cs
        │       │   ├── DubbedAnimeBFProvider.cs
        │       │   ├── FourAnimeBloatFreeProvider.cs
        │       │   ├── NineAnimeBloatFreeProvider.cs
        │       │   ├── ShiroBFProvider.cs
        │       │   ├── TheMovieBloatFreeProvider.cs
        │       │   ├── TwistMoeBloatFreeProvider.cs
        │       │   └── YugenaniBFProvider.cs
        │       ├── BaseProviders/
        │       │   ├── AnimeFeverBaseProvider.cs
        │       │   ├── DubbedAnimeBaseProvider.cs
        │       │   ├── ShiroBaseProvider.cs
        │       │   └── YugenaniBaseProvider.cs
        │       └── MovieProviders/
        │           ├── DubbedAnimeMovieProvider.cs
        │           ├── Embed2Provider.cs
        │           ├── FilesClubProvider.cs
        │           ├── GomoStreamBFProvider.cs
        │           ├── HdmProvider.cs
        │           ├── LiveMovies123BFProvider.cs
        │           ├── MonkeyStreamProvider.cs
        │           ├── ShiroMovieProvider.cs
        │           ├── TheMovieMovieBFProvider.cs
        │           ├── WatchTVBFProvider.cs
        │           └── YesMoviesBFProvider.cs
        ├── Models/
        │   └── ErrorViewModel.cs
        ├── Properties/
        │   └── launchSettings.json
        ├── Views/
        │   ├── _ViewImports.cshtml
        │   ├── _ViewStart.cshtml
        │   ├── Home/
        │   │   ├── Index.cshtml
        │   │   └── Privacy.cshtml
        │   ├── Result/
        │   │   └── Index.cshtml
        │   └── Shared/
        │       ├── _Layout.cshtml
        │       ├── _ValidationScriptsPartial.cshtml
        │       └── Error.cshtml
        ├── wwwroot/
        │   ├── css/
        │   │   ├── mainSite.css
        │   │   └── site.css
        │   ├── js/
        │   │   ├── jquery.animate-colors-min.js
        │   │   └── site.js
        │   └── lib/
        │       ├── bootstrap/
        │       │   └── LICENSE
        │       ├── jquery/
        │       │   └── LICENSE.txt
        │       ├── jquery-validation/
        │       │   └── LICENSE.md
        │       └── jquery-validation-unobtrusive/
        │           ├── jquery.validate.unobtrusive.js
        │           └── LICENSE.txt
        └── .config/
            └── dotnet-tools.json

================================================
FILE: README.md
================================================
# CloudStream 2 Electron

This is the desktop version of CloudStream 2, https://github.com/LagradOst/CloudStream-2

CloudStreamElectron uses Electron for UI, and can therefor be compiled to Windows, Mac and Linux


**Discord:**
https://discord.gg/5Hus6fM

**FEATURES:**
+ **AdFree**, No ads whatsoever
+ No tracking/analytics
+ Instant search, get results fast
+ IMDb, MAL and AniList integration

**REQUIREMENTS:**
+ VLC installed

***How it works:***

This app dosen't use a p2p connection or any private servers hosted by me, **IT IS NOT A BITTORRENT**. It takes all the links from established streaming sites by downloading the sites and extracting the useful information.

CloudStream and CloudStream 2 works in diffrent ways. CloudStream gets the links and info from the link site directly. CloudStream 2 will first search IMDb and then crossreference with the link sites and MAL to get the links. Because of this the initial loading time is a bit longer than CloudStream. Most of the relevant data is cached so the loading time is shorter when loading a title again.  

***Sites used:***

https://www.imdb.com/ (Seach, rating, trailer, recommendations and descriptions)

https://myanimelist.net/ (Only used to crossreference anime)

https://anilist.co/ (MAL Backup)

https://www.opensubtitles.org (Subtitles)

https://js.do/code (Title sharing)

**Movie/Tv-Series Sites:**

https://123files.club/

https://v2.vidsrc.me/

https://www.tvseries.video/

https://movies123.live/

https://c123movies.com/

https://on.the123movies.eu/

https://www3.watchserieshd.tv/

https://gomostream.com/

https://movies123.pro/

https://bestdubbedanime.com/

https://watchseriesfree.co/

https://www.monkeystream.net/

https://www1.kickassanime.rs/

https://lookmovie.ag/

**Anime Sites:**

https://twist.moe/

https://www.animefever.tv/

https://www1.gogoanime.movie/

https://www1.kickassanime.rs/

https://bestdubbedanime.com/

https://animeflix.io/

https://animekisa.tv/

https://kissanimefree.xyz/

https://ww1.animesimple.com/

https://vidstreaming.io/

https://watchseriesfree.co/

https://4anime.to/



================================================
FILE: CloudStreamElectron.sln
================================================
﻿
Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 16
VisualStudioVersion = 16.0.30204.135
MinimumVisualStudioVersion = 10.0.40219.1
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "CloudStreamElectron", "CloudStreamElectron\CloudStreamElectron.csproj", "{4EDAEFB4-A483-4453-B808-9F802302E1C4}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Any CPU = Debug|Any CPU
		Release|Any CPU = Release|Any CPU
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{4EDAEFB4-A483-4453-B808-9F802302E1C4}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{4EDAEFB4-A483-4453-B808-9F802302E1C4}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{4EDAEFB4-A483-4453-B808-9F802302E1C4}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{4EDAEFB4-A483-4453-B808-9F802302E1C4}.Release|Any CPU.Build.0 = Release|Any CPU
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {25FF498D-BECC-42B9-8543-5BFA64569C31}
	EndGlobalSection
EndGlobal



================================================
FILE: LICENSE
================================================
MIT License

Copyright (c) 2020 Osten

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.


================================================
FILE: CloudStreamElectron/appsettings.Development.json
================================================
{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information"
    }
  }
}



================================================
FILE: CloudStreamElectron/appsettings.json
================================================
{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information"
    }
  },
  "AllowedHosts": "*"
}



================================================
FILE: CloudStreamElectron/build.txt
================================================
taken from https://github.com/ElectronNET/Electron.NET

dotnet tool install ElectronNET.CLI -g

electronize build /target win
electronize build /target osx
electronize build /target linux 

add "/PublishReadyToRun false" if you cant compile to the target platform


================================================
FILE: CloudStreamElectron/CloudStreamElectron.csproj
================================================
﻿<Project Sdk="Microsoft.NET.Sdk.Web">
  <PropertyGroup>
    <TargetFramework>netcoreapp3.1</TargetFramework>
    <CopyRefAssembliesToPublishDirectory>false</CopyRefAssembliesToPublishDirectory>
    <UserSecretsId>38f8e64c-d9fe-4a2f-b3cf-efd1a932cb9e</UserSecretsId>
    <AssemblyName>CloudStreamElectron</AssemblyName>
    <RootNamespace>CloudStreamElectron</RootNamespace>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|AnyCPU'">
    <ErrorReport>none</ErrorReport>
    <DebugType>none</DebugType>
    <DebugSymbols>false</DebugSymbols>
  </PropertyGroup>
  <ItemGroup>
    <None Remove="Assets\Icon.png" />
    <None Remove="icon_256x.png" />
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="icon.png">
      <ExcludeFromSingleFile>true</ExcludeFromSingleFile>
      <CopyToPublishDirectory>PreserveNewest</CopyToPublishDirectory>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </EmbeddedResource>
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="icon_256x.png" />
  </ItemGroup>
  <ItemGroup>
    <None Include="wwwroot\favicon.ico" />
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="ElectronNET.API" Version="9.31.2" />
    <PackageReference Include="HtmlAgilityPack.CssSelectors.NetCore" Version="1.2.1" />
    <PackageReference Include="Jint" Version="2.11.58" />
    <PackageReference Include="Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation" Version="3.1.8" />
  </ItemGroup>
  <ItemGroup>
    <Content Update="electron.manifest.json">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </Content>
  </ItemGroup>
  <ItemGroup>
    <Folder Include="Assets\" />
  </ItemGroup>
</Project>


================================================
FILE: CloudStreamElectron/electron.manifest.json
================================================
{
	"executable": "CloudStreamElectron",
	"splashscreen": {
		"imageFile": ""
	},
	"name": "CloudStreamElectron",
	"author": "LagradOst",
	"singleInstance": false,
	"environment": "Production",
	"build": {
		"appId": "com.CloudStreamElectron.app",
		"productName": "CloudStreamElectron",
		"copyright": "Copyright © 2020",
		"buildVersion": "1.0.0",
		"compression": "maximum",
		"directories": {
			"output": "../../../bin/Desktop"
		},
		"win": {
			"icon": "../../../icon.ico"
		},
		"linux": {
			"icon": "../../../icon_256x.png"
		},
		"extraResources": [
			{
				"from": "./bin",
				"to": "bin",
				"filter": [ "**/*" ]
			}
		],
		"files": [
			{
				"from": "./ElectronHostHook/node_modules",
				"to": "ElectronHostHook/node_modules",
				"filter": [ "**/*" ]
			},
			"**/*"
		]
	}
}


================================================
FILE: CloudStreamElectron/Program.cs
================================================
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using ElectronNET.API;
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.Hosting;
using Microsoft.Extensions.Logging;

namespace CloudStreamElectron
{
    public class Program
    {
        public static void Main(string[] args)
        { 
            CreateHostBuilder(args).Build().Run();
        }

        public static IHostBuilder CreateHostBuilder(string[] args) =>
            Host.CreateDefaultBuilder(args)
                .ConfigureWebHostDefaults(webBuilder =>
                {
                    webBuilder.UseElectron(args);
                    webBuilder.UseStartup<Startup>();
                });
    }
}



================================================
FILE: CloudStreamElectron/Startup.cs
================================================
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Threading.Tasks;
using ElectronNET.API;
using ElectronNET.API.Entities;
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.HttpsPolicy;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;

namespace CloudStreamElectron
{
    public class Startup
    {
        public static bool isElectron = false; // TODO CHANGE

        public Startup(IConfiguration configuration)
        {
            Configuration = configuration;
        }

        public IConfiguration Configuration { get; }

        // This method gets called by the runtime. Use this method to add services to the container.
        public void ConfigureServices(IServiceCollection services)
        {
            services.AddControllersWithViews();
        }

        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.
        public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
        {
            if (env.IsDevelopment())
            {
                app.UseDeveloperExceptionPage();
            }
            else
            {
                app.UseExceptionHandler("/Home/Error");
                // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.
                app.UseHsts();
            }
            app.UseHttpsRedirection();
            app.UseStaticFiles();

            app.UseRouting();

            app.UseAuthorization();

            app.UseEndpoints(endpoints =>
            {
                endpoints.MapControllerRoute(
                    name: "default",
                    pattern: "{controller=Home}/{action=Index}/{id?}");
            });
            Bootstarp();
        }

        public async void Bootstarp()
        {
            isElectron = true;
            BrowserWindowOptions options = new BrowserWindowOptions() {
                DarkTheme = true,
                Center = true,
                Show = false, // SHOW WHEN LOADED
                BackgroundColor = "#111111",
                //Frame=false, // REMOVED THE BORDER
                Title = "CloudStream 2",
                Vibrancy = Vibrancy.dark,
            //    Icon = Path.Combine(Directory.GetCurrentDirectory(), "icon.ico") //This will fuck linux
                //WebPreferences = new WebPreferences() { }
            };
            var window = await Electron.WindowManager.CreateWindowAsync(options);

#if !DEBUG
            window.RemoveMenu();
#endif
            
           // window.SetAppDetails(new AppDetailsOptions() { AppIconPath = })
            window.OnReadyToShow += () =>
            {
                window.Show();
            };

            window.SetMinimumSize(1030, 600);

        }
    }
}



================================================
FILE: CloudStreamElectron/Controllers/App.cs
================================================
﻿using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using static CloudStreamForms.Core.CloudStreamCore;

public static class App
{
    public const string NEXT_AIRING = "NextAiringEpisode";

    public static int ConvertDPtoPx(int dp)
    {
        return dp;
    }

    public static void ShowToast(string toast)
    {

    }

    public static int GetSizeOfJumpOnSystem()
    {
        return 1024;
    }

    static string GetKeyPath(string folder, string name = "")
    {
        string _s = ":" + folder + "-";
        if (name != "") {
            _s += name + ":";
        }
        return _s;
    }
    static Dictionary<string, object> Properties = new Dictionary<string, object>();
    public static void SetKey(string folder, string name, object value)
    {
        string path = GetKeyPath(folder, name);
        if (Properties.ContainsKey(path)) {
            Properties[path] = value;
        }
        else {
            Properties.Add(path, value);
        }
    }

    public static T GetKey<T>(string folder, string name, T defVal)
    {
        string path = GetKeyPath(folder, name);
        return GetKey<T>(path, defVal);
    }

    public static void RemoveFolder(string folder)
    {
        List<string> keys = App.GetKeysPath(folder);
        for (int i = 0; i < keys.Count; i++) {
            RemoveKey(keys[i]);
        }
    }

    public static T GetKey<T>(string path, T defVal)
    {
        if (Properties.ContainsKey(path)) {
            return (T)Properties[path];
        }
        else {
            return defVal;
        }
    }

    public static List<T> GetKeys<T>(string folder)
    {
        List<string> keyNames = GetKeysPath(folder);

        List<T> allKeys = new List<T>();
        foreach (var key in keyNames) {
            allKeys.Add((T)Properties[key]);
        }

        return allKeys;
    }

    public static int GetKeyCount(string folder)
    {
        return GetKeysPath(folder).Count;
    }
    public static List<string> GetKeysPath(string folder)
    {
        List<string> keyNames = Properties.Keys.Where(t => t.StartsWith(GetKeyPath(folder))).ToList();
        return keyNames;
    }

    public static bool KeyExists(string folder, string name)
    {
        string path = GetKeyPath(folder, name);
        return KeyExists(path);
    }
    public static bool KeyExists(string path)
    {
        return (Properties.ContainsKey(path));
    }
    public static void RemoveKey(string folder, string name)
    {
        string path = GetKeyPath(folder, name);
        RemoveKey(path);
    }
    public static void RemoveKey(string path)
    {
        if (Properties.ContainsKey(path)) {
            Properties.Remove(path);
        }
    }
}

public static class Settings
{
    public static string NativeSubShortName = "Eng";
    public static bool UseAniList = true;
    public static bool SubtitlesEnabled = false;
    public static bool DefaultDub = true;
    public static bool CacheImdb = true;
    public static bool CacheMAL = true;
    public static bool IgnoreSSLCert = true;
    public static bool PremitM3u8Download = false;
    public static bool SubtitlesClosedCaptioning = false;
    public static bool _IgnoreSSLCert = true;
    public static int malTimeout = 4000;

    public static bool IsProviderActive(string name)
    {
        return true;
    }
}

public static class MovieHelper
{
    public static void Shuffle<T>(this IList<T> list)
    {
        int n = list.Count;
        while (n > 1) {
            n--;
            int k = rng.Next(n + 1);
            T value = list[k];
            list[k] = list[n];
            list[n] = value;
        }
    }

    public static bool IsMovie(this MovieType mtype)
    {
        return mtype == MovieType.AnimeMovie || mtype == MovieType.Movie;
    }

    /// <summary>
    /// If is not null and is not ""
    /// </summary>
    /// <param name="s"></param>
    /// <returns></returns>
    public static bool IsClean(this string s)
    {
        return s != null && s != "";
    }


    static readonly List<Type> types = new List<Type>() { typeof(decimal), typeof(int), typeof(string), typeof(bool), typeof(double), typeof(ushort), typeof(ulong), typeof(uint), typeof(short), typeof(short), typeof(char), typeof(long), typeof(float), };

    public static string FString(this object o, string _s = "")
    {

#if RELEASE
			return "";
#endif
#if DEBUG
        if (o == null) {
            return "Null";
        }
        Type valueType = o.GetType();

        if (o is IList) {
            IList list = (o as IList);
            string s = valueType.Name + " {";
            for (int i = 0; i < list.Count; i++) {
                s += "\n	" + _s + i + ". " + list[i].FString(_s + "	");
            }
            return s + "\n" + _s + "}";
        }


        if (!types.Contains(valueType) && !valueType.IsArray && !valueType.IsEnum) {
            string s = valueType.Name + " {";
            foreach (var field in valueType.GetFields()) {
                s += ("\n	" + _s + field.Name + " => " + field.GetValue(o).FString(_s + "	"));
            }
            return s + "\n" + _s + "}";
        }
        else {
            if (valueType.IsArray) {
                int _count = 0;
                var enu = ((o) as IEnumerable).GetEnumerator();
                string s = valueType.Name + " {";
                while (enu.MoveNext()) {
                    s += "\n	" + _count + ". " + enu.Current.FString(_s + "	");
                    _count++;
                }
                return s + "\n" + _s + "}";
            }
            else if (valueType.IsEnum) {
                return valueType.GetEnumName(o);
            }
            else {
                return o.ToString();
            }
        }
#endif

    }

    public static string RString(this object o)
    {
        string s = "VALUE OF: ";
        foreach (var field in o.GetType().GetFields()) {
            s += ("\n" + field.Name + " => " + field.GetValue(o).ToString());
        }
        return s;
    }
}


================================================
FILE: CloudStreamElectron/Controllers/CoreHolder.cs
================================================
﻿using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using CloudStreamForms.Core;
namespace CloudStreamElectron.Controllers
{
	public static class CoreHolder
	{
		static Dictionary<Guid, CloudStreamCore> cores = new Dictionary<Guid, CloudStreamCore>();

		static Guid GenerateCore()
		{
			CloudStreamCore _core = new CloudStreamCore();
			Guid _guid = Guid.NewGuid();
			cores.Add(_guid, _core);
			return _guid;
		}

		public static Guid CheckGuid(string guid)
		{
			if(guid.IsClean()) {
				bool succ = Guid.TryParse(guid, out Guid g);
				if(succ) {
					return CheckGuid(g);
				}
				else {
					return GenerateCore();
				}
			}
			else {
				return GenerateCore();
			}
		}


		public static Guid CheckGuid(Guid? guid)
		{
			if (guid == null) return GenerateCore();

			var cleanGuid= (Guid)guid;
			if(cores.ContainsKey(cleanGuid)) {
				return cleanGuid;
			}
			else {
				return GenerateCore();
			}
		}

		public static CloudStreamCore GetCore(Guid g)
		{
			return cores[g];
		}

		public static CloudStreamCore GetCore(string g)
		{
			return cores[Guid.Parse(g)];
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/HomeController.cs
================================================
﻿using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Threading.Tasks;
using ElectronNET.API;
using ElectronNET.API.Entities;
using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;
using CloudStreamElectron.Models;
using static CloudStreamElectron.Controllers.StaticData;
using Newtonsoft.Json;
using CloudStreamForms.Core;
using Microsoft.AspNetCore.Http;

namespace CloudStreamElectron.Controllers
{
	public static class StaticData
	{
		public static Dictionary<Guid, CloudStreamCore> cores = new Dictionary<Guid, CloudStreamCore>();
	}

	public class HomeController : Controller
	{
		private readonly ILogger<HomeController> _logger;

		public HomeController(ILogger<HomeController> logger)
		{
			_logger = logger;
		}

		public IActionResult Index()
		{
			if (HybridSupport.IsElectronActive) {
				Electron.IpcMain.On("search", (object s) => {
					var mainWindow = Electron.WindowManager.BrowserWindows.First();
					string search = s.ToString();
					Electron.IpcMain.Send(mainWindow, "returnsearch", "Hello", "World");
					// Electron.Dialog.ShowErrorBox("dada", search);
				});
				Electron.IpcMain.On("hello", (args) => {
					//Electron.App.Quit();
				});
			}

			return View();
		} 

		[Route("Search")]
		[HttpGet]   //use or not works same
					//[ValidateAntiForgeryToken]
		public async Task<string> Search(string search, string guid)
		{
			if (search == null || search == "") return "";

			var core = CoreHolder.GetCore(guid);
			await core.QuickSearch(search, blocking: true);

			return (JsonConvert.SerializeObject(core.activeSearchResults.ToArray()));
		}

		[Route("Setup")]
		[HttpGet]   //use or not works same
					//[ValidateAntiForgeryToken]
		public IActionResult Setup(string guid)
		{
			return Json(CoreHolder.CheckGuid(guid));
			/*
			Guid guid = Guid.NewGuid();
			cores.Add(guid, new CloudStreamCore());
			return Json(guid);*/
		}

		public IActionResult Privacy()
		{
			return View();
		}

		[ResponseCache(Duration = 0, Location = ResponseCacheLocation.None, NoStore = true)]
		public IActionResult Error()
		{
			return View(new ErrorViewModel { RequestId = Activity.Current?.Id ?? HttpContext.TraceIdentifier });
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/ObjectExtensions.cs
================================================
﻿using System.Collections.Generic;
using System.Reflection;
using System.ArrayExtensions;

namespace System
{
    public static class ObjectExtensions
    {
        private static readonly MethodInfo CloneMethod = typeof(Object).GetMethod("MemberwiseClone", BindingFlags.NonPublic | BindingFlags.Instance);

        public static bool IsPrimitive(this Type type)
        {
            if (type == typeof(String)) return true;
            return (type.IsValueType & type.IsPrimitive);
        }

        public static Object Copy(this Object originalObject)
        {
            return InternalCopy(originalObject, new Dictionary<Object, Object>(new ReferenceEqualityComparer()));
        }
        private static Object InternalCopy(Object originalObject, IDictionary<Object, Object> visited)
        {
            if (originalObject == null) return null;
            var typeToReflect = originalObject.GetType();
            if (IsPrimitive(typeToReflect)) return originalObject;
            if (visited.ContainsKey(originalObject)) return visited[originalObject];
            if (typeof(Delegate).IsAssignableFrom(typeToReflect)) return null;
            var cloneObject = CloneMethod.Invoke(originalObject, null);
            if (typeToReflect.IsArray) {
                var arrayType = typeToReflect.GetElementType();
                if (IsPrimitive(arrayType) == false) {
                    Array clonedArray = (Array)cloneObject;
                    clonedArray.ForEach((array, indices) => array.SetValue(InternalCopy(clonedArray.GetValue(indices), visited), indices));
                }

            }
            visited.Add(originalObject, cloneObject);
            CopyFields(originalObject, visited, cloneObject, typeToReflect);
            RecursiveCopyBaseTypePrivateFields(originalObject, visited, cloneObject, typeToReflect);
            return cloneObject;
        }

        private static void RecursiveCopyBaseTypePrivateFields(object originalObject, IDictionary<object, object> visited, object cloneObject, Type typeToReflect)
        {
            if (typeToReflect.BaseType != null) {
                RecursiveCopyBaseTypePrivateFields(originalObject, visited, cloneObject, typeToReflect.BaseType);
                CopyFields(originalObject, visited, cloneObject, typeToReflect.BaseType, BindingFlags.Instance | BindingFlags.NonPublic, info => info.IsPrivate);
            }
        }

        private static void CopyFields(object originalObject, IDictionary<object, object> visited, object cloneObject, Type typeToReflect, BindingFlags bindingFlags = BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.FlattenHierarchy, Func<FieldInfo, bool> filter = null)
        {
            foreach (FieldInfo fieldInfo in typeToReflect.GetFields(bindingFlags)) {
                if (filter != null && filter(fieldInfo) == false) continue;
                if (IsPrimitive(fieldInfo.FieldType)) continue;
                var originalFieldValue = fieldInfo.GetValue(originalObject);
                var clonedFieldValue = InternalCopy(originalFieldValue, visited);
                fieldInfo.SetValue(cloneObject, clonedFieldValue);
            }
        }
        public static T Copy<T>(this T original)
        {
            return (T)Copy((Object)original);
        }
    }

    public class ReferenceEqualityComparer : EqualityComparer<Object>
    {
        public override bool Equals(object x, object y)
        {
            return ReferenceEquals(x, y);
        }
        public override int GetHashCode(object obj)
        {
            if (obj == null) return 0;
            return obj.GetHashCode();
        }
    }

    namespace ArrayExtensions
    {
        public static class ArrayExtensions
        {
            public static void ForEach(this Array array, Action<Array, int[]> action)
            {
                if (array.LongLength == 0) return;
                ArrayTraverse walker = new ArrayTraverse(array);
                do action(array, walker.Position);
                while (walker.Step());
            }
        }

        internal class ArrayTraverse
        {
            public int[] Position;
            private int[] maxLengths;

            public ArrayTraverse(Array array)
            {
                maxLengths = new int[array.Rank];
                for (int i = 0; i < array.Rank; ++i) {
                    maxLengths[i] = array.GetLength(i) - 1;
                }
                Position = new int[array.Rank];
            }

            public bool Step()
            {
                for (int i = 0; i < Position.Length; ++i) {
                    if (Position[i] < maxLengths[i]) {
                        Position[i]++;
                        for (int j = 0; j < i; j++) {
                            Position[j] = 0;
                        }
                        return true;
                    }
                }
                return false;
            }
        }
    }

}


================================================
FILE: CloudStreamElectron/Controllers/ResultController.cs
================================================
﻿using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Threading.Tasks;
using ElectronNET.API;
using ElectronNET.API.Entities;
using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;
using CloudStreamElectron.Models;
using static CloudStreamElectron.Controllers.StaticData;
using Newtonsoft.Json;
using System.Reflection.Metadata;
using System.Net;
using static CloudStreamForms.Core.CloudStreamCore;
using CloudStreamForms.Core;
using System.IO;
using System.Runtime.InteropServices;
using static CloudStreamElectron.Controllers.ResultHelper;
using System.Threading;

namespace CloudStreamElectron.Controllers
{
	public static class ResultHelper
	{
		public static string Bash(this string cmd, bool waitForExit = true)
		{
			var escapedArgs = cmd.Replace("\"", "\\\"");

			var process = new Process() {
				StartInfo = new ProcessStartInfo {
					FileName = "/bin/bash",
					Arguments = $"-c \"{escapedArgs}\"",
					RedirectStandardOutput = true,
					UseShellExecute = false,
					CreateNoWindow = true,
				}
			};
			process.Start();
			if (waitForExit) {
				string result = process.StandardOutput.ReadToEnd();
				process.WaitForExit();
				return result;
			}
			else {
				return "";
			}
		}

		public static void Cmd(this string cmd)
		{
			Thread t = new Thread(() => {
				cmd.CmdD(false);
			});
			t.Start();
		}

		public static void CmdCommand(this string startOptions, string filename)
		{
			try {
				Process cmd = new Process();
				cmd.StartInfo.FileName = filename;
				cmd.StartInfo.Arguments = startOptions;
				cmd.StartInfo.UseShellExecute = true;
				cmd.StartInfo.WorkingDirectory = "c:\\";
				cmd.Start();
			}
			catch (Exception _ex) {
				Console.WriteLine(_ex);
			}
		}

		public static string CmdD(this string command, bool waitForExit = true)
		{
			try {
				Console.WriteLine("Start command: " + command);
				Process cmd = new Process();
				Console.WriteLine(command);
				cmd.StartInfo.FileName = "cmd.exe";
				cmd.StartInfo.RedirectStandardInput = true;
				if (waitForExit) {
					cmd.StartInfo.RedirectStandardOutput = true;
				}
				cmd.StartInfo.CreateNoWindow = false;
				cmd.StartInfo.UseShellExecute = false;
				cmd.Start();
				cmd.StandardInput.WriteLine(command);
				//cmd.StandardInput.Flush();
				//cmd.StandardInput.Close();
				if (waitForExit) {
					cmd.WaitForExit();
					return cmd.StandardOutput.ReadToEnd();
				}
				else {
					return "";
				}
			}
			catch (Exception _ex) {
				Console.WriteLine(_ex);
				return "";
			}
		}
	}

	public class ResultController : Controller
	{
		private readonly ILogger<ResultController> _logger;

		public ResultController(ILogger<ResultController> logger)
		{
			_logger = logger;
		}

		public const string baseM3u8Name = @"mirrorlist.m3u8";
		public const string baseSubtitleName = @"mirrorlist.srt";
		public static string ConvertPathAndNameToM3U8(List<string> path, List<string> name, bool isSubtitleEnabled = false, string beforePath = "", string overrideSubtitles = null)
		{
			string _s = "#EXTM3U";
			if (isSubtitleEnabled) {
				_s += "\n";
				_s += "\n";
				//  _s += "#EXT-X-MEDIA:TYPE=SUBTITLES,GROUP-ID=\"subs\",NAME=\"English\",DEFAULT=YES,AUTOSELECT=YES,FORCED=NO,LANGUAGE=\"en\",CHARACTERISTICS=\"public.accessibility.transcribes-spoken-dialog, public.accessibility.describes-music-and-sound\",URI=" + beforePath + baseSubtitleName + "\"";
				_s += "#EXTVLCOPT:sub-file=" + (overrideSubtitles ?? (beforePath + baseSubtitleName));
				_s += "\n";
			}
			for (int i = 0; i < path.Count; i++) {
				_s += "\n#EXTINF:" + ", " + name[i].Replace("-", "").Replace("  ", " ") + "\n" + path[i]; //+ (isSubtitleEnabled ? ",SUBTITLES=\"subs\"" : "");
			}
			return _s;
		}

		static readonly bool IsLinux = RuntimeInformation.IsOSPlatform(OSPlatform.Linux);
		static readonly bool IsWindows = RuntimeInformation.IsOSPlatform(OSPlatform.Windows);
		static readonly bool IsOSX = RuntimeInformation.IsOSPlatform(OSPlatform.OSX);

		[Route("LoadPlayer")]
		[HttpGet]
		public async Task<string> LoadPlayer(int episode, string player, string guid)
		{
			try {
				await Task.Delay(100);
				if (!CloudStreamElectron.Startup.isElectron) return "is not electron";
				var core = CoreHolder.GetCore(guid);
				if (core == null) return "invalid core";
				int normalEpisode = episode == -1 ? 0 : episode - 1;
				bool isMovie = core.activeMovie.title.IsMovie;
				var cEpisode = core.activeMovie.episodes[normalEpisode];
				string id = isMovie ? core.activeMovie.title.id : cEpisode.id;

				var _link = CloudStreamCore.GetCachedLink(id).Copy();
				if (_link == null) return "no links";

				var endPath = Path.Combine(Directory.GetCurrentDirectory(), baseM3u8Name);
				if (System.IO.File.Exists(endPath)) {
					System.IO.File.Delete(endPath);
				}

				var links = _link.Value.links.Where(t => !t.isAdvancedLink);
				System.IO.File.WriteAllText(endPath, ConvertPathAndNameToM3U8(links.Select(t => t.baseUrl).ToList(), links.Select(t => t.PublicName).ToList()));

				string argu = "";

				if (player == "vlc") {
					argu = $"--fullscreen --no-loop vlc://quit";
				}
				else if (player == "mpv") {
					argu = $"--title=\"{(isMovie ? core.activeMovie.title.name : cEpisode.name)}\"";
				}

				if (IsLinux) {
					$"{player} \"{endPath}\" {argu}".Bash(false);
				}
				else if (IsWindows) {
					if (player == "mpv") {
						//$"{player} \"{endPath}\" {argu}".Cmd();
						$"\"{endPath}\" {argu}".CmdCommand(@"mpv.exe");
					}
					else if (player == "vlc") {
						$"\"{endPath}\" {argu}".CmdCommand(@"C:\Program Files\VideoLAN\VLC\vlc.exe");
					}
				}

				return "true";
			}
			catch (Exception _ex) {
				error(_ex);
				return _ex.Message;
			}
		}


		[Route("GetLoadLinks")]
		[HttpGet]   //use or not works same
					//[ValidateAntiForgeryToken]
		public async Task<string> GetLoadLinks(int episode, int season, int delay, string guid, bool isDub, bool reloadAllLinks)
		{
			try {
				error("TRYLOAD");
				var core = CoreHolder.GetCore(guid);
				if (core == null) return "";
				const int maxDelay = 60000;
				if (delay > maxDelay) delay = maxDelay;

				int normalEpisode = episode == -1 ? 0 : episode - 1;
				bool isMovie = core.activeMovie.title.IsMovie;

				string id = isMovie ? core.activeMovie.title.id : core.activeMovie.episodes[normalEpisode].id;
				if (delay > 0) {
					if (reloadAllLinks) {
						CloudStreamCore.ClearCachedLink(id);
					}
					core.GetEpisodeLink(episode, season, isDub: isDub);
					await Task.Delay(delay);
				}

				if (core.activeMovie.episodes == null && !isMovie) return "";
				var _link = CloudStreamCore.GetCachedLink(id).Copy();
				if (_link.HasValue) {
					var json = JsonConvert.SerializeObject(_link);
					return (json);
				}
				else {
					return "no links";
				}
			}
			catch {
				return "";
			}
		}

		[System.Serializable]
		struct ResultSeasonData
		{
			public List<Episode> Episodes;
			public bool subExists;
			public bool dubExists;
		}

		[Route("GetSeasons")]
		[HttpGet]   //use or not works same
					//[ValidateAntiForgeryToken]
		public async Task<string> GetSeasons(int season, string guid, bool isDub)
		{
			var core = CoreHolder.GetCore(guid);
			if (core == null) return "";

			static string GetPoster(string _poster)
			{
				return CloudStreamCore.ConvertIMDbImagesToHD(_poster, 2240, 1260, 1, false, true);
			}


			if (core.activeMovie.title.IsMovie) {
				core.GetImdbEpisodes(season);

				string poster = "";
				try {
					poster = core.activeMovie.title.trailers[0].PosterUrl;
				}
				catch (Exception) {
				}
				return JsonConvert.SerializeObject(new ResultSeasonData() {
					Episodes = new List<Episode>() {
							new Episode() {
								name = core.activeMovie.title.name,
								description = core.activeMovie.title.description,
								id = core.activeMovie.title.id,
								posterUrl = GetPoster(poster),
								rating = core.activeMovie.title.rating,
							}
						},
					dubExists = false,
					subExists = false
				});
			}


			List<Episode> episodes = null;
			bool done = false;
			void Core_EpisodesLoaded(object sender, List<Episode> e)
			{
				done = true;
				episodes = e;
				core.EpisodeLoaded -= Core_EpisodesLoaded;
			}
			core.EpisodeLoaded += Core_EpisodesLoaded;
			core.GetImdbEpisodes(season);
			while (!done) {
				await Task.Delay(50);
			}

			episodes = episodes.Select(t => {
				t.posterUrl = GetPoster(t.posterUrl);
				return t;
			}).ToList();

			bool subExists = false;
			bool dubExists = false;

			int maxEpisodes = episodes.Count;

			if (core.activeMovie.title.movieType == MovieType.Anime) {
				core.GetSubDub(season, out subExists, out dubExists);
				if (!dubExists && isDub) {
					isDub = false;
				}
				maxEpisodes = Math.Min(core.GetMaxEpisodesInAnimeSeason(season, isDub, out _), maxEpisodes);
			}

			var json = JsonConvert.SerializeObject(new ResultSeasonData() { Episodes = episodes.GetRange(0, maxEpisodes), dubExists = dubExists, subExists = subExists });
			return (json);
		}

		readonly List<string> genres = new List<string>() { "", "action", "adventure", "animation", "biography", "comedy", "crime", "drama", "family", "fantasy", "film-noir", "history", "horror", "music", "musical", "mystery", "romance", "sci-fi", "sport", "thriller", "war", "western" };
		readonly List<string> genresNames = new List<string>() { "Any", "Action", "Adventure", "Animation", "Biography", "Comedy", "Crime", "Drama", "Family", "Fantasy", "Film-Noir", "History", "Horror", "Music", "Musical", "Mystery", "Romance", "Sci-Fi", "Sport", "Thriller", "War", "Western" };

		static readonly Dictionary<int, string> cashedTop = new Dictionary<int, string>();

		[Route("FetchTop100")]
		[HttpGet]
		public async Task<string> FetchTop100(int start, bool isTop100, bool isAnime, string guid)
		{
			var core = CoreHolder.GetCore(guid);

			int casheId = (isTop100 ? 1 : 0) + (isAnime ? 20 : 10) + (start * 100);
			if (cashedTop.ContainsKey(casheId)) {
				return cashedTop[casheId];
			}
			else {
				var list = await core.FetchTop100(new List<string>() { genres[0] }, start, top100: isTop100, isAnime: isAnime, upscale: true, multi: 5);
				string _data = JsonConvert.SerializeObject(list);
				cashedTop[casheId] = _data;
				return _data;
			}
		}


		[Route("LoadTitle")]
		[HttpGet]   //use or not works same
					//[ValidateAntiForgeryToken]
		public async Task<string> LoadTitle(string _url, string guid)
		{
			_url = RemoveHtmlChars(_url);
			string url = "";
			string year = "";
			string name = "";
			_url += "&";
			url = FindHTML(_url, "url=", "&");
			year = FindHTML(_url, "year=", "&");
			name = FindHTML(_url, "name=", "&", decodeToNonHtml: true).Replace("%20", " ");

			var _g = CoreHolder.CheckGuid(guid);

			if (url != "") {
				var core = CoreHolder.GetCore(_g);
				if (core == null) return "";
				bool done = false;
				Movie m = new Movie();
				void Core_titleLoaded(object sender, Movie e)
				{
					m = e;
					// e.title.name
					done = true;
					core.TitleLoaded -= Core_titleLoaded;
				}
				core.TitleLoaded += Core_titleLoaded;
				core.GetImdbTitle(new Poster() { url = url, name = name, year = year, });

				while (!done) {
					await Task.Delay(50);
				}
				var mClone = m.Copy();
				mClone.title.hdPosterUrl = ConvertIMDbImagesToHD(mClone.title.hdPosterUrl, null, null, 2);
				mClone.title.recomended = mClone.title.recomended.Select(t => new Poster() { name = t.name, url = t.url, posterUrl = ConvertIMDbImagesToHD(t.posterUrl, 76, 113, 6) }).ToList();

				var json = JsonConvert.SerializeObject(mClone);
				json = json[0..^1];
				json += $",\"Guid\":\"{_g}\"}}";
				return json;
			}
			return _url;
			//return (JsonConvert.SerializeObject(core.activeSearchResults.ToArray()));
		}

		public IActionResult Index()
		{
			// var q = ControllerContext.HttpContext.Request.Query; 
			return View();
		}

		[ResponseCache(Duration = 0, Location = ResponseCacheLocation.None, NoStore = true)]
		public IActionResult Error()
		{
			return View(new ErrorViewModel { RequestId = Activity.Current?.Id ?? HttpContext.TraceIdentifier });
		}
	}

}



================================================
FILE: CloudStreamElectron/Controllers/Core/CoreHelpers.cs
================================================
﻿using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Text.RegularExpressions;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core
{
	public class BlotFreeProvider
	{
		[System.Serializable]
		public struct NonBloatSeasonData
		{
			public string name; // ID OF PROVIDER
			public bool SubExists => subEpisodes != null && subEpisodes.Where(t => t.IsClean()).Count() > 0;
			public bool DubExists => dubEpisodes != null && dubEpisodes.Where(t => t.IsClean()).Count() > 0;
			public List<string> subEpisodes;
			public List<string> dubEpisodes;
			public object extraData;
		}

		public class BloatFreeMovieProvider : BaseMovieProvier
		{
			public BloatFreeMovieProvider(CloudStreamCore _core) : base(_core) { }

			static readonly object metadataLock = new object();

			public override void FishMainLinkTSync(TempThread tempThread)
			{
				if (!TypeCheck()) return;
				object storedData = NullMetadata ? null : StoreData(ActiveMovie.title.IsMovie, tempThread);
				if (storedData == null && !NullMetadata) return;
				lock (metadataLock) {
					if (ActiveMovie.title.movieMetadata == null) {
						core.activeMovie.title.movieMetadata = new List<MovieMetadata>();
					}
					core.activeMovie.title.movieMetadata.Add(new MovieMetadata() { name = Name, metadata = storedData });
				}
			}

			public override void LoadLinksTSync(int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
			{
				if (!TypeCheck()) return;
				object data = GetData(ActiveMovie.title, out bool suc);
				if (suc) {
					LoadLink(data, episode, season, normalEpisode, ActiveMovie.title.IsMovie, tempThred);
				}
			}

			bool TypeCheck()
			{
				return (ActiveMovie.title.movieType == MovieType.AnimeMovie && HasAnimeMovie) || (ActiveMovie.title.movieType == MovieType.Movie && HasMovie) || (ActiveMovie.title.movieType == MovieType.TVSeries && HasTvSeries);
			}

			public virtual bool HasMovie => true;
			public virtual bool HasTvSeries => true;
			public virtual bool HasAnimeMovie => true;
			public virtual bool NullMetadata => false;

			object GetData(Title data, out bool suc)
			{
				var list = data.movieMetadata.Where(t => (string)t.name == Name).ToList();
				suc = list.Count > 0;
				return (suc ? list[0] : new MovieMetadata()).metadata;
			}

			public virtual void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
			{
				throw new NotImplementedException();
			}

			public virtual object StoreData(bool isMovie, TempThread tempThred)
			{
				throw new NotImplementedException();
			}

		}


		public class BloatFreeBaseAnimeProvider : BaseAnimeProvider
		{
			public virtual bool NullMetadata => false;

			public BloatFreeBaseAnimeProvider(CloudStreamCore _core) : base(_core) { }

			public override int GetLinkCount(int currentSeason, bool isDub, TempThread? tempThred)
			{
				int count = 0;
				try {
					for (int q = 0; q < ActiveMovie.title.MALData.seasonData[currentSeason].seasons.Count; q++) {
						var list = ActiveMovie.title.MALData.seasonData[currentSeason].seasons[q].nonBloatSeasonData.Where(t => t.name == Name).ToList();
						if (list.Count > 0) {
							var ms = list[0];
							if ((ms.DubExists && isDub) || (ms.SubExists && !isDub)) {
								List<string> episodes = isDub ? ms.dubEpisodes : ms.subEpisodes;
								int maxCount = 0;
								for (int i = 0; i < episodes.Count; i++) {
									if (episodes[i].IsClean()) {
										maxCount = i + 1;
									}
								}

								count += maxCount;//(isDub ? ms.dubEpisodes.Select(t => t.IsClean(),).Count : ms.subEpisodes.Count);
							}
						}
					}
				}
				catch (Exception) {
				}
				return count;
			}

			public NonBloatSeasonData GetData(MALSeason data, out bool suc)
			{
				var list = data.nonBloatSeasonData.Where(t => t.name == Name).ToList();
				suc = list.Count > 0;
				return suc ? list[0] : new NonBloatSeasonData();
			}

			public override void GetHasDubSub(MALSeason data, out bool dub, out bool sub)
			{
				var _data = GetData(data, out bool suc);
				if (suc) {
					dub = _data.DubExists;
					sub = _data.SubExists;
				}
				else {
					dub = false;
					sub = false;
				}
			}

			public virtual NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
			{
				throw new NotImplementedException();
			}

			public virtual object StoreData(string year, TempThread tempThred, MALData malData)
			{
				throw new NotImplementedException();
			}

			public override void FishMainLink(string year, TempThread tempThred, MALData malData)
			{
				print("FF:::: <>>");
				print("NDNDNDNND;;; " + Name + "|" + year + "|" + malData.engName);
				object storedData = NullMetadata ? null : StoreData(year, tempThred, malData);
				if (storedData == null && !NullMetadata) return;
				for (int i = 0; i < ActiveMovie.title.MALData.seasonData.Count; i++) {
					for (int q = 0; q < ActiveMovie.title.MALData.seasonData[i].seasons.Count; q++) {
						try {
							MALSeason ms;
							lock (_lock) {
								ms = ActiveMovie.title.MALData.seasonData[i].seasons[q];
								ms.season = i;
								ms.part = q + 1;
							}

							NonBloatSeasonData data = GetSeasonData(ms, tempThred, year, storedData);
							data.name = Name;

							lock (_lock) {
								ms = ActiveMovie.title.MALData.seasonData[i].seasons[q];
								if (ms.nonBloatSeasonData == null) {
									ms.nonBloatSeasonData = new List<NonBloatSeasonData>();
								}
								ms.nonBloatSeasonData.Add(data);
								ActiveMovie.title.MALData.seasonData[i].seasons[q] = ms;
							}
						}
						catch (Exception _ex) {
							print("FATAL EX IN Fish " + Name + " | " + _ex);
						}
					}
				}
			}

			public virtual void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
			{
				throw new NotImplementedException();
			}

			public override void LoadLinksTSync(int episode, int season, int normalEpisode, bool isDub, TempThread tempThred)
			{
				try {
					if ((isDub && !HasDub) || (!isDub && !HasSub)) return;

					int currentep = 0;
					print("DS::::: " + ActiveMovie.title.MALData.seasonData[season].seasons.Count);
					for (int q = 0; q < ActiveMovie.title.MALData.seasonData[season].seasons.Count; q++) {
						var ms = GetData(ActiveMovie.title.MALData.seasonData[season].seasons[q], out bool suc);
						if (suc) {
							int subEp = episode - currentep; //episode - currentep;
							if ((isDub ? ms.dubEpisodes : ms.subEpisodes) != null) {
								currentep += isDub ? ms.dubEpisodes.Count : ms.subEpisodes.Count;
								if (currentep >= episode) {
									try {
										print("LOADING LINK FOR: " + Name);
										LoadLink(isDub ? ms.dubEpisodes[subEp - 1] : ms.subEpisodes[subEp - 1], subEp, normalEpisode, tempThred, ms.extraData, isDub);
									}
									catch (Exception _ex) { print("FATAL EX IN Load: " + Name + " | " + _ex); }
								}
							}
						}
					}
				}
				catch (Exception _ex) {
					error(_ex);
				}
			}
		}
	}

	public static class CoreHelpers
	{
		///<summary>Finds the index of the first item matching an expression in an enumerable.</summary>
		///<param name="items">The enumerable to search.</param>
		///<param name="predicate">The expression to test the items against.</param>
		///<returns>The index of the first matching item, or -1 if no items match.</returns>
		public static int FindIndex<T>(this IEnumerable<T> items, Func<T, bool> predicate)
		{
			if (items == null) throw new ArgumentNullException("items");
			if (predicate == null) throw new ArgumentNullException("predicate");

			int retVal = 0;
			foreach (var item in items) {
				if (predicate(item)) return retVal;
				retVal++;
			}
			return -1;
		}
		///<summary>Finds the index of the first occurrence of an item in an enumerable.</summary>
		///<param name="items">The enumerable to search.</param>
		///<param name="item">The item to find.</param>
		///<returns>The index of the first matching item, or -1 if the item was not found.</returns>
		public static int IndexOf<T>(this IEnumerable<T> items, T item) { return items.FindIndex(i => EqualityComparer<T>.Default.Equals(item, i)); }

		public static string ConvertUnixTimeToString(long time)
		{
			return ConvertDateTimeToString(DateTimeOffset.FromUnixTimeSeconds(time).DateTime);
		}
		public static string ConvertDateTimeToString(DateTime time)
		{
			string txt = "";
			//3d 20h 37m
			var local = time.Subtract(DateTime.UtcNow);
			if (local.Days > 0) {
				txt += local.Days + "d ";
			}
			if (local.Hours > 0) {
				txt += local.Hours + "h ";
			}
			txt += local.Minutes + "m";
			return txt;
		}


		public static List<BasicLink> OrderHDLinks(this List<BasicLink> sort)
		{
			List<BasicLink> mirrorInfos = new List<BasicLink>();
			for (int i = 0; i < sortingList.Count; i++) {
				for (int q = 0; q < sort.Count; q++) {
					string name = sort[q].PublicName;
					if ($" {name} ".ToLower().Contains($" {sortingList[i]} ")) {
						mirrorInfos.Add(sort[q]);
					}
				}
			}
			for (int q = 0; q < sort.Count; q++) {
				var add = sort[q];
				if (!mirrorInfos.Contains(add)) {
					mirrorInfos.Add(add);
				}
			}
			return mirrorInfos;
		}
		/// <summary>
		/// Will return the result, if not match then null
		/// </summary>
		/// <param name="input"></param>
		/// <param name="match"></param>
		/// <param name="splitChar"></param>
		/// <param name="searchSplit"></param>
		/// <returns></returns>
		public static string[] GetStringRegex(string input, string match, char splitChar = '?', char searchSplit = ' ')
		{
			try {
				string[] splt = input.Split(searchSplit);
				string rex = "";

				foreach (var sp in splt) {
					string[] sps = sp.Split(splitChar);
					rex += $".*{sps[0]}(.*?){sps[1]}";
				}
				rex = rex.Replace("\"", "\\\"");

				var regex = new Regex(rex);
				if (regex.IsMatch(match)) {
					var mat = regex.Match(match);
					if (mat.Success) {
						string[] data = new string[mat.Groups.Count - 1];
						for (int i = 0; i < data.Length; i++) {
							data[i] = mat.Groups[i + 1].Value;
						}
						return data;
					}
				}
				return null;
			}
			catch (Exception) {
				return null;
			}
		}

		public static bool ContainsStuff<T>(this IList<T> list)
		{
			if (list == null) return false;
			if (list.Count == 0) return false;
			return true;
		}

		public static void Shuffle<T>(this IList<T> list)
		{
			int n = list.Count;
			while (n > 1) {
				n--;
				int k = rng.Next(n + 1);
				T value = list[k];
				list[k] = list[n];
				list[n] = value;
			}
		}

		public static bool IsMovie(this MovieType mtype)
		{
			return mtype == MovieType.AnimeMovie || mtype == MovieType.Movie || mtype == MovieType.YouTube;
		}

		/// <summary>
		/// If is not null and is not ""
		/// </summary>
		/// <param name="s"></param>
		/// <returns></returns>
		public static bool IsClean(this string s)
		{
			return s != null && s != "";
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/AnimeProviders/AnimeFeverBloatFreeProvider.cs
================================================
﻿using CloudStreamForms.Core.BaseProviders;
using System;
using System.Collections.Generic;
using System.Linq;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.AnimeProviders
{
	class AnimeFeverBloatFreeProvider : BloatFreeBaseAnimeProvider
	{
		readonly AnimeFeverBaseProvider helper;
		public AnimeFeverBloatFreeProvider(CloudStreamCore _core) : base(_core)
		{
			helper = new AnimeFeverBaseProvider(_core);
		}

		public override string Name => "AnimeFever";

		public override object StoreData(string year, TempThread tempThred, MALData malData)
		{
			return helper.GetSearchResults(ActiveMovie.title.name, false);
		}

		struct AnimbeFeverVideo
		{
			public string mainUrl;
			public string name;
			public List<AdvancedAudioStream> audioStreams;
		}

		public override void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			try {
				if (episodeLink != "") {
					int id = int.Parse(episodeLink);
					string d = helper.GetAnimeFeverEpisodeStream(id);
					if (d == "") return;

					string[] dSplit = d.Split('\n');
					bool nextIsVideoUrl = false;
					string videoData = "";

					Dictionary<string, AnimbeFeverVideo> streams = new Dictionary<string, AnimbeFeverVideo>();

					foreach (var _line in dSplit) {
						var line = _line.Replace(" ", "");
						if (nextIsVideoUrl) {
							nextIsVideoUrl = false;
							string[] data = CoreHelpers.GetStringRegex("BANDWIDTH=?, RESOLUTION=?, AUDIO=\"?\"", videoData);
							if (data == null) continue;
							string key = data[2];
							if (data != null) {
								if (streams.ContainsKey(key)) {
									var _stream = streams[key];
									_stream.mainUrl = line;
									_stream.name = data[1];
									streams[key] = _stream;
								}
								else {
									error("FATAL EX MISSMATCH IN ANIMEFEBEER:: " + d);
								}
							}
						}
						else {
							if (line.StartsWith("#EXT-X-STREAM-INF:BANDWIDTH")) { // VIDEO
								nextIsVideoUrl = true;
								videoData = line;
							}
							else if (line.StartsWith("#EXT-X-MEDIA:TYPE=AUDIO")) { // AUDIO
								string[] data = CoreHelpers.GetStringRegex("GROUP-ID=\"?\" NAME=\"?\" LANGUAGE=\"?\" URI=\"?\"", line);
								if (data != null) {
									string key = data[0];
									string name = data[1];
									string url = data[3];
									int prio = 0;
									if ((isDub && name.ToLower().StartsWith("eng")) || (!isDub && (name.ToLower().StartsWith("jap") || name.ToLower().StartsWith("jpn")))) {
										prio = 10;
									}

									if (streams.ContainsKey(key)) {
										streams[key].audioStreams.Add(new AdvancedAudioStream() {
											label = name,
											url = url,
											prio = prio,
										});
									}
									else {
										streams.Add(key, new AnimbeFeverVideo() {
											audioStreams = new List<AdvancedAudioStream>() {
												new AdvancedAudioStream() {
													label = name,
													url = url,
													prio = prio,
												}
											}
										});
									}
								}
							}
						}
					}

					int videoPrio = 2;
					foreach (var key in streams.Keys) {
						videoPrio++;
						var _stream = streams[key];
						BasicLink basicLink = new BasicLink() {
							isAdvancedLink = true,
							originSite = Name,
							mirror = 0,
							name = Name,
							label = _stream.name,
							typeName = "m3u8",
							baseUrl = _stream.mainUrl,
							priority = videoPrio,
							audioStreams = _stream.audioStreams,
							referer = ((string[])extraData)[normalEpisode]
						};
						AddPotentialLink(normalEpisode, basicLink);
					}
				}
			}
			catch (Exception) { }
		}

		public override NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
		{
			AnimeFeverBaseProvider.AnimeFeverSearchInfo data = (AnimeFeverBaseProvider.AnimeFeverSearchInfo)storedData;
			NonBloatSeasonData setData = new NonBloatSeasonData() { dubEpisodes = new List<string>(), subEpisodes = new List<string>() };
			foreach (var subData in data.data) {
				if (subData.name == ms.engName || subData.alt_name == ms.engName) {
					try {
						var mainInfo = helper.GetAnimeFeverEpisodeInfo(subData.id, subData.slug);
						if (mainInfo == null) continue;
						var _mainInfo = mainInfo.Value;

						var emtyList = new string[_mainInfo.data.Count].ToList();
						var referers = new string[_mainInfo.data.Count];
						int index = 0;
						setData.dubEpisodes = emtyList;
						setData.subEpisodes = emtyList;
						foreach (var epInfo in _mainInfo.data) {
							var langs = epInfo.video_meta.audio_languages;
							if (langs.Contains("eng")) {
								setData.dubEpisodes[index] = (epInfo.id.ToString());
							}
							if (langs.Contains("jap")) {
								setData.subEpisodes[index] = (epInfo.id.ToString());
							}
							referers[index] = $"https://www.animefever.tv/series/{subData.id}-{subData.slug}/episode/{epInfo.id}-episode-{index + 1}-{epInfo.slug}";
							index++;
						}
						setData.extraData = referers;

					}
					catch (Exception) { }
				}
			}
			return setData;
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/AnimeProviders/AnimeParadiseBFProvider.cs
================================================
﻿using HtmlAgilityPack.CssSelectors.NetCore;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.AnimeProviders
{
	class AnimeParadiseBFProvider : BloatFreeBaseAnimeProvider
	{
		public const bool IsNewApi = true;

		public AnimeParadiseBFProvider(CloudStreamCore _core) : base(_core) { }

		public override string Name => "AnimeParadise";

		public override void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			try {
				string d = "";
#pragma warning disable
				if (!IsNewApi) {
					string main = DownloadString(episodeLink);
					if (main == "") return;

					string fileId = FindHTML(main, "fileId=", "\"");
					if (fileId == "") return;

					d = DownloadString($"https://stream.animeparadise.cc/sources?fileId={fileId}", referer: $"https://stream.animeparadise.cc/embed.html?fileId={fileId}");
				}
				else {
					d = DownloadString(episodeLink);
				}
#pragma warning restore

				if (d == "") return;
				var videos = JsonConvert.DeserializeObject<AnimeParadiseVideoFile[]>(d);
				int prio = 10;
				foreach (var video in videos) {
					AddPotentialLink(normalEpisode, video.file, "AnimeParadise", prio, video.label);
					prio--;
				}
			}
			catch (Exception _ex) {
				error(_ex);
			}
		}

#pragma warning disable CS0649
		[System.Serializable]
		public struct AnimeParadiseVideoFile
		{
			public string file;
			public string label;
			public string type;
		}
#pragma warning restore CS0649

		[System.Serializable]
		struct AnimeParadiseData
		{
			public int id;
			public bool isDub;
			public int season;
			public string name;
			public string referer;
		}

		public override object StoreData(string year, TempThread tempThred, MALData malData)
		{
			try {
				string search = malData.engName.Replace("-", " ");
				List<AnimeParadiseData> data = new List<AnimeParadiseData>();
				string searchQry = "https://animeparadise.cc/search.php?query=" + search;
				string d = DownloadString(searchQry, referer: (IsNewApi ? "https://animeparadise.cc/" : "https://animeparadise.cc/index.php"));
				if (d == "") {
					return null;
				}
				var doc = new HtmlAgilityPack.HtmlDocument();
				doc.LoadHtml(d);
				var nodes = doc.QuerySelectorAll("div.content > p");
				foreach (var item in nodes) {
					var _data = item.QuerySelector("strong > a");
					int.TryParse(_data.GetAttributeValue("href", "").Split('=')[1], out int id);
					bool isDub = item.QuerySelector("span").InnerText == "DUB";
					string name = _data.InnerText;
					int season = 1;
					for (int i = 2; i < 10; i++) {
						if (item.InnerText.Contains($"(Season {i})")) {
							season = i;
							break;
						}
					}
					if (id != 0) {
						data.Add(new AnimeParadiseData() {
							isDub = isDub,
							name = name,
							id = id,
							season = season,
							referer = searchQry,
						});
					}
				}
				return data;
			}
			catch (Exception _ex) {
				error(_ex);
				return null;
			}
		}

		public override NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
		{
			List<AnimeParadiseData> data = (List<AnimeParadiseData>)storedData;
			NonBloatSeasonData setData = new NonBloatSeasonData() { dubEpisodes = new List<string>(), subEpisodes = new List<string>() };
			foreach (var subData in data) {
				if ((setData.DubExists && subData.isDub) || (setData.SubExists && !subData.isDub)) continue;

				if (subData.season == ms.season &&
					(ToLowerAndReplace(ms.name, false).StartsWith(ToLowerAndReplace(subData.name, false)) ||
					 ToLowerAndReplace(ms.engName, false).StartsWith(ToLowerAndReplace(subData.name, false)))) { // THIS IS BECAUSE SEASON IS SEPERATED FROM NAME
					try {
						string d = DownloadString("https://animeparadise.cc/anime.php?s=" + subData.id, referer: subData.referer);
						var doc = new HtmlAgilityPack.HtmlDocument();
						doc.LoadHtml(d);
						var nodes = doc.QuerySelectorAll("h1.title");

						int lastEp = int.Parse(nodes[^1].InnerText);

						for (int i = 1; i <= lastEp; i++) {
							string s = IsNewApi ? $"https://animeparadise.cc/apis/fetchsources.php?s={subData.id}&ep={i}" : $"https://animeparadise.cc/watch.php?s={subData.id}&ep={i}";
							if (subData.isDub) {
								setData.dubEpisodes.Add(s);
							}
							else {
								setData.subEpisodes.Add(s);
							}
						}
					}
					catch (Exception _ex) {
						error(_ex);
					}
				}
			}

			return setData;
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/AnimeProviders/AnimeProviderTemplate.cs
================================================
﻿/*
using System.Collections.Generic;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.AnimeProviders
{
	class AnimeNameBloatFreeProvider : BloatFreeBaseAnimeProvider
	{
		public AnimeNameBloatFreeProvider(CloudStreamCore _core) : base(_core) { }

		public override string Name => "AnimeTemplate";

		public override void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			base.LoadLink(episodeLink, episode, normalEpisode, tempThred, extraData, isDub);
		}

		public override object StoreData(string year, TempThread tempThred, MALData malData)
		{
			return base.StoreData(year, tempThred, malData);
		}

		public override NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
		{
			List<string> data = (List<string>)storedData;
			NonBloatSeasonData setData = new NonBloatSeasonData() { dubEpisodes = new List<string>(), subEpisodes = new List<string>() };
			foreach (var subData in data) {

			}

			return setData;
		}
	}
}
*/


================================================
FILE: CloudStreamElectron/Controllers/Core/AnimeProviders/AnimeSimpleBloatFreeProvider.cs
================================================
﻿using System;
using System.Collections.Generic;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.AnimeProviders
{
	class AnimeSimpleBloatFreeProvider : BloatFreeBaseAnimeProvider
	{
		public AnimeSimpleBloatFreeProvider(CloudStreamCore _core) : base(_core) { }

		public override string Name => "AnimeSimple";

		public override void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			string d = DownloadString(episodeLink);
			string json = FindHTML(d, "var json = ", "</");
			const string lookFor = "\"id\":\"";

			while (json.Contains(lookFor)) {
				string id = FindHTML(json, lookFor, "\"");
				json = RemoveOne(json, lookFor);
				string host = FindHTML(json, "host\":\"", "\"");
				string type = FindHTML(json, "type\":\"", "\"");
				if ((type == "dubbed" && isDub) || (type == "subbed" && !isDub)) {
					if (host == "mp4upload") {
						AddMp4(id, normalEpisode, tempThred);
					}
					else if (host == "trollvid") {
						core.AddTrollvid(id, normalEpisode, episodeLink, tempThred, " Simple");
					}
					else if (host == "vidstreaming") {
						AddEpisodesFromMirrors(tempThred, DownloadString("https://vidstreaming.io//streaming.php?id=" + id), normalEpisode, "", " Simple");
					}
				}
			}
		}

		public override object StoreData(string year, TempThread tempThred, MALData malData)
		{
			return Search(malData.engName);
		}

		public override NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
		{
			List<AnimeSimpleTitle> data = (List<AnimeSimpleTitle>)storedData;
			NonBloatSeasonData setData = new NonBloatSeasonData() { dubEpisodes = new List<string>(), subEpisodes = new List<string>() };
			foreach (var subData in data) {
				if (ms.MalId == subData.malId) {
					var ep = GetAnimeSimpleEpisodes(subData.id);
					if (ep.HasValue) {
						var _val = ep.Value;
						for (int i = 0; i < _val.subbedEpisodes; i++) {
							setData.subEpisodes.Add(_val.urls[i]);
						}
						for (int i = 0; i < _val.dubbedEpisodes; i++) {
							setData.dubEpisodes.Add(_val.urls[i]);
						}
					}
				}
			}

			return setData;
		}

		public struct AnimeSimpleTitle
		{
			public int malId;
			public string title;
			public string japName;
			public string id;
		}

		public List<AnimeSimpleTitle> Search(string search)
		{
			List<AnimeSimpleTitle> titles = new List<AnimeSimpleTitle>();
			string d = DownloadString("https://ww1.animesimple.com/search?q=" + search);
			const string lookFor = "\" title=\"";
			while (d.Contains(lookFor)) {
				//string name = FindHTML(d, lookFor, "\"");
				d = RemoveOne(d, lookFor);
				string href = FindHTML(d, "href=\"", "\"");
				var _title = GetAnimeSimpleTitle(href);
				if (_title.HasValue) {
					titles.Add(_title.Value);
				}
			}
			return titles;
		}

		public AnimeSimpleTitle? GetAnimeSimpleTitle(string url)
		{
			try {
				string _d = DownloadString(url);
				if (!_d.IsClean()) return null;
				string malId = FindHTML(_d, "https://myanimelist.net/anime/", "\"");
				string title = FindHTML(_d, "media-heading\">", "<");
				string japName = FindHTML(_d, "text-muted\">", "<");
				string id = FindHTML(_d, "value=\"", "\"");
				return new AnimeSimpleTitle() { japName = japName, title = title, malId = int.Parse(malId), id = id };
			}
			catch (Exception _ex) {
				error(_ex);
				return null;
			}
		}

		public struct AnimeSimpleEpisodes
		{
			public int dubbedEpisodes;
			public int subbedEpisodes;
			public string[] urls;
		}

		AnimeSimpleEpisodes? GetAnimeSimpleEpisodes(string id)
		{
			try {
				string _d = DownloadString("https://ww1.animesimple.com/request?anime-id=" + id + "&epi-page=1&top=10000&bottom=1");
				if (!_d.IsClean()) return null;
				const string lookFor = "href=\"";

				int dubbedEpisodes = 0;
				int subbedEpisodes = 0;
				List<string> urls = new List<string>();
				while (_d.Contains(lookFor)) {
					try {
						string url = FindHTML(_d, lookFor, "\"");
						_d = RemoveOne(_d, lookFor);
						urls.Add(url);
						string subDub = FindHTML(_d, "success\">", "<");
						bool isDub = subDub.Contains("Dubbed");
						bool isSub = subDub.Contains("Subbed");

						int.TryParse(FindHTML(_d, "</i> Episode ", "<"), out int episode);
						if (episode == 0) {
							error("ANISIMPLE EPISODE::: " + _d);
						}
						else {
							if (isDub) {
								dubbedEpisodes = episode;
							}
							if (isSub) {
								subbedEpisodes = episode;
							}
						}
					}
					catch (Exception _ex) {
						error(_ex);
					}
				}
				return new AnimeSimpleEpisodes() { urls = urls.ToArray(), dubbedEpisodes = dubbedEpisodes, subbedEpisodes = subbedEpisodes };
			}
			catch (Exception _ex) {
				error(_ex);
				return null;
			}
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/AnimeProviders/AnimeVibeBloatFreeProvider.cs
================================================
﻿using HtmlAgilityPack.CssSelectors.NetCore;
using System;
using System.Collections.Generic;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.AnimeProviders
{
	class AnimeVibeBloatFreeProvider : BloatFreeBaseAnimeProvider
	{
		public AnimeVibeBloatFreeProvider(CloudStreamCore _core) : base(_core) { }

		public override string Name => "AnimeVibe";

		public override void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			string page = DownloadString(episodeLink, tempThred);
			if (!page.IsClean()) return;
			string iframe = FindHTML(page, "<iframe src=\"", "\"");
			if (iframe != "") {
				string d = DownloadString("https://animevibe.tv" + iframe);
				AddEpisodesFromMirrors(tempThred, d, normalEpisode, "", "");
			}
		}

		public override object StoreData(string year, TempThread tempThred, MALData malData)
		{
			return Search(malData.engName);
		}

		public override NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
		{
			List<AnimeVibeData> data = (List<AnimeVibeData>)storedData;
			NonBloatSeasonData setData = new NonBloatSeasonData() { dubEpisodes = new List<string>(), subEpisodes = new List<string>() };
			foreach (var subData in data) {
				if (subData.title.Contains(ms.japName)) {
					bool isDub = subData.isDub;
					if (isDub && !setData.DubExists) {
						for (int i = 1; i <= subData.maxEp; i++) {
							setData.dubEpisodes.Add(subData.href + i);
						}
					}
					else if (!setData.SubExists) {
						for (int i = 1; i <= subData.maxEp; i++) {
							setData.subEpisodes.Add(subData.href + i);
						}
					}
				}
			}
			return setData;
		}


		[Serializable]
		public struct AnimeVibeData
		{
			public string href;
			public string title;
			public bool isDub;
			public int maxEp;
		}

		private List<AnimeVibeData> Search(string search)
		{
			string searchResults = DownloadString($"https://animevibe.tv/?s={search}");
			//print(search_results);
			var doc = new HtmlAgilityPack.HtmlDocument();
			doc.LoadHtml(searchResults);
			var data = doc.QuerySelectorAll("div.blogShort");
			var list = new List<AnimeVibeData>();
			for (int i = 0; i < data.Count; i++) {
				var realName = data[i].QuerySelectorAll("div.search-ex > h6");
				var link = data[i].QuerySelectorAll("a");

				bool isDub = (link[0].InnerText.Contains("(Dub)"));
				string href = (link[0].GetAttributeValue("href", ""));
				string title = (realName[0].InnerText);
				int maxEp = (int.Parse(FindHTML(realName[3].InnerText, ":", "Episode(s)")));
				list.Add(new AnimeVibeData() {
					isDub = isDub,
					href = href,
					title = title,
					maxEp = maxEp
				});
			}
			return list;
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/AnimeProviders/DubbedAnimeBFProvider.cs
================================================
﻿using System.Collections.Generic;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;
using HtmlAgilityPack.CssSelectors.NetCore;
using HtmlAgilityPack.CssSelectors;
using static CloudStreamForms.Core.BaseProviders.DubbedAnimeBaseProvider;
using CloudStreamForms.Core.BaseProviders;
using Newtonsoft.Json;
using System;

namespace CloudStreamForms.Core.AnimeProviders
{
	class DubbedAnimeBFProvider : BloatFreeBaseAnimeProvider
	{
		readonly DubbedAnimeBaseProvider provider;
		public DubbedAnimeBFProvider(CloudStreamCore _core) : base(_core)
		{
			provider = new DubbedAnimeBaseProvider(_core);
		}

		public override string Name => "DubbedAnime";
		public override bool HasSub => false;

		public override void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			var ep = provider.GetDubbedAnimeEpisode(episodeLink, episode);
			if (ep.HasValue) {
				provider.AddMirrors(ep.Value, normalEpisode);
			}
		}

		public override object StoreData(string year, TempThread tempThred, MALData malData)
		{
			return provider.Search(ActiveMovie.title.name.Replace(".","").Replace("/","/").Replace("\'", ""));
		}

		public override NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
		{
			List<DubbedSearchItem> data = (List<DubbedSearchItem>)storedData;
			NonBloatSeasonData setData = new NonBloatSeasonData() { dubEpisodes = new List<string>(), subEpisodes = new List<string>() };
			foreach (var subData in data) {
				if (subData.isMovie) continue;
				// SEE https://bestdubbedanime.com/search/_
				string name = subData.name.ToLower();
				string baseName = ToDown(name);
				if (baseName.StartsWith(ToDown(ms.name)) || baseName.StartsWith(ToDown(ActiveMovie.title.name)) || baseName.StartsWith(ToDown(ActiveMovie.title.ogName))) {
					int season = 1;
					if (name.Contains("season 2") || name.Contains("2nd season") || name.Contains("second season") || (name.EndsWith(" 2") && !name.EndsWith("part 2"))) {
						season = 2;
					}
					else if (name.Contains("season 3") || name.Contains("3rd season") || (name.EndsWith(" 3") && !name.EndsWith("part 3"))) {
						season = 3;
					}
					if (ms.season != season) continue;
					int part = 1;
					if (name.Contains("part 2") || name.Contains("part ii")) {
						part = 2;
					}
					if (ms.part != part) continue;
					var ep = provider.GetDubbedAnimeEpisode(subData.slug, 1);
					if (!ep.HasValue) continue;

					for (int i = 0; i < ep.Value.totalEp; i++) {
						setData.dubEpisodes.Add(subData.slug);
					}
					break;
				}
			}

			return setData;
		}
	}
}


================================================
FILE: CloudStreamElectron/Controllers/Core/AnimeProviders/FourAnimeBloatFreeProvider.cs
================================================
﻿using HtmlAgilityPack.CssSelectors.NetCore;
using System;
using System.Collections.Generic;
using System.Linq;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.AnimeProviders
{
	class FourAnimeBloatFreeProvider : BloatFreeBaseAnimeProvider
	{
		public FourAnimeBloatFreeProvider(CloudStreamCore _core) : base(_core) { }
		//public override bool HasDub => false; // some are dub
		public override string Name => "4Anime";

		public override void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			if (!episodeLink.IsClean()) return;
			string d = DownloadString(episodeLink, tempThred);
			string url = FindHTML(d, "source src=\"", "\"");
			AddPotentialLink(normalEpisode, url, "4Anime GoogleVideo", 10);
		}

		[System.Serializable]
		struct FourAnimeQuickSearchItem
		{
			public string href;
			public string title;
			public string year;
		}

		public override object StoreData(string year, TempThread tempThred, MALData malData)
		{
			try {
				string search = ActiveMovie.title.name;
				string data = $"action=ajaxsearchlite_search&aslp={search}&asid=1&options=qtranslate_lang%3D0%26set_intitle%3DNone%26customset%255B%255D%3Danime";

				string d = core.PostRequest("https://4anime.to/wp-admin/admin-ajax.php", "https://4anime.to/", data);
				var doc = new HtmlAgilityPack.HtmlDocument();
				doc.LoadHtml(d);
				var items = doc.QuerySelectorAll("div.info");
				List<FourAnimeQuickSearchItem> searchItems = new List<FourAnimeQuickSearchItem>();

				foreach (var item in items) {
					try {
						var link = item.QuerySelector("> a");
						var localYear = item.QuerySelectorAll("> div > span > span > a")[1];
						searchItems.Add(new FourAnimeQuickSearchItem() {
							href = link.GetAttributeValue("href", ""),
							title = link.InnerHtml,
							year = localYear.InnerText,
						});
					}
					catch (Exception _ex) {
						error("Error EX parsing item in 4Anime: " + _ex);
					}
				}
				return searchItems;
			}
			catch (Exception _ex) {
				error("Fatal EX in 4Anime: " + _ex);
				return new List<FourAnimeQuickSearchItem>();
			}
		}

		struct FourAnimeEpisode
		{
			public int episode;
			public string href;
		}

		public override NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
		{
			try {
				List<FourAnimeQuickSearchItem> data = (List<FourAnimeQuickSearchItem>)storedData;
				NonBloatSeasonData setData = new NonBloatSeasonData() { dubEpisodes = new List<string>(), subEpisodes = new List<string>() };
				foreach (var subData in data) {
					var _title = ToLowerAndReplace(subData.title);
					if ((ms.Year == -1 || (subData.year == ms.Year.ToString())) && (
						_title == ToLowerAndReplace(ms.engName) ||
						_title == ToLowerAndReplace(ms.name) ||
						ms.synonyms.Select(t => ToLowerAndReplace(t)).Contains(_title))) { // CHECK

						string url = subData.href;
						string d = DownloadString(url, tempThread);
						if (!d.IsClean()) continue;

						bool isSub = d.Contains("/language/subbed"); // There is some dubbed anime

						if ((isSub && !setData.SubExists) || (!isSub && !setData.DubExists)) { // To prevent duplicates, first result if often right
							try {
								var doc = new HtmlAgilityPack.HtmlDocument();
								doc.LoadHtml(d);
								var episodes = doc.QuerySelectorAll("ul.episodes.range.active > li > a");
								List<FourAnimeEpisode> localEpisodes = new List<FourAnimeEpisode>();

								foreach (var f in episodes) { // This is to really make sure no offset happends, if for some reason some episode is misson
									int.TryParse(f.InnerText, out int ep);
									if (ep > 0) {
										localEpisodes.Add(new FourAnimeEpisode() {
											episode = ep,
											href = f.GetAttributeValue("href", "")
										});
									}
								}

								if (localEpisodes.Count == 0) continue;
								int maxEp = localEpisodes.OrderBy(t => -t.episode).First().episode;
								var list = new string[maxEp].ToList();
								foreach (var item in localEpisodes) {
									list[item.episode - 1] = item.href;
								}

								if (isSub) {
									setData.subEpisodes = list;
								}
								else {
									setData.dubEpisodes = list;
								}
							}
							catch (Exception _ex) {
								error(_ex);
							}
						}
					}
				}
				return setData;
			}
			catch (Exception _ex) {
				error("Fatal Ex in 4Anime Getseason: " + _ex);
				return new NonBloatSeasonData();
			}
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/AnimeProviders/NineAnimeBloatFreeProvider.cs
================================================
﻿using HtmlAgilityPack.CssSelectors.NetCore;
using System;
using System.Collections.Generic;
using System.Linq;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.AnimeProviders
{
	class NineAnimeBloatFreeProvider : BloatFreeBaseAnimeProvider
	{
		public NineAnimeBloatFreeProvider(CloudStreamCore _core) : base(_core) { }

		public override string Name => "9Anime";

		/*
		[System.Serializable]
		public struct NineAnimeEpisodeData
		{
			public int ep;
			public string href;
			public string id;
		}*/

		const string NineAnimeSite = "https://www12.9anime.to";

		public override void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			//string _id = FindHTML(episodeLink.Replace("https://www12.9anime.to/watch/",""))
			/*
            print("EPLINK: " +  episodeLink);
            string _id = FindHTML(episodeLink + "|||", ".", "|||");
            string serverResponse = DownloadString($"https://www12.9anime.to/ajax/anime/servers?id={_id}&ep=&episode={episode}");
            //        https://www12.9anime.to/ajax/anime/servers?id=o35&ep=&episode=1
            //https://www12.9anime.to/ajax/anime/episode?id=cf9327e25d861f94b949461c01e637429fae1b4e7bcf3748e670d9a6e5faa99a&mcloud=73915

            string real = FindHTML(serverResponse, "{\"html\":\"", "\"}");
            // real = real.Substring(0, real.Length - 2);
            print(real);

            var doc = new HtmlAgilityPack.HtmlDocument();
            doc.LoadHtml(real);
            var data = doc.QuerySelectorAll("div.server");

            List<NineAnimeEpisodeData> Streamtape = new List<NineAnimeEpisodeData>();
            List<NineAnimeEpisodeData> Mp4upload = new List<NineAnimeEpisodeData>();
            List<NineAnimeEpisodeData> MyCloud = new List<NineAnimeEpisodeData>();
            const string myCloudId = "28";
            const string streamtapeId = "40";
            const string mp4uploadId = "35";

            foreach (var subData in data) {

                string name = subData.GetAttributeValue("ndata-id", "");

                foreach (var selectors in subData.QuerySelectorAll("ul > li > a")) {
                    string subId = selectors.GetAttributeValue("ndata-id", "");
                    string subEp = selectors.GetAttributeValue("ndata-base", "");
                    string href = selectors.GetAttributeValue("nnhref", "");
                    int realEp = int.Parse(selectors.InnerText);
                    var storeData = new NineAnimeEpisodeData() {
                        ep = realEp,
                        href = href,
                        id = subId,
                    };

                    if (name == myCloudId) {
                        MyCloud.Add(storeData);
                    }
                    else if (name == streamtapeId) {
                        Streamtape.Add(storeData);
                    }
                    else if (name == mp4uploadId) {
                        Mp4upload.Add(storeData);
                    }

                }
            }

            try {
                string target = core.GetTarget(Mp4upload[normalEpisode].id, key, dataTs, NineAnimeSite, url);
                AddMp4(FindHTML(target, "embed-", "."), normalEpisode, tempThred);
            }
            catch (Exception) {

            }*/
			//https://mcloud.to/info/jwk993?key=de4a9ac8a73cd053b7feafaceaefef71d1ced4534285f32435edea5b6a4f3aba&site=www12.9anime.to&autostart=true
		}

		/*
		public void LoadLink2(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			string request = episodeLink.Replace(NineAnimeSite + "/watch/", "") + "/"; // /xrrj358";
			string url = NineAnimeSite + "/watch/" + request;
			string d = DownloadString(url);
			string key = core.GetMcloudKey(url);

			string dataTs = FindHTML(d, "data-ts=\"", "\"");
			string _id = FindHTML(request, ".", "/");
			// string _endId = FindHTML(request + "|||", "/", "|||");
			string _under = rng.Next(100, 999).ToString();
			// print(_id + "|" + _endId);

			string requestServer = $"{NineAnimeSite}/ajax/film/servers?id={_id}&ts={dataTs}&_={_under}"; // &episode={_endId}
			string serverResponse = DownloadString(requestServer).Replace("\\", "").Replace("  ", "");
			//   print(serverResponse);
			string real = FindHTML(serverResponse, "{\"html\":\"", "\"}");
			// real = real.Substring(0, real.Length - 2);

			var doc = new HtmlAgilityPack.HtmlDocument();
			doc.LoadHtml(real);
			var data = doc.QuerySelectorAll("div.server");

			List<NineAnimeEpisodeData> Streamtape = new List<NineAnimeEpisodeData>();
			List<NineAnimeEpisodeData> Mp4upload = new List<NineAnimeEpisodeData>();
			List<NineAnimeEpisodeData> MyCloud = new List<NineAnimeEpisodeData>();
			const string myCloudId = "28";
			const string streamtapeId = "40";
			const string mp4uploadId = "35";

			foreach (var subData in data) {

				string name = subData.GetAttributeValue("ndata-id", "");

				foreach (var selectors in subData.QuerySelectorAll("ul > li > a")) {
					string subId = selectors.GetAttributeValue("ndata-id", "");
					//string subEp = selectors.GetAttributeValue("ndata-base", "");
					string href = selectors.GetAttributeValue("nnhref", "");
					int realEp = int.Parse(selectors.InnerText);
					var storeData = new NineAnimeEpisodeData() {
						ep = realEp,
						href = href,
						id = subId,
					};

					if (name == myCloudId) {
						MyCloud.Add(storeData);
					}
					else if (name == streamtapeId) {
						Streamtape.Add(storeData);
					}
					else if (name == mp4uploadId) {
						Mp4upload.Add(storeData);
					}

				}
			}

			try {
				string target = core.GetTarget(Mp4upload[normalEpisode].id, key, dataTs, NineAnimeSite, url);
				AddMp4(FindHTML(target, "embed-", "."), normalEpisode, tempThred);
			}
			catch (Exception) {

			}

			try {
				core.AddStreamTape(Streamtape[normalEpisode].id, key, dataTs, NineAnimeSite, normalEpisode, url);
			}
			catch (Exception) {

			}

			try {
				core.AddMCloud(MyCloud[normalEpisode].id, key, dataTs, NineAnimeSite, normalEpisode, url);
			}
			catch (Exception) {

			}

		}
		*/
		public override object StoreData(string year, TempThread tempThred, MALData malData)
		{
			return Search(malData.engName);
		}

		public override NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
		{
			if (storedData == null) return new NonBloatSeasonData();

			List<NineAnimeDataSearch> data = (List<NineAnimeDataSearch>)storedData;
			if (data.Count == 0) return new NonBloatSeasonData();

			NonBloatSeasonData setData = new NonBloatSeasonData() { dubEpisodes = new List<string>(), subEpisodes = new List<string>() };
			foreach (var subData in data) {
				if (subData.names.Split(' ').Contains(ms.japName) || subData.title == ms.engName) {
					bool isDub = subData.isDub;
					if (isDub && !setData.DubExists) {
						for (int i = 1; i <= subData.maxEp; i++) {
							setData.dubEpisodes.Add(subData.href);
						}
					}
					else if (!setData.SubExists) {
						for (int i = 1; i <= subData.maxEp; i++) {
							setData.subEpisodes.Add(subData.href);
						}
					}
				}
			}
			return setData;
		}

		[Serializable]
		public struct NineAnimeDataSearch
		{
			public string title;
			public string names;
			public bool isDub;
			public string href;
			public int maxEp;
		}

		List<NineAnimeDataSearch> Search(string search)
		{
			List<NineAnimeDataSearch> searchData = new List<NineAnimeDataSearch>();
			try {
				string url = NineAnimeSite + "/search?keyword=" + search;
				string d = DownloadString(url);
				if (!d.IsClean()) return null;
				var doc = new HtmlAgilityPack.HtmlDocument();
				doc.LoadHtml(d);
				var data = doc.QuerySelector("ul.anime-list");
				if (data == null) return searchData;
				var items = data.QuerySelectorAll("> li > a");
				if (items == null) return searchData;
				foreach (var item in items) {
					string href = item.GetAttributeValue("href", "");
					string dataTip = item.GetAttributeValue("data-tip", "");

					if (dataTip != "") {
						string _d = DownloadString((NineAnimeSite + ("/ajax/anime/tooltip/" + dataTip).Replace("//", "/")), referer: url);
						string _ep = FindHTML(_d, "Episode", "/");
						int.TryParse(_ep, out int maxEp);
						if (maxEp != 0) { // IF NOT MOVIE 
							string otherNames = FindHTML(_d, "<label>Other names:</label>\n            <span>", "<").Replace("  ", "").Replace("\n", "").Replace(";", "");
							string title = FindHTML(_d, "data-jtitle=\"", "\"");
							bool isDub = title.Contains("(Dub)");
							searchData.Add(new NineAnimeDataSearch() { isDub = isDub, maxEp = maxEp, href = href, names = otherNames, title = title.Replace(" (Dub)", "").Replace("  ", "") });
						}
					}
				}
			}
			catch (Exception) { }
			return searchData;
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/AnimeProviders/ShiroBFProvider.cs
================================================
﻿using CloudStreamForms.Core.BaseProviders;
using System;
using System.Collections.Generic;
using System.Linq;
using static CloudStreamForms.Core.BaseProviders.ShiroBaseProvider;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.AnimeProviders
{
	class ShiroBFProvider : BloatFreeBaseAnimeProvider
	{
		public ShiroBaseProvider shiroBase;
		public string Token => shiroBase.Token;
		private string SiteUrl => shiroBase._siteUrl;
		public override string Name => shiroBase._name;

		public ShiroBFProvider(CloudStreamCore _core, string siteUrl, string name) : base(_core)
		{
			shiroBase = new ShiroBaseProvider(_core, siteUrl, name, false);
		}

		public override void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			shiroBase.LoadLink(episodeLink, normalEpisode, tempThred, isDub, ((string[])extraData)[isDub ? 1 : 0]);
		}

		public override object StoreData(string year, TempThread tempThred, MALData malData)
		{
			return shiroBase.StoreData(tempThred, malData.engName);
		}

		public override NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
		{
			List<RealShiroItem> data = (List<RealShiroItem>)storedData;
			NonBloatSeasonData setData = new NonBloatSeasonData() { dubEpisodes = new List<string>(), subEpisodes = new List<string>() };
			if (Token == "") {
				error("NO SHIRO TOKEN! AT " + nameof(GetSeasonData));
				return setData;
			}

			string[] extraData = new string[2];
			foreach (var subData in data) {
				if ((setData.DubExists && subData.isDub) || (setData.SubExists && !subData.isDub)) continue;

				bool synoExist = false;
				if (subData.synonyms != null && ms.synonyms != null && ms.synonyms.Count > 0 && subData.synonyms.Length > 0) {
					synoExist = ms.synonyms.Where(t => subData.synonyms.Contains(t)).ToArray().Length > 0;
				}

				if (ToDown(ms.engName) == ToDown(subData.name) || synoExist) {
					List<string> episodes = new List<string>();
					string slug = subData.slug;

					for (int i = 1; i <= subData.episodes; i++) {
						episodes.Add($"https://ani.api-web.site/anime-episode/slug/{slug}-episode-{i}?token={Token}");
					}

					if (subData.isDub) {
						setData.dubEpisodes = episodes;
					}
					else {
						setData.subEpisodes = episodes;
					}
					extraData[subData.isDub ? 1 : 0] = slug;
				}
			}
			setData.extraData = extraData;

			return setData;
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/AnimeProviders/TheMovieBloatFreeProvider.cs
================================================
﻿using System;
using System.Collections.Generic;
using System.Linq;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;
using static CloudStreamForms.Core.CloudStreamCore.TheMovieHelper;

namespace CloudStreamForms.Core.AnimeProviders
{
	class TheMovieBloatFreeProvider : BloatFreeBaseAnimeProvider
	{
		public TheMovieBloatFreeProvider(CloudStreamCore _core) : base(_core) { }

		public override string Name => "WatchMovies";

		public override NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
		{
			NonBloatSeasonData setData = new NonBloatSeasonData() { dubEpisodes = new List<string>(), subEpisodes = new List<string>() };

			try {
				string name = ms.name;
				var list = (List<TheMovieTitle>)storedData;

				string compare = ToDown(name, true, "");
				var end = list.Where(t => (t.href.Contains("/anime-info/")) && ToDown(t.name, true, "") == compare).OrderBy(t => { FuzzyMatch(t.name, name, out int score); return -score; }).ToArray();

				bool subExists = false;
				bool dubExists = false;
				string subUrl = "";
				string dubUrl = "";
				for (int k = 0; k < end.Length; k++) {
					if (!subExists && !end[k].isDub) {
						subExists = true;
						subUrl = end[k].href;
					}
					if (!dubExists && end[k].isDub) {
						dubExists = true;
						dubUrl = end[k].href;
					}
				}

				try {
					int maxSubbedEp = subExists ? TheMovieHelper.GetMaxEp(DownloadString(subUrl), subUrl) : 0;
					if (!GetThredActive(tempThread)) { return setData; }; // COPY UPDATE PROGRESS
					int maxDubbedEp = dubExists ? TheMovieHelper.GetMaxEp(DownloadString(dubUrl), dubUrl) : 0;
					if (!GetThredActive(tempThread)) { return setData; }; // COPY UPDATE PROGRESS 

					for (int i = 0; i < maxDubbedEp; i++) {
						setData.dubEpisodes.Add(dubUrl);
					}

					for (int i = 0; i < maxSubbedEp; i++) {
						setData.subEpisodes.Add(subUrl);
					}
					return setData;
				}
				catch (Exception _ex) {
					error("ANIME ERROROROROOR.::" + _ex);
					return setData;
				}
			}
			catch (Exception) {
				return setData;
			}
		}

		public override void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			string url = (episodeLink + "-episode-" + episode).Replace("/anime-info/", "/anime/");
			string d = DownloadString(url);
			if (!GetThredActive(tempThred)) { return; }; // COPY UPDATE PROGRESS
			AddEpisodesFromMirrors(tempThred, d, normalEpisode, "Watch", "");
			//  LookForFembedInString(tempThred, normalEpisode, d);
		}
		public override object StoreData(string year, TempThread tempThred, MALData malData)
		{
			var list = TheMovieHelper.SearchQuary(ActiveMovie.title.name, core);
			if (!GetThredActive(tempThred)) { return null; }; // COPY UPDATE PROGRESS
			return list;
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/AnimeProviders/TwistMoeBloatFreeProvider.cs
================================================
﻿using Jint;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Net;
using System.Security.Cryptography;
using System.Text;
using System.Threading;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.AnimeProviders
{
	class TwistMoeBloatFreeProvider : BloatFreeBaseAnimeProvider
	{
		static string HTMLGet(string uri, string referer, bool br = false, List<Cookie> cookies = null, List<string> keys = null, List<string> values = null)
		{
			HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);
			request.AutomaticDecompression = DecompressionMethods.GZip | DecompressionMethods.Deflate;

			request.Method = "GET";
			request.ContentType = "text/html; charset=UTF-8";
			request.UserAgent = USERAGENT;
			request.Headers.Add("Accept-Language", "en-US,en;q=0.5");
			request.Headers.Add("Accept-Encoding", "gzip, deflate");
			if (values != null) {
				for (int i = 0; i < values.Count; i++) {
					request.Headers.Add(keys[i], values[i]);//"x-access-token", "1rj2vRtegS8Y60B3w3qNZm5T2Q0TN2NR");
				}
			}
			request.Referer = referer;
			request.CookieContainer = new CookieContainer();

			if (cookies != null) {
				for (int i = 0; i < cookies.Count; i++) {
					request.CookieContainer.Add(new Uri(referer), cookies[i]);
				}
			}

			request.Headers.Add("TE", "Trailers");

			try {
				using HttpWebResponse response = (HttpWebResponse)request.GetResponse();
				if (br) {
					return "";
				}
				else {
					using Stream stream = response.GetResponseStream();
					// print("res" + response.StatusCode);
					foreach (string e in response.Headers) {
						// print("Head: " + e);
					}
					// print("LINK:" + response.GetResponseHeader("Set-Cookie"));
					using StreamReader reader = new StreamReader(stream, Encoding.UTF8);
					string result = reader.ReadToEnd();
					return result;
				}
			}
			catch (Exception) {
				return "";
			}
		}

		static string FetchMoeUrlFromSalted(string _salted)
		{
			static byte[] CreateMD5Byte(byte[] input)
			{
				using System.Security.Cryptography.MD5 md5 = System.Security.Cryptography.MD5.Create();
				byte[] hashBytes = md5.ComputeHash(input);
				return hashBytes;
			}

			static string DecryptStringFromBytes_Aes(byte[] cipherText, byte[] Key, byte[] IV)
			{
				if (cipherText == null || cipherText.Length <= 0)
					throw new ArgumentNullException("cipherText");
				if (Key == null || Key.Length <= 0)
					throw new ArgumentNullException("Key");
				if (IV == null || IV.Length <= 0)
					throw new ArgumentNullException("IV");
				string plaintext = null;
				using (Aes aesAlg = Aes.Create()) {
					aesAlg.Key = Key;
					aesAlg.IV = IV;
					aesAlg.Mode = CipherMode.CBC;
					aesAlg.Padding = PaddingMode.PKCS7;
					ICryptoTransform decryptor = aesAlg.CreateDecryptor(aesAlg.Key, aesAlg.IV);
					using MemoryStream msDecrypt = new MemoryStream(cipherText);
					using CryptoStream csDecrypt = new CryptoStream(msDecrypt, decryptor, CryptoStreamMode.Read);
					using StreamReader srDecrypt = new StreamReader(csDecrypt, Encoding.UTF8);
					plaintext = srDecrypt.ReadToEnd();
				}
				return plaintext;
			}

			static byte[] SubArray(byte[] data, int index, int length)
			{
				byte[] result = new byte[length];
				Array.Copy(data, index, result, 0, length);
				return result;
			}

			static byte[] Combine(params byte[][] arrays)
			{
				byte[] rv = new byte[arrays.Sum(a => a.Length)];
				int offset = 0;
				foreach (byte[] array in arrays) {
					System.Buffer.BlockCopy(array, 0, rv, offset, array.Length);
					offset += array.Length;
				}
				return rv;
			}

			static byte[] bytes_to_key(byte[] data, byte[] _salt, int output = 48)
			{
				data = Combine(data, _salt);
				byte[] _key = CreateMD5Byte(data);
				List<byte> final_key = _key.ToList();
				while (final_key.Count < output) {
					_key = CreateMD5Byte(Combine(_key, data));
					final_key.AddRange(_key);
				}
				return SubArray(final_key.ToArray(), 0, output);
			}
			try {
				const string KEY = "267041df55ca2b36f2e322d05ee2c9cf"; // imagine asking for the key, this post was made by the js decoder gang
				var f = System.Convert.FromBase64String(_salted);
				var salt = SubArray(f, 8, 8);
				var bytes = System.Text.Encoding.ASCII.GetBytes(KEY);
				byte[] key_iv = bytes_to_key(bytes, salt, 32 + 16);
				byte[] key = SubArray(key_iv, 0, 32);

				byte[] iv = SubArray(key_iv, 32, 16);
				return FindHTML(DecryptStringFromBytes_Aes(SubArray(f, 16, f.Length - 16), key, iv) + "|", "/", "|").Replace(" ", "%20");
			}
			catch (Exception _ex) {
				error(_ex);
				return "";
			}
		}

		public static string GetHTMLF(string url, bool en = true, string overrideReferer = null)
		{
			string html = string.Empty;

			try {
				HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
				// List<string> heads = new List<string>(); // HEADERS
				/*
                heads = HeadAdd("");
                for (int i = 0; i < heads.Count; i++) {
                    try {
                        request.Headers.Add(HeadToRes(heads[i], 0), HeadToRes(heads[i], 1));
                        print("PRO:" + HeadToRes(heads[i], 0) + ": " + HeadToRes(heads[i], 1));

                    }
                    catch (Exception) {

                    }
                }
                */
				WebHeaderCollection myWebHeaderCollection = request.Headers;
				if (en) {
					myWebHeaderCollection.Add("Accept-Language", "en;q=0.8");
				}
				request.AutomaticDecompression = DecompressionMethods.GZip;
				request.UserAgent = USERAGENT;
				request.Referer = overrideReferer ?? url;
				//request.AddRange(1212416);

				using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
				using (Stream stream = response.GetResponseStream())

				using (StreamReader reader = new StreamReader(stream)) {
					print(">>>>>>> " + response.ResponseUri);
					html = reader.ReadToEnd();
				}
				return html;
			}
			catch (Exception) {
				return "";
			}

		}

		static string tokenCook = "";
		static string openToken = "";
		static bool isFetching = false;
		static bool hasLoaded = false;
		delegate char rType(uint id);

		void Setup()
		{
			if (isFetching) return;
			if (openToken != "" && tokenCook != "") return;
			if (hasLoaded) return;
			if (!Settings.IsProviderActive(Name)) return;

			isFetching = true;
			try {
				string d = GetHTMLF("https://twist.moe/");
				string code = FindHTML(d, "<script>", "</script>").Replace("e(r);", ""); // alert(r);
				string token = "";
				string token2 = "";
				tokenCook = "";
				//code = code.Replace("String.fromCharCode", "tocharf");

				var engine = new Engine();

				engine.Execute(code);
				// engine.EvaluateExpression(new Jint.Parser.ParserException())
				/*engine.SetValue("alert", new Action<char>((a) => {
                    print(a);
                    token = a.ToString(); 
                }));*///.SetValue("log", new Action<string>((a) => { token2 = a; })); ;
				token = engine.Execute(code).GetValue("r").ToString(); ;
				char fChar = token[0];
				token = token.Replace("location.reload();", $"alert({fChar}); alertCook(doccookie);");
				string find = "+ \';path=";
				token = token.Replace(find + "" + FindHTML(token, find, "\'") + "\'", "").Replace("document.cookie=", "var doccookie=");

				var engine2 = new Engine()
						 .SetValue("alert", new Action<string>((a) => { token2 = a; })).SetValue("alertCook", new Action<string>((a) => { tokenCook = a; }));
				engine2.Execute(token);

				string _d = HTMLGet("https://twist.moe/", "https://twist.moe/", cookies: new List<Cookie>() { new Cookie() { Name = FindHTML("|" + tokenCook, "|", "="), Value = FindHTML(tokenCook + "|", "=", "|"), Expires = DateTime.Now.AddSeconds(1000) } });
				openToken = "";
				string lookFor = "<link href=\"/_nuxt/";
				while (_d.Contains(lookFor)) {
					if (openToken == "") {
						string ___d = FindHTML(_d, lookFor, "\"");
						if (___d.EndsWith(".js")) {
							string dKey = DownloadString("https://twist.moe/_nuxt/" + ___d);
							openToken = FindHTML(dKey, "x-access-token\":\"", "\"");
							//x-access-token":"
						}
					}
					_d = RemoveOne(_d, lookFor);
				}

				string allD = HTMLGet("https://twist.moe/api/anime", "https://twist.moe/", cookies: new List<Cookie>() { new Cookie() { Name = FindHTML("|" + tokenCook, "|", "="), Value = FindHTML(tokenCook + "|", "=", "|"), Expires = DateTime.Now.AddSeconds(1000) } }, keys: new List<string>() { "x-access-token" }, values: new List<string>() { openToken });
				//  print("ALLD: " + allD);
				MoeItem[] allItems = JsonConvert.DeserializeObject<MoeItem[]>(allD);
				if (allItems != null && allItems.Length > 0) {
					foreach (var item in allItems) {
						if (item.mal_id != null) {
							var slug = item.slug?.slug;
							//print("MALID: " + item.mal_id + "|" + slug);
							if (slug != null) {
								twistMoeSearch[(int)item.mal_id] = slug;
							}
						}
					}
				}
				hasLoaded = true;
			}
			catch (Exception _ex) {
				error("TWIST.MOE ERROR: " + _ex);
			}
			finally {
				isFetching = false;
			}
		}

#pragma warning disable CS0649
		public struct MoeSlug
		{
			//public int id { get; set; }
			public string slug;
			//public int anime_id { get; set; }
			//public string created_at { get; set; }
			//public string updated_at { get; set; }
		}

		public struct MoeItem
		{
			// public int id { get; set; }
			// public string title { get; set; }
			// public string alt_title { get; set; }
			// public int season { get; set; }
			// public int ongoing { get; set; }
			// public int hb_id { get; set; }
			// public string created_at { get; set; }
			// public string updated_at { get; set; }
			// public in0t hidden { get; set; }
			public int? mal_id;
			public MoeSlug? slug;
		}

		public class TwistMoeRoot
		{
			public List<MoeItem> MyArray { get; set; }
		}


		public class MoeSource
		{
			// public int id { get; set; }
			public string source;
			// public int number { get; set; }
			// public int anime_id { get; set; }
			// public string created_at { get; set; }
			// public string updated_at { get; set; }
		}
#pragma warning restore CS0649

		/// <summary>
		/// GIVEN MAL ID, RETURN SLUG
		/// </summary>
		readonly static Dictionary<int, string> twistMoeSearch = new Dictionary<int, string>();
		List<MoeSource> GetSources(string slug)
		{
			if (openToken == "" || tokenCook == "") { Setup(); }
			string d = HTMLGet($"https://twist.moe/api/anime/{slug}/sources", $"https://twist.moe/a/{slug}/1", cookies: new List<Cookie>() { new Cookie() { Name = FindHTML("|" + tokenCook, "|", "="), Value = FindHTML(tokenCook + "|", "=", "|"), Expires = DateTime.Now.AddSeconds(1000) } }, keys: new List<string>() { "x-access-token" }, values: new List<string>() { openToken });
			if (d.IsClean()) {
				return JsonConvert.DeserializeObject<List<MoeSource>>(d);
			}
			return null;
		}

		public TwistMoeBloatFreeProvider(CloudStreamCore _core) : base(_core)
		{
			if (isFetching) return;
			if (openToken != "" && tokenCook != "") return;
			if (Settings.IsProviderActive(Name)) {
				Thread t = new Thread(() => {
					Thread.Sleep(1000);
					Setup();
				});
				t.Start();
			}
		}

		public override string Name => "Twist";
		public override bool HasDub => false;
		public override bool NullMetadata => true;

		public override NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
		{
			int id = ms._MalId;
			if (twistMoeSearch.ContainsKey(id)) {
				string slug = twistMoeSearch[id];
				var sources = GetSources(slug);
				return new NonBloatSeasonData() {
					subEpisodes = sources.Select(t => t.source).ToList(),
					extraData = $"https://twist.moe/a/{slug}/1"
				};
			}
			return new NonBloatSeasonData();
		}

		public override void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			try {
				string source = FetchMoeUrlFromSalted(episodeLink);
				if (source == "") return;
				//string url = "https://twist.moe/" + source;

				AddPotentialLink(normalEpisode, new BasicLink() {
					referer = extraData.ToString(),
					originSite = Name,
					isAdvancedLink = true,
					name = "Twist.Moe",
					priority = 10,
					canNotRunInVideoplayer = true,
					baseUrl = "https://twistcdn.bunny.sh/" + source
				});
			}
			catch (Exception _ex) {
				error(_ex);
			}
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/AnimeProviders/YugenaniBFProvider.cs
================================================
﻿using CloudStreamForms.Core.BaseProviders;
using System;
using System.Collections.Generic;
using System.IO;
using System.Net;
using System.Text;
using System.Threading;
using static CloudStreamForms.Core.BaseProviders.YugenaniBaseProvider;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.AnimeProviders
{
	class YugenaniBFProvider : BloatFreeBaseAnimeProvider
	{
		readonly YugenaniBaseProvider baseProvider;

		public YugenaniBFProvider(CloudStreamCore _core) : base(_core)
		{
			if (Settings.IsProviderActive(Name)) {
				baseProvider = new YugenaniBaseProvider();
			}
		}

		public override string Name => "Yugenani";

		public override void LoadLink(string episodeLink, int episode, int normalEpisode, TempThread tempThred, object extraData, bool isDub)
		{
			if (baseProvider == null) return;
			var embed = baseProvider.GetEmbed(episodeLink);
			var embedData = baseProvider.GetEmbedData(embed);
			if (embedData.HasValue) {
				var data = embedData.Value;
				foreach (var link in data.multi) {
					AddPotentialLink(normalEpisode, link.src, "YuLink", link.size / 100, link.size >= 100 ? link.size + "p" : "");
				}

				/*foreach (var link in data.sources) { // CHECK GogoStream or StreamTape
				if (link.type.StartsWith("video/") && link.src.Length > 10) {
					print(link.src + "|");
				}
				}*/
			}
		}

		public override object StoreData(string year, TempThread tempThred, MALData malData)
		{
			if (baseProvider == null) return null;
			var res = baseProvider.SearchSite(malData.engName);
			if (res.HasValue) {
				return res.Value.query;
			}
			else {
				return null;
			}
		}

		public override NonBloatSeasonData GetSeasonData(MALSeason ms, TempThread tempThread, string year, object storedData)
		{
			YuSearchItems[] data = (YuSearchItems[])storedData;
			NonBloatSeasonData setData = new NonBloatSeasonData() { dubEpisodes = new List<string>(), subEpisodes = new List<string>() };
			if (baseProvider == null) return setData;
			int index = 0;

			foreach (var subData in data) {
				string toDownTitle = ToDown(subData.fields.title);
				if (index < 2 || ToDown(ms.name) == toDownTitle || ToDown(ms.engName) == toDownTitle || ToDown(ms.japName) == toDownTitle) { // CAN BE REMOVED, BUT MIGHT BE BLOCKED DUE TO MANY REQUESTS
					var info = baseProvider.GetYuInfo(subData.pk, subData.fields.slug);
					if (!GetThredActive(tempThread)) return setData;
					if (info.HasValue) {
						var infoVal = info.Value;
						if (infoVal.malId == ms.MalId) {
							for (int i = 0; i < infoVal.subbedEps; i++) {
								setData.subEpisodes.Add($"https://yugenani.me/watch/{subData.pk}/{subData.fields.slug}/{(i + 1)}/");
							}
							for (int i = 0; i < infoVal.dubbedEps; i++) {
								setData.dubEpisodes.Add($"https://yugenani.me/watch/{subData.pk}/{subData.fields.slug}-dub/{(i + 1)}/");
							}
							return setData;
						}
					}
				}

				index++;
			}

			return setData;
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/BaseProviders/AnimeFeverBaseProvider.cs
================================================
﻿using Newtonsoft.Json;
using System.Collections.Generic;

namespace CloudStreamForms.Core.BaseProviders
{
	public class AnimeFeverBaseProvider
	{
		public struct AnimeFeverSearchPoster
		{
			public string source;
			public int width;
			public int height;
		}

		public struct AnimeFeverSearchPoster2
		{
			public int id;
			public string disk_name;
			public int file_size;
			public string content_type;
			public object title;
			public object description;
			public string field;
			public int sort_order;
			public string created_at;
			public string updated_at;
			public string path;
			public string extension;
		}

		public struct AnimeFeverSearchLogo
		{
			public int id;
			public string disk_name;
			public int file_size;
			public string content_type;
			public object title;
			public object description;
			public string field;
			public int sort_order;
			public string created_at;
			public string updated_at;
			public string path;
			public string extension;
		}

		public struct AnimeFeverSearchDatum
		{
			public string name;
			public string alt_name;
			public int id;
			public string slug;

			/*
            public string uid;
            public object anilist_id;
            public string description;
            public object trailer;
            public string status;
            public string type;
            public int episode_count;
            public string parental_rating;
            public string release_date;
            public string end_date;
            public string broadcast;
            public string premiered;
            public string episode_at;
            public string created_at;
            public string updated_at;
            public int episodes_count;
            public bool is_collected;
            public object collection_status;*/
			public List<AnimeFeverSearchPoster> posters;
			/*
            public object backgrounds;
            public AnimeFeverSearchPoster2 poster;
            public AnimeFeverSearchLogo logo;
            public object background;*/
		}

		public struct AnimeFeverSearchInfo
		{
			//public int? current_page;
			public List<AnimeFeverSearchDatum> data;
			/*
            public string first_page_url;
            public int? from;
            public int? last_page;
            public string last_page_url;
            public object next_page_url;
            public string path;
            public int? per_page;
            public object prev_page_url;
            public int? to;
            public int? total;*/
		}

		public struct AnimeFeverEpisodeImage
		{
			/*
            public int id;
            public string disk_name;
            public int file_size;
            public string content_type;
            public object title;
            public object description;
            public string field;
            public int sort_order;
            public string created_at;
            public string updated_at;
            public string path;
            public string extension;*/
		}

		public struct AnimeFeverEpisodeVideoMeta
		{
			public List<string> audio_languages;
			public string status;
			public long download_size;
		}

		public struct AnimeFeverEpisodeDatum
		{
			public int id;
			//public string title;
			public string slug;
			public string number;
			public AnimeFeverEpisodeVideoMeta video_meta;

			/*
            public int duration;
            public AnimeFeverEpisodeImage image;
            public int is_filler;
            public int is_recap;
            public bool watched;
            public object progress;*/
		}

		public struct AnimeFeverEpisodeLinks
		{
			/*
            public string first;
            public string last;
            public object prev;
            public object next;*/
		}

		public struct AnimeFeverEpisodeMeta
		{
			/*
            public int current_page;
            public int from;
            public int last_page;
            public string path;
            public int per_page;
            public int to;
            public int total;*/
		}

		public struct AnimeFeverEpisodeInfo
		{
			public List<AnimeFeverEpisodeDatum> data;
			public AnimeFeverEpisodeLinks links;
			public AnimeFeverEpisodeMeta meta;
		}

		static readonly string[] headerValue = new string[] { "animefever", "cloudflare" };
		static readonly string[] headerName = new string[] { "AF-Access-API", "server-provider" };
		public AnimeFeverSearchInfo? GetSearchResults(string search, bool isMovie)
		{
			/*   webRequest.Headers.Add("AF-Access-API", "animefever");
            webRequest.Headers.Add("server-provider", "cloudflare");*/
			string qry = $"https://www.animefever.tv/api/anime/shows?search={search}&sortBy=name+asc&type[]={(isMovie ? "Movie" : "TV")}&hasVideos=true&hasMultiAudio=false&page=1";
			string d = core.DownloadString(qry, referer: "https://www.animefever.tv/series",
				headerName: headerName, headerValue: headerValue);
			if (d == "") {
				return null;
			}
			return JsonConvert.DeserializeObject<AnimeFeverSearchInfo>(d);
		}

		public AnimeFeverEpisodeInfo? GetAnimeFeverEpisodeInfo(int id, string slug)
		{
			string qry = $"https://www.animefever.tv/api/anime/details/episodes?id={id}-{slug}";
			string d = core.DownloadString(qry, referer: "https://www.animefever.tv/series",
				headerName: headerName, headerValue: headerValue);
			if (d == "") {
				return null;
			}
			return JsonConvert.DeserializeObject<AnimeFeverEpisodeInfo>(d);
		}

		public string GetAnimeFeverEpisodeStream(int id)
		{
			string qry = $"  https://www.animefever.tv/video/{id}/stream.m3u8";
			string d = core.DownloadString(qry, referer: "https://www.animefever.tv/series",
				headerName: headerName, headerValue: headerValue);

			return d;
		}

		readonly CloudStreamCore core;
		public AnimeFeverBaseProvider(CloudStreamCore _core)
		{
			core = _core;
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/BaseProviders/DubbedAnimeBaseProvider.cs
================================================
﻿using System.Collections.Generic;
using static CloudStreamForms.Core.CloudStreamCore;
using HtmlAgilityPack.CssSelectors.NetCore;
using Newtonsoft.Json;
using System;

namespace CloudStreamForms.Core.BaseProviders
{
	class DubbedAnimeBaseProvider : BaseProvider
	{
		public DubbedAnimeBaseProvider(CloudStreamCore _core) : base(_core) { }

#pragma warning disable CS0649

		[System.Serializable]
		public struct DubbedSearchItem
		{
			public string name;
			public string slug;
			public bool isMovie;
		}

		[System.Serializable]
		public struct DubbedAnimeEpisode
		{
			public string rowid;
			public string title;
			public string desc;
			public string status;
			public object skips;
			public int totalEp;
			public string ep;
			public int NextEp;
			public string slug;
			public string wideImg;
			public string year;
			public string showid;
			public string Epviews;
			public string TotalViews;
			public string serversHTML;
			public string preview_img;
			public string tags;
		}

		[System.Serializable]
		public struct DubbedAnimeSearchResult
		{
			public List<DubbedAnimeEpisode> anime;
			public bool error;
			public object errorMSG;
		}

		[System.Serializable]
		public struct DubbedAnimeSearchRootObject
		{
			public DubbedAnimeSearchResult result;
		}

#pragma warning restore CS0649

		/// <summary>
		/// Null if nothing found
		/// </summary>
		/// <param name="inp"></param>
		/// <returns></returns>
		public List<DubbedSearchItem> Search(string inp)
		{
			string d = DownloadString($"https://bestdubbedanime.com/search/{inp}");
			if (!d.IsClean()) return null;
			var doc = new HtmlAgilityPack.HtmlDocument();
			doc.LoadHtml(d);
			List<DubbedSearchItem> items = new List<DubbedSearchItem>();

			var hrefs = doc.QuerySelectorAll("a.resulta");
			foreach (var q in hrefs) {
				string href = q.GetAttributeValue("href", "");
				if (href == "") continue;
				var hDiv = q.QuerySelector("> div.result");
				string name = hDiv.QuerySelector("> div.titleresults").InnerText;
				var innerHt = hDiv.QuerySelector("> div.inresult").InnerHtml.Replace('\n', ' ').Replace('\r', ' ').Replace("  ", "");
				bool isMovie = innerHt.Length > 4;
				items.Add(new DubbedSearchItem() {
					isMovie = isMovie,
					name = name,
					slug = href.Replace("//bestdubbedanime.com/", ""),
				});
			}
			return items;
		}

		public void AddMirrors(DubbedAnimeEpisode dubbedEp, int normalEpisode)
		{
			string serverUrls = dubbedEp.serversHTML;

			const string sLookFor = "hl=\"";
			while (serverUrls.Contains(sLookFor)) {
				string baseUrl = FindHTML(dubbedEp.serversHTML, "hl=\"", "\"");
				string burl = "https://bestdubbedanime.com/xz/api/playeri.php?url=" + baseUrl + "&_=" + UnixTime;
				string _d = DownloadString(burl);

				string enlink = "\'";
				if (_d.Contains("<source src=\"")) {
					enlink = "\"";
				}
				string lookFor = "<source src=" + enlink;
				while (_d.Contains(lookFor)) {

					string vUrl = FindHTML(_d, lookFor, enlink);
					if (vUrl != "") {
						vUrl = "https:" + vUrl;
					}
					string label = FindHTML(_d, "label=" + enlink, enlink);
					AddPotentialLink(normalEpisode, vUrl, "DubbedAnime", 7, label.Replace("0p", "0") + "p");

					_d = RemoveOne(_d, lookFor);
					try {
						_d = RemoveOne(_d, "label=" + enlink);
					}
					catch (Exception _ex) {
						error(_ex);
					}
				}
				serverUrls = RemoveOne(serverUrls, sLookFor);
			}
		}

		/// <summary>
		/// Null eps for movies
		/// </summary>
		/// <param name="slug"></param>
		/// <param name="eps"></param>
		/// <returns></returns>
		public DubbedAnimeEpisode? GetDubbedAnimeEpisode(string slug, int? eps = null)
		{
			bool isMovie = eps == null;
			string url = "https://bestdubbedanime.com/" + (isMovie ? "movies/jsonMovie" : "xz/v3/jsonEpi") + ".php?slug=" + slug + (eps != null ? ("/" + eps) : "") + "&_=" + UnixTime;
			string d = DownloadString(url, referer: $"https://bestdubbedanime.com/{(isMovie ? "movies/" : "")}{slug}{(isMovie ? "" : $"/{eps}")}");
			var f = JsonConvert.DeserializeObject<DubbedAnimeSearchRootObject>(d, new JsonSerializerSettings() { NullValueHandling = NullValueHandling.Ignore });
			if (f.result.error) {
				return null;
			}
			else {
				try {
					return f.result.anime[0];
				}
				catch {
					return null;
				}
			}
		}

		public static List<DubbedSearchItem> movies = new List<DubbedSearchItem>();
		public static bool hasSearchedMovies = false;
		static bool isSearchingMovies = false;
		public void FishMainMovies()
		{
			//var t = core.CreateThread(2);
			core.StartThread("DubbedMoviesThread", () => {
				if (isSearchingMovies || hasSearchedMovies) return;
				isSearchingMovies = true;
				try {
					string d = DownloadString("https://bestdubbedanime.com/movies/");

					if (d != "") {
						const string lookFor = "//bestdubbedanime.com/movies/";
						while (d.Contains(lookFor)) {
							string href = FindHTML(d, lookFor, "\"");
							d = RemoveOne(d, lookFor);
							string title = FindHTML(d, "grid_item_title\">", "<");
							movies.Add(new DubbedSearchItem() {
								isMovie = true,
								name = title,
								slug = href
							});
						}
						if (movies.Count > 0) {
							hasSearchedMovies = true;
						}
					}
				}
				catch (Exception _ex) {
					error("EX IN MAINMOV: " + _ex);
				}
				finally {
					isSearchingMovies = false;
				}
			});
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/BaseProviders/ShiroBaseProvider.cs
================================================
﻿using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.BaseProviders
{
	class ShiroBaseProvider : BaseProvider
	{
		public string Token { get { return tokens.ContainsKey(_name) ? tokens[_name] : ""; } }
		static readonly Dictionary<string, string> tokens = new Dictionary<string, string>();
		static readonly Dictionary<string, bool> loadingToken = new Dictionary<string, bool>();

		public readonly string _siteUrl;
		public readonly string _name;

		private readonly bool _isMovieProvider;

		public ShiroBaseProvider(CloudStreamCore _core, string siteUrl, string name, bool isMovie) : base(_core)
		{
			_siteUrl = siteUrl;
			_name = name;
			_isMovieProvider = isMovie;

			if (!loadingToken.ContainsKey(_name)) {
				loadingToken.Add(_name, true);
				_core.StartThread("Shiro TokenThread", () => {
					tokens[_name] = GetShiroToken();
				});
			}
		}

		string GetShiroToken()
		{
			try {
				string d = DownloadString(_siteUrl);
				string js = FindHTML(d, "src=\"/static/js/main", "\"");
				string dScript = DownloadString($"{_siteUrl}/static/js/main" + js);
				return FindHTML(dScript, "token:\"", "\"");
			}
			catch (Exception _ex) {
				error(_ex);
				return "";
			}
		}

		public void LoadLink(string episodeLink, int normalEpisode, TempThread tempThred, bool isDub, string slug)
		{
			try {
				string episodeReq = DownloadString(episodeLink, referer: $"{_siteUrl}/stream/{slug}");
				var epData = JsonConvert.DeserializeObject<ShiroEpisodeRoot>(episodeReq);
				foreach (var video in epData.Data.videos) {
					string[] before = video.host switch {
						"googledrive" => new string[] { "https://ani.googledrive.stream/vidstreaming/vid-ad/" },
						"vidstream" => new string[] { "https://gogo-stream.com/ajax.php?id=", "https://ani.googledrive.stream/vidstreaming/vid/" }, //"https://gogo-stream.com/streaming.php?id=", // https://ani.googledrive.stream/vidstreaming/vid/
						_ => null,
					};
					if (before == null) continue;
					foreach (var b in before) {
						string _before = b + video.video_id;
						string _d = DownloadString(_before).Replace("\\", "");
						if (!core.GetThredActive(tempThred)) return;

						var links = GetAllFilesRegex(_d);
						foreach (var link in links) {
							AddPotentialLink(normalEpisode, link.url, $"{_name}{(video.host == "googledrive" ? " GoogleDrive" : "")}{(_isMovieProvider ? (isDub ? " (Dub)" : " (Sub)") : "")}", 15, link.label);
						}
					}
				}
			}
			catch (Exception _ex) {
				error(_ex);
			}
		}

		public List<RealShiroItem> StoreData(TempThread tempThred, string search)
		{
			try {
				if (Token == "") {
					loadingToken.Add(_name, true);
					tokens[_name] = GetShiroToken();
				}
				if (Token == "") {
					error("NO SHIRO TOKEN! AT " + nameof(StoreData) + "|" + _name);
					return null;
				}

				string shiroToken = GetShiroToken();
				string d = DownloadString($"https://ani.api-web.site/advanced?search={search}&type={(_isMovieProvider ? "movie" : "tv")}&token={shiroToken}");

				var data = JsonConvert.DeserializeObject<ShiroRoot>(d);
				var ret = data.Data.Nav.Nav[0].Items.Where(t => t.type == (_isMovieProvider ? "movie" : "TV")).Select(t => new RealShiroItem() {
					name = (t.english ?? "").Replace(" ", "") == "" ? (t.canonicalTitle ?? t.name.Replace("DUBBED", "")) : t.english,
					synonyms = t.synonyms.ToArray(),
					isDub = t.language == "dubbed",
					episodes = int.Parse(t.episodeCount),
					slug = t.slug,
					year = t.year,
				}).ToList();
				return ret;
			}
			catch (Exception _ex) {
				error(_ex);
				return null;
			}
		}

		[System.Serializable]
		public struct RealShiroItem
		{
			public string slug;
			public int episodes;
			public string name;
			public string[] synonyms;
			public bool isDub;
			public string year;
		}

#pragma warning disable CS0649
		public struct ShiroItem
		{
			//public string _id;
			public string slug;
			//public string aired;
			//public string banner;
			public string canonicalTitle;
			public string english;
			public string episodeCount;
			//public IList<string> genres;
			//public string image;
			//public string japanese;
			public string language;
			//public object latestEpisodeDate;
			public string name;
			//public string rating;
			//public string schedule;
			//public object sort;
			//public string status;
			public IList<string> synonyms;
			//public string synopsis;
			public string type;
			public string year;
		}
		public struct ShiroNav
		{
			//public string Name { get; set; }
			//public bool First { get; set; }
			//public bool Current { get; set; }
			//public bool Last { get; set; }
			//public int Index { get; set; }
			public IList<ShiroItem> Items;
			//	public bool Dotdotdot { get; set; }
			//	public bool Show { get; set; }
		}

		public struct HeadShiroNav
		{
			public int current;
			public IList<ShiroNav> Nav;
		}

		public struct ShiroData
		{
			public HeadShiroNav Nav;
		}

		public struct ShiroRoot
		{
			public string Status;
			public ShiroData Data;
		}

		public struct ShiroEpisodeRoot
		{
			//public string Status;
			public ShiroEpisodeData Data;
		}

		public struct ShiroEpisodeData
		{
			public IList<ShiroEpisodeVideo> videos;
		}

		public struct ShiroEpisodeVideo
		{
			public string host;
			public string video_id;
		}
#pragma warning restore CS0649
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/BaseProviders/YugenaniBaseProvider.cs
================================================
﻿using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.IO;
using System.Net;
using System.Text;
using System.Threading;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.BaseProviders
{
	class YugenaniBaseProvider
	{
		static string lastToken;
		static string lastCfduid;
		static bool isFetching = false;

		public YugenaniBaseProvider()
		{
			if (lastToken == null && !isFetching) {
				isFetching = true;
				Thread t = new Thread(() => {
					GetYugenaniSite("https://yugenani.me/"); // INIT
					isFetching = false;
				}) { Name = nameof(GetYugenaniSite) };
				t.Start();
			}
		}

#pragma warning disable CS0649
		public struct YuVideoMulti
		{
			public string src;
			public string type;
			public int size;
		}

		public struct YuVideoSource
		{
			public int id;
			public string name;
			public string src;
			public string type;
		}

		public struct YuVideoRoot
		{
			public string message;
			//public string thumbnail;
			public YuVideoMulti[] multi;
			public YuVideoSource[] sources;
		}

		public struct YuSearchItemFields
		{
			public string title;
			public string slug;
			/*
			public string poster;
			public string type;
			public string status;
			public string premiered;
			public string score;*/
		}

		public struct YuSearchItems
		{
			public string model;
			public int pk;
			public YuSearchItemFields fields;
		}

		public struct YuSearchRoot
		{
			public YuSearchItems[] query;
		}

#pragma warning restore CS0649

		static string GetYugenaniSite(string url, out string token, out string cfduid)
		{
			const int waitTime = 10000;
			token = "";
			cfduid = "";
			try {
				HttpWebRequest webRequest = (HttpWebRequest)HttpWebRequest.Create(url);
				//if (GetRequireCert(url)) { webRequest.ServerCertificateValidationCallback = delegate { return true; }; }

				webRequest.Method = "GET";
				webRequest.Timeout = waitTime;
				webRequest.ReadWriteTimeout = waitTime;
				webRequest.ContinueTimeout = waitTime;
				webRequest.UserAgent = USERAGENT;

				print("REQUEST::: " + url);

				using var webResponse = webRequest.GetResponse();
				try {
					foreach (var key in webResponse.Headers.AllKeys) {
						if (key == "Set-Cookie") {
							foreach (var f in webResponse.Headers.GetValues(key)) {
								print(key + "|" + f);
								if (f.Contains("csrftoken")) {
									token = FindHTML(f, "csrftoken=", ";");
								}
								if (f.Contains("cfduid")) {
									cfduid = FindHTML(f, "cfduid=", ";");
								}
							}
						}
					}
					using StreamReader httpWebStreamReader = new StreamReader(webResponse.GetResponseStream());
					try {
						return httpWebStreamReader.ReadToEnd();
					}
					catch (Exception _ex) {
						print("FATAL ERROR DLOAD3: " + _ex + "|" + url);
					}
				}
				catch (Exception) {
					return "";
				}
			}
			catch (Exception _ex) {
				error("FATAL ERROR DLOAD: \n" + url + "\n============================================\n" + _ex + "\n============================================");
			}
			return "";
		}

		static string PostYugenaniSite(string myUri, string _requestBody, string referer, string token, string cfduid, string _contentType = "application/x-www-form-urlencoded; charset=UTF-8")
		{
			try {
				HttpWebRequest webRequest = (HttpWebRequest)HttpWebRequest.Create(myUri);

				webRequest.Method = "POST";
				webRequest.Headers.Add("X-Requested-With", "XMLHttpRequest");
				webRequest.Headers.Add("sec-fetch-dest", "empty");
				webRequest.Headers.Add("sec-fetch-mode", "cors");
				webRequest.Headers.Add("x-csrftoken", token);
				webRequest.Headers.Add("sec-fetch-site", "same-origin");
				webRequest.Headers.Add("cookie", $"__cfduid={cfduid};csrftoken={token}");

				webRequest.CookieContainer = new CookieContainer();
				webRequest.CookieContainer.Add(new Cookie("__cfduid", cfduid, "/", ".yugenani.me"));
				webRequest.CookieContainer.Add(new Cookie("csrftoken", token, "/", "yugenani.me"));

				webRequest.Referer = referer;
				webRequest.ContentType = _contentType;
				// webRequest.Headers.Add("Host", "trollvid.net");
				webRequest.UserAgent = USERAGENT;
				webRequest.Headers.Add("Accept-Language", "en-US,en;q=0.5");
				bool done = false;
				string _res = "";
				webRequest.BeginGetRequestStream(new AsyncCallback((IAsyncResult callbackResult) => {
					try {
						HttpWebRequest _webRequest = (HttpWebRequest)callbackResult.AsyncState;
						Stream postStream = _webRequest.EndGetRequestStream(callbackResult);

						string requestBody = _requestBody;// --- RequestHeaders ---

						byte[] byteArray = Encoding.UTF8.GetBytes(requestBody);

						postStream.Write(byteArray, 0, byteArray.Length);
						postStream.Close();


						// BEGIN RESPONSE

						_webRequest.BeginGetResponse(new AsyncCallback((IAsyncResult _callbackResult) => {
							try {
								HttpWebRequest request = (HttpWebRequest)_callbackResult.AsyncState;
								HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(_callbackResult);
								using StreamReader httpWebStreamReader = new StreamReader(response.GetResponseStream());
								try {
									_res = httpWebStreamReader.ReadToEnd();
									done = true;
								}
								catch (Exception) {
									return;
								}

							}
							catch (Exception _ex) {
								error("FATAL EX IN POST2: " + _ex);
							}
						}), _webRequest);

					}
					catch {
						error("FATAL EX IN POSTREQUEST");
					}
				}), webRequest);


				for (int i = 0; i < 1000; i++) {
					Thread.Sleep(10);
					if (done) {
						return _res;
					}
				}
				return _res;
			}
			catch (Exception _ex) {
				error("FATAL EX IN POST: " + _ex);
				return "";
			}
		}

		public string PostYugenaniSite(string myUri, string _requestBody, string referer, string _contentType = "application/x-www-form-urlencoded; charset=UTF-8")
		{
			if (lastToken == null || lastCfduid == null) {
				return "";
			}

			return PostYugenaniSite(myUri, _requestBody, referer, lastToken, lastCfduid, _contentType);
		}

		public string GetYugenaniSite(string url)
		{
			var site = GetYugenaniSite(url, out string token, out string cfduid);
			if (token.IsClean()) {
				lastToken = token;
				lastCfduid = cfduid;
			}
			return site;
		}

		public YuSearchRoot? SearchSite(string query)
		{
			try {
				string post = PostYugenaniSite("https://yugenani.me/api/search/", $"query={query}", "https://yugenani.me/").Replace("\\", "");
				string main = "{ \"query\": " + FindHTML(post, "query\": \"", "]\"") + "]}";
				print("Search::: " + post + "|\n" + main);
				return JsonConvert.DeserializeObject<YuSearchRoot>(main);
			}
			catch (Exception _ex) {
				error(_ex);
				return null;
			}
		}

		/// <summary>
		/// "https://yugenani.me/watch/1428/overlord/1/" or
		/// "https://yugenani.me/watch/1428/overlord-dub/1/"
		/// </summary>
		/// <param name="url"></param>
		/// <returns></returns>
		public string GetEmbed(string url)
		{
			string d = GetYugenaniSite(url);
			return FindHTML(d, "src=\"//yugenani.me/e/", "/");
		}

		public YuVideoRoot? GetEmbedData(string embed)
		{
			try {
				string post = PostYugenaniSite("https://yugenani.me/api/embed/", $"id={embed}&ac=0", $"https://yugenani.me/e/{embed}/");
				print(post);
				return JsonConvert.DeserializeObject<YuVideoRoot>(post);
			}
			catch (Exception _ex) {
				error(_ex);
				return null;
			}
		}

		[System.Serializable]
		public struct YuInfo
		{
			public int malId;
			public int dubbedEps;
			public int subbedEps;
		}

		public static Dictionary<int, YuInfo> cachedYuInfo = new Dictionary<int, YuInfo>();

		public YuInfo? GetYuInfo(int id, string slug)
		{
			//Episodes (Dub)</div><span class="description" style="font-size: 12px;">
			//Episodes</div><span class="description" style="font-size: 12px;">
			//mal_id":
			if (cachedYuInfo.ContainsKey(id)) return cachedYuInfo[id];

			string d = GetYugenaniSite($"https://yugenani.me/anime/{id}/{slug}/watch/");
			if (d == "") return null;
			try {
				int.TryParse(FindHTML(d, "Episodes (Dub)</div><span class=\"description\" style=\"font-size: 12px;\">", "<"), out int dubEpisodes);
				int.TryParse(FindHTML(d, "Episodes</div><span class=\"description\" style=\"font-size: 12px;\">", "<"), out int subEpisodes);
				int.TryParse(FindHTML(d, "mal_id\":", ","), out int malId);
				if (malId <= 0) return null;
				var info =  new YuInfo() {
					malId = malId,
					dubbedEps = dubEpisodes,
					subbedEps = subEpisodes,
				};
				cachedYuInfo[id] = info;
				return info;
			}
			catch (Exception _ex) {
				error(_ex);
				return null;
			}
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/MovieProviders/DubbedAnimeMovieProvider.cs
================================================
﻿using CloudStreamForms.Core.BaseProviders;
using System;
using System.Collections.Generic;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.MovieProviders
{
	class DubbedAnimeMovieProvider : BloatFreeMovieProvider
	{
		readonly DubbedAnimeBaseProvider provider;
		public override string Name => "DubbedAnime";
		public override bool NullMetadata => true;
		public override bool HasTvSeries => false;
		public override bool HasAnimeMovie => true;
		public override bool HasMovie => false;
		public DubbedAnimeMovieProvider(CloudStreamCore _core) : base(_core) { provider = new DubbedAnimeBaseProvider(_core); provider.FishMainMovies(); }

		public override void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
		{
			if (DubbedAnimeBaseProvider.hasSearchedMovies && DubbedAnimeBaseProvider.movies.Count > 0) {
				foreach (var mov in DubbedAnimeBaseProvider.movies) {
					var baseName = ToDown(mov.name);
					if (baseName == ToDown(ActiveMovie.title.name) || baseName == ToDown(ActiveMovie.title.ogName)) {
						var ep = provider.GetDubbedAnimeEpisode(mov.slug);
						if (ep.HasValue) {
							provider.AddMirrors(ep.Value, normalEpisode);
							return;
						}
					}
				}
			}
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/MovieProviders/Embed2Provider.cs
================================================
﻿using System.Collections.Generic;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.MovieProviders
{
	class Embed2Provider : BloatFreeMovieProvider
	{
		public override string Name => "Embed2";
		public override bool NullMetadata => true;
		public Embed2Provider(CloudStreamCore _core) : base(_core) { }
		public override bool HasAnimeMovie => true;
		public override bool HasMovie => true;
		public override bool HasTvSeries => true;

		public override object StoreData(bool isMovie, TempThread tempThred)
		{
			return null;
		}

		public override void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
		{
			string imdbId = ActiveMovie.title.id;
			string imdbD = DownloadString(isMovie ? $"https://www.2embed.ru/embed/imdb/movie?id={imdbId}" : $"https://www.2embed.ru/embed/imdb/tv?id={imdbId}&s={season}&e={episode}");
			const string lookFor = "data-id=\"";
			List<string> ids = new List<string>();
			while (imdbD.Contains(lookFor)) {
				ids.Add(FindHTML(imdbD, lookFor, "\""));
				imdbD = RemoveOne(imdbD, lookFor);
			}
			foreach (var id in ids) {
				string d = DownloadString($"https://www.2embed.ru/ajax/embed/play?id={id}&_token=");
				string link = FindHTML(d, "\"link\":\"", "\"");
				if (link.Contains("vidcloud.pro")) {
					string _d = DownloadString(link);
					string sources = FindHTML(_d, "sources = [", "],").Replace("\\", "");
					var links = GetAllFilesRegex(sources);
					foreach (var _link in links) {
						AddPotentialLink(normalEpisode, _link.url, "VidCloud Embed", 5, _link.label);
					}
				}
			}
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/MovieProviders/FilesClubProvider.cs
================================================
﻿using System;
using System.Collections.Generic;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.MovieProviders
{
	class FilesClubProvider : BloatFreeMovieProvider
	{
		public override string Name => "123FilesClub";
		public override bool NullMetadata => true;
		public FilesClubProvider(CloudStreamCore _core) : base(_core) { }


		public override void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
		{
			string imdbId = ActiveMovie.title.id;
			string random = rng.Next(0, 10000).ToString();
			string random2 = rng.Next(0, 10000).ToString();
			string bound = $"----WebKitFormBoundary{random}";
			string data = $"--{bound}\nContent-Disposition: form-data; name=\"referer\"\n\nffmovie.fun\n--{bound}\nContent-Disposition: form-data; name=\"SubmitButtoncolors\"\n\n{random2}\n--{bound}--";

			string year = "";
			try {
				year = $"&y={ActiveMovie.title.year[0..4]}";
			}
			catch (Exception) {

			}

			string request = (isMovie ? "https://123files.club/imdb/play/?id=" : "https://123files.club/imdb/tv/?id=") + imdbId + year + (isMovie ? "" : $"&s={season}&e={episode}");
			string d = core.PostRequest(request, request, data, tempThred, $"multipart/form-data; boundary={bound}");

			var _thread = core.CreateThread(3);
			core.StartThread(Name + " ExtraThread", () => {
				string __d = (string)d.Clone();
				const string _lookFor = "data-id=\"";
				while (__d.Contains(_lookFor)) {
					string _ref = FindHTML(__d, _lookFor, "\"");

					void EvalRef(string __ref)
					{
						string _ev = DownloadString("https://123files.club" + __ref, referer: request, tempThred: _thread);
						if (_ev == "") return;

						List<VideoFileData> evalDatas = GetFileFromEvalData(_ev);
						foreach (var evalData in evalDatas) {
							if (evalData.url == "") {
								string realSite = FindHTML(_ev, "src=\"", "\"");
								if (realSite != "" && !realSite.StartsWith("http")) {
									EvalRef(realSite);
								}
							}
							else {
								string _url = evalData.url.Replace("#", "");
								if (_url.Length > 10) {
									AddPotentialLink(normalEpisode, _url, "FilesClub", 5);
								}
							}
						}

					}
					EvalRef(_ref);

					__d = RemoveOne(__d, _lookFor);
				}
			});

			string _downloadLink = FindHTML(d, "<a href=\"/download/", "\"");
			if (_downloadLink != "") {
				_downloadLink = "https://123files.club/download/" + _downloadLink;
				string dSource = core.PostRequest(_downloadLink, _downloadLink, $"imdb={imdbId}&imdbGO=");
				const string lookFor = "<a href=\"";
				while (dSource.Contains(lookFor)) {
					string link = FindHTML(dSource, lookFor, "\"");

					if (link.Contains("googleusercontent")) {
						AddPotentialLink(normalEpisode, link, "GoogleVideo Files", 13);
					}

					dSource = RemoveOne(dSource, lookFor);
				}
			}
		}
	}
}


================================================
FILE: CloudStreamElectron/Controllers/Core/MovieProviders/GomoStreamBFProvider.cs
================================================
﻿using Jint;
using System;
using System.IO;
using System.Net;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.MovieProviders
{
	class GomoStreamBFProvider : BloatFreeMovieProvider
	{
		public override string Name => "GomoStream";
		public override bool NullMetadata => true;
		public GomoStreamBFProvider(CloudStreamCore _core) : base(_core) { }

		public override void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
		{
			string find = ActiveMovie.title.name.ToLower() + (ActiveMovie.title.movieType == MovieType.TVSeries ? "-season-" + season : "");
			find = find.Replace("\'", "-");
			Regex rgx = new Regex("[^a-zA-Z0-9 -]");
			find = rgx.Replace(find, "");

			find = find.Replace(" - ", "-").Replace(" ", "-");

			if (ActiveMovie.title.movieType == MovieType.TVSeries) { // ADD CORRECT FORMAT; https://gomostream.com/show/game-of-thrones/01-01
				find = find.Replace("-season-", "/");

				for (int i = 0; i < 10; i++) {
					if (find.EndsWith("/" + i)) {
						find = find.Replace("/" + i, "/0" + i);
					}
				}
				if (episode.ToString() != "-1") {
					find += "-" + episode;
				}
				for (int i = 0; i < 10; i++) {
					if (find.EndsWith("-" + i)) {
						find = find.Replace("-" + i, "-0" + i);
					}
				}
			}
			string gomoUrl = "https://" + GOMOURL + "/" + (isMovie ? "movie" : "show") + "/" + find;

			DownloadGomoSteam(gomoUrl, tempThred, normalEpisode);
		}

		/// <summary>
		/// GET GOMOSTEAM SITE MIRRORS
		/// </summary>
		/// <param name="url"></param>
		/// <param name="_tempThred"></param>
		/// <param name="episode"></param>
		void DownloadGomoSteam(string url, TempThread tempThred, int episode)
		{
			bool done = true;
			try {
				try {
					string d = "";
					if (d == "") {
						try {
							// d = DownloadString(url, tempThred, false, 2); if (!GetThredActive(tempThred)) { return; }; // COPY UPDATE PROGRESS TODO CHECK
							d = DownloadString(url, tempThred, 2); if (!GetThredActive(tempThred)) { return; }; // COPY UPDATE PROGRESS
						}
						catch (System.Exception _ex) {
							error("Error gogo" + _ex);
						}
					}

					if (d == "") {
						d = GetHTML(url);
						if (!GetThredActive(tempThred)) { return; };
					}

					if (d == "") {
						d = HTMLGet(url, "https://" + GOMOURL);
						if (!GetThredActive(tempThred)) { return; };
					}

					if (d != "") { // If not failed to connect
						debug("Passed gogo download site");

						// ----- JS EMULATION, CHECK USED BY WEBSITE TO STOP WEB SCRAPE BOTS, DID NOT STOP ME >:) -----

						string tokenCode = FindHTML(d, "var tc = \'", "'");
						string _token = FindHTML(d, "_token\": \"", "\"");
						string funct = "function _tsd_tsd_ds(" + FindHTML(d, "function _tsd_tsd_ds(", "</script>").Replace("\"", "'") + " log(_tsd_tsd_ds('" + tokenCode + "'))";
						// print(funct);
						if (funct == "function _tsd_tsd_ds( log(_tsd_tsd_ds(''))") {
							debug(d); // ERROR IN LOADING JS
						}
						string realXToken = "";
						var engine = new Engine()
						.SetValue("log", new Action<string>((a) => { realXToken = a; }));

						engine.Execute(@funct);
						if (!GetThredActive(tempThred)) { return; }; // COPY UPDATE PROGRESS
																	 //GetAPI(realXToken, tokenCode, _token, tempThred, episode);
						print("PAssed js test" + realXToken);
						System.Uri myUri = new System.Uri("https://" + GOMOURL + "/decoding_v3.php"); // Can't DownloadString because of RequestHeaders (Anti-bot)
						HttpWebRequest webRequest = (HttpWebRequest)HttpWebRequest.Create(myUri);

						// --- Headers ---

						webRequest.Method = "POST";
						webRequest.Headers.Add("x-token", realXToken);
						webRequest.Headers.Add("X-Requested-With", "XMLHttpRequest");
						webRequest.Headers.Add("DNT", "1");
						webRequest.Headers.Add("Cache-Control", "max-age=0, no-cache");
						webRequest.Headers.Add("TE", "Trailers");
						webRequest.Headers.Add("Pragma", "Trailers");
						webRequest.ContentType = "application/x-www-form-urlencoded";
						done = false;
						print("Passed token");

						webRequest.BeginGetRequestStream(new AsyncCallback((IAsyncResult callbackResult) => {
							HttpWebRequest _webRequest = (HttpWebRequest)callbackResult.AsyncState;
							Stream postStream = _webRequest.EndGetRequestStream(callbackResult);

							string requestBody = true ? ("tokenCode=" + tokenCode + "&_token=" + _token) : "type=epis&xny=hnk&id=" + tokenCode; // --- RequestHeaders ---

							byte[] byteArray = Encoding.UTF8.GetBytes(requestBody);

							postStream.Write(byteArray, 0, byteArray.Length);
							postStream.Close();
							print("PASSED TOKENPOST");

							if (!GetThredActive(tempThred)) { return; };


							// BEGIN RESPONSE
							try {
								_webRequest.BeginGetResponse(new AsyncCallback((IAsyncResult _callbackResult) => {
									HttpWebRequest request = (HttpWebRequest)_callbackResult.AsyncState;
									try {
										HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(_callbackResult);
										try {
											using StreamReader httpWebStreamReader = new StreamReader(response.GetResponseStream());
											if (!GetThredActive(tempThred)) { print(":("); return; };
											print("GOT RESPONSE:");
											string result = httpWebStreamReader.ReadToEnd();
											print("RESULT:::" + result);
											try {
												if (result != "") {

													// --------------- GOT RESULT!!!!! ---------------


													// --------------- MIRROR LINKS ---------------
													string veryURL = FindHTML(result, "https:\\/\\/verystream.com\\/e\\/", "\"");
													string gunURL = "https://gounlimited.to/" + FindHTML(result, "https:\\/\\/gounlimited.to\\/", ".html") + ".html";
													string onlyURL = "https://onlystream.tv" + FindHTML(result, "https:\\/\\/onlystream.tv", "\"").Replace("\\", "");
													//string gogoStream = FindHTML(result, "https:\\/\\/" + GOMOURL, "\"");
													string upstream = FindHTML(result, "https:\\/\\/upstream.to\\/embed-", "\"");
													string mightyupload = FindHTML(result, "https:\\/\\/mightyupload.com\\/embed-", "\"");//FindHTML(result, "http:\\/\\/mightyupload.com\\/", "\"").Replace("\\/", "/");
																																		  //["https:\/\/upstream.to\/embed-05mzggpp3ohg.html","https:\/\/gomo.to\/vid\/eyJ0eXBlIjoidHYiLCJzIjoiMDEiLCJlIjoiMDEiLCJpbWQiOiJ0dDA5NDQ5NDciLCJfIjoiMzQyMDk0MzQzMzE4NTEzNzY0IiwidG9rZW4iOiI2NjQ0MzkifQ,,&noneemb","https:\/\/hqq.tv\/player\/embed_player.php?vid=SGVsWVI5aUNlVTZxTTdTV09RY0x6UT09&autoplay=no",""]
													if (upstream != "") {
														string _d = DownloadString("https://upstream.to/embed-" + upstream);
														if (!GetThredActive(tempThred)) { return; };

														var links = GetAllFilesRegex(_d);
														int prio = 16;
														foreach (var link in links) {
															AddPotentialLink(episode, link.url, "HD Upstream", prio, link.label);
														}
													}

													/*
                                                    if (mightyupload != "") {
                                                        print("MIGHT: " + mightyupload);
                                                        string baseUri = "http://mightyupload.com/embed-" + mightyupload;
                                                        //string _d = DownloadString("http://mightyupload.com/" + mightyupload);
                                                        string post = "op=download1&usr_login=&id=" + (mightyupload.Replace(".html", "")) + "&fname=" + (mightyupload.Replace(".html", "") + "_play.mp4") + "&referer=&method_free=Free+Download+%3E%3E";

                                                        string _d = PostRequest(baseUri, baseUri, post, tempThred);//op=download1&usr_login=&id=k9on84m2bvr9&fname=tt0371746_play.mp4&referer=&method_free=Free+Download+%3E%3E
                                                        print("RESMIGHT:" + _d);
                                                        if (!GetThredActive(tempThred)) { return; };
                                                        string ur = FindHTML(_d, "<source src=\"", "\"");
                                                        AddPotentialLink(episode, ur, "HD MightyUpload", 16);
                                                    }*/
													/*
                                                    if (gogoStream.EndsWith(",&noneemb")) {
                                                        result = RemoveOne(result, ",&noneemb");
                                                        gogoStream = FindHTML(result, "https:\\/\\/" + GOMOURL, "\"");
                                                    }


                                                    gogoStream = gogoStream.Replace(",,&noneemb", "").Replace("\\", "");

                                                    */

													/*
                                                    Episode ep = activeMovie.episodes[episode];
                                                    if (ep.links == null) {
                                                        activeMovie.episodes[episode] = new Episode() { links = new List<Link>(), date = ep.date, description = ep.description, name = ep.name, posterUrl = ep.posterUrl, rating = ep.rating, id = ep.id };
                                                    }*/

													if (veryURL != "") {
														try {
															if (!GetThredActive(tempThred)) { return; };

															d = DownloadString("https://verystream.com/e/" + veryURL);
															if (!GetThredActive(tempThred)) { return; };

															// print(d);
															debug("-------------------- HD --------------------");
															url = "https://verystream.com/gettoken/" + FindHTML(d, "videolink\">", "<");
															debug(url);
															if (url != "https://verystream.com/gettoken/") {
																/*
                                                                if (!LinkListContainsString(activeMovie.episodes[episode].links, url)) {
                                                                    // print(activeMovie.episodes[episode].Progress);
                                                                    activeMovie.episodes[episode].links.Add(new Link() { url = url, priority = 10, name = "HD Verystream" });
                                                                    linkAdded?.Invoke(null, 1);
                                                                }*/
																AddPotentialLink(episode, url, "HD Verystream", 20);
															}

															debug("--------------------------------------------");
															debug("");
														}
														catch (System.Exception) {

														}

													}
													else {
														debug("HD Verystream Link error (Read api)");
														debug("");
													}
													//   activeMovie.episodes[episode] = SetEpisodeProgress(activeMovie.episodes[episode]);

													const string __lookFor = "https:\\/\\/gomo.to\\/vid\\/";
													while (result.Contains(__lookFor)) {
														string gogoStream = FindHTML(result, __lookFor, "\"");
														result = RemoveOne(result, __lookFor);
														if (gogoStream != "") {
															debug(gogoStream);
															try {
																if (!GetThredActive(tempThred)) { return; };
																string trueUrl = "https://" + GOMOURL + "/vid/" + gogoStream;
																//print(trueUrl);
																d = DownloadString(trueUrl);
																//print("-->><<__" + d);
																if (!GetThredActive(tempThred)) { return; };

																var links = GetFileFromEvalData(d);

																foreach (var link in links) {
																	AddPotentialLink(episode, link.url, "Gomoplayer", 7, link.label);
																}
															}
															catch (System.Exception) {
															}

														}
														else {
															debug("HD Viduplayer Link error (Read api)");
															debug("");
														}
													}

													// activeMovie.episodes[episode] = SetEpisodeProgress(activeMovie.episodes[episode]);

													if (gunURL != "https://gounlimited.to/.html" && gunURL != "" && gunURL != "https://gounlimited.to/") {
														try {
															if (!GetThredActive(tempThred)) { return; };

															d = DownloadString(gunURL);
															if (!GetThredActive(tempThred)) { return; };

															string mid = FindHTML(d, "mp4|", "|");
															string server = FindHTML(d, mid + "|", "|");
															url = "https://" + server + ".gounlimited.to/" + mid + "/v.mp4";
															if (mid != "" && server != "") {
																/*
                                                                if (!LinkListContainsString(activeMovie.episodes[episode].links, url)) {
                                                                    // print(activeMovie.episodes[episode].Progress);

                                                                    activeMovie.episodes[episode].links.Add(new Link() { url = url, priority = 8, name = "HD Go Unlimited" });
                                                                    linkAdded?.Invoke(null, 1);

                                                                }*/
																AddPotentialLink(episode, url, "HD Go Unlimited", 18);

															}
															debug("-------------------- HD --------------------");
															debug(url);

															debug("--------------------------------------------");
															debug("");
														}
														catch (System.Exception) {

														}

													}
													else {
														debug("HD Go Link error (Read api)");
														debug("");
													}
													// activeMovie.episodes[episode] = SetEpisodeProgress(activeMovie.episodes[episode]);

													if (onlyURL != "" && onlyURL != "https://onlystream.tv") {
														try {
															if (!GetThredActive(tempThred)) { return; };

															d = DownloadString(onlyURL);
															if (!GetThredActive(tempThred)) { return; };

															string _url = FindHTML(d, "file:\"", "\"");

															if (_url == "") {
																_url = FindHTML(d, "src: \"", "\"");
															}

															bool valid = false;
															if (CheckIfURLIsValid(_url)) { // NEW USES JW PLAYER I THNIK, EASIER LINK EXTRACTION
																url = _url; valid = true;
															}
															else { // OLD SYSTEM I THINK
																string server = "";//FindHTML(d, "urlset|", "|");
																string mid = FindHTML(d, "logo|", "|");

																if (mid == "" || mid.Length < 10) {
																	mid = FindHTML(d, "mp4|", "|");
																}

																string prefix = FindHTML(d, "ostreamcdn|", "|");

																url = "";
																if (server != "") {
																	url = "https://" + prefix + ".ostreamcdn.com/" + server + "/" + mid + "/v/mp4"; // /index-v1-a1.m3u8 also works if you want the m3u8 file instead
																}
																else {
																	url = "https://" + prefix + ".ostreamcdn.com/" + mid + "/v/mp4";
																}

																if (mid != "" && prefix != "" && mid.Length > 10) {
																	valid = true;
																}
															}

															if (valid) {
																AddPotentialLink(episode, url, "HD Onlystream", 17);
															}
															else {
																debug(d);
																debug("FAILED URL: " + url);
															}

															debug("-------------------- HD --------------------");
															debug(url);

															debug("--------------------------------------------");
															debug("");
														}
														catch (System.Exception) {

														}

													}
													else {
														debug("HD Only Link error (Read api)");
														debug("");
													}

													done = true;
												}
												else {
													done = true;
													debug("DA FAILED");
												}
											}
											catch (Exception) {
												done = true;
											}
										}
										catch (Exception _ex) {
											error("FATAL EX IN TOKENPOST2:" + _ex);
										}
									}
									catch (Exception _ex) {
										error("FATAL EX IN TOKENPOST2:" + _ex);
									}
								}), _webRequest);
							}
							catch (Exception _ex) {
								error("FATAL EX IN TOKENPOST:" + _ex);
							}

						}), webRequest);
					}
					else {
						debug("Dident get gogo");
					}
				}
				catch (System.Exception _ex) {
					error(_ex);
				}
			}
			finally {
				while (!done) {
					Thread.Sleep(20);
				}
			}
		}
	}
}


================================================
FILE: CloudStreamElectron/Controllers/Core/MovieProviders/HdmProvider.cs
================================================
﻿using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.MovieProviders
{
	class HdmProvider : BloatFreeMovieProvider
	{
		public override string Name => "Hdm";
		public override bool NullMetadata => true;
		public HdmProvider(CloudStreamCore _core) : base(_core) { }

		public override object StoreData(bool isMovie, TempThread tempThred)
		{
			return null;
		}

		public override void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
		{
			if (isMovie) {
				string _name = ActiveMovie.title.name.Replace(":", "");
				string d = DownloadString($"https://hdm.to/src/player/?v=https://1o.to/{_name}.mp4");
				string key = FindHTML(d, "/playlist.m3u8?", "\"");
				if (key != "") {
					var s = $"https://hls.1o.to/vod/{_name}/playlist.m3u8?{key}";
					string verify = DownloadString(s, repeats: 1);
					if (verify != "") { // IF NAME IS WRONG OR IT DOSENT EXIT IT WILL GIVE A 404
						AddPotentialLink(normalEpisode, s, "Hdm HD", 5, "");
					}
				}
			}
		}
	}
}


================================================
FILE: CloudStreamElectron/Controllers/Core/MovieProviders/LiveMovies123BFProvider.cs
================================================
﻿using System;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.MovieProviders
{
	class LiveMovies123BFProvider : BloatFreeMovieProvider
	{
		public override string Name => "LiveMovies123";
		public override bool NullMetadata => true;
		public LiveMovies123BFProvider(CloudStreamCore _core) : base(_core) { }

		public override void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
		{
			try {
				GetLiveMovies123Links(normalEpisode, episode, season, isMovie, "https://movies123.live", tempThred);
				GetLiveMovies123Links(normalEpisode, episode, season, isMovie, "https://c123movies.com", tempThred);
			}
			catch (Exception _ex) {
				error("PROVIDER ERROR: " + _ex);
			}
		}

		void GetLiveMovies123Links(int normalEpisode, int episode, int season, bool isMovie, string provider = "https://c123movies.com", TempThread tempThred = default) // https://movies123.live & https://c123movies.com
		{
			string _title = ToDown(ActiveMovie.title.name, replaceSpace: "-");

			string _url = (isMovie ? (provider + "/movies/" + _title) : (provider + "/episodes/" + _title + "-season-" + season + "-episode-" + episode));

			string d = DownloadString(_url, tempThred);
			if (!GetThredActive(tempThred)) { return; };
			string release = FindHTML(d, "Release:</strong> ", "<");
			bool succ = true;
			if (release != ActiveMovie.title.year.Substring(0, 4)) {
				succ = false;
				if (isMovie) {
					d = DownloadString(_url + "-1");
					succ = true;
				}
			}
			if (succ) {
				string live = FindHTML(d, "getlink(\'", "\'");
				if (live != "") {
					string url = provider + "/ajax/get-link.php?id=" + live + "&type=" + (isMovie ? "movie" : "tv") + "&link=sw&" + (isMovie ? "season=undefined&episode=undefined" : ("season=" + season + "&episode=" + episode));
					d = DownloadString(url, tempThred); if (!GetThredActive(tempThred)) { return; };

					string shortURL = FindHTML(d, "iframe src=\\\"", "\"").Replace("\\/", "/");
					d = DownloadString(shortURL, tempThred); if (!GetThredActive(tempThred)) { return; };
					if (!d.IsClean()) return;
					AddEpisodesFromMirrors(tempThred, d, normalEpisode);
				}
			}
		}
	}
}


================================================
FILE: CloudStreamElectron/Controllers/Core/MovieProviders/MonkeyStreamProvider.cs
================================================
﻿using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.MovieProviders
{
	class MonkeyStreamProvider : BloatFreeMovieProvider
	{
		public MonkeyStreamProvider(CloudStreamCore _core) : base(_core) { }

		public override string Name => "MonkeyStream";

		public override object StoreData(bool isMovie, CloudStreamCore.TempThread tempThred)
		{
			try {
				string search = ActiveMovie.title.name;
				string year = ActiveMovie.title.year[0..4];
				string d = DownloadString("https://www.monkeystream.net/search?q=" + search);
				const string lookFor = "<div class=\"movie-title\">";
				while (d.Contains(lookFor)) {
					d = RemoveOne(d, lookFor);
					string _href = FindHTML(d, "href=\"", "\"");
					d = RemoveOne(d, "title=\"");
					string _title = FindHTML(d, "\">", "<");
					string _year = FindHTML(d, "movie-item\">", "<");
					if (_year == year && _title == search) {
						return _href;
					}
				}
				return null;
			}
			catch {
				return null;
			}
		}

		public override void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
		{
			string mainUrl = (string)metadata;
			if (!mainUrl.IsClean()) return;
			string d = DownloadString(mainUrl, referer: "https://www.monkeystream.net/search?q=" + ActiveMovie.title.name, tempThred: tempThred);
			const string lookFor = "?key=";
			while (d.Contains(lookFor)) {
				string key = FindHTML(d, lookFor, "\"");
				d = RemoveOne(d, lookFor);
				string title = FindHTML(d, "server mr10\">", "<");

				if (title.Contains("MonkeyEmbed")) {
					string _d = DownloadString(mainUrl + "?key=" + key, referer: "https://www.monkeystream.net/search?q=iron+man", tempThred: tempThred);

					string apiSource = FindHTML(_d, "https://www.monkeyembed.xyz/v/", "\"");
					if (apiSource != "") {
						string apiPost = core.PostRequest("https://www.monkeyembed.xyz/api/source/" + apiSource, "https://www.monkeyembed.xyz/v/" + apiSource, $"r={mainUrl}&d=www.monkeyembed.xyz");
						const string _lookFor = "\"file\":\"";
						while (apiPost.Contains(_lookFor)) {
							string file = FindHTML(apiPost, _lookFor, "\"").Replace("\\", "");
							apiPost = RemoveOne(apiPost, _lookFor);
							string label = FindHTML(apiPost, "\"label\":\"", "\"");
							AddPotentialLink(normalEpisode, file, "MonkeyEmbed", 5, label);
						}
					}
				}
			}
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/MovieProviders/ShiroMovieProvider.cs
================================================
﻿using CloudStreamForms.Core.AnimeProviders;
using CloudStreamForms.Core.BaseProviders;
using System;
using System.Linq;
using static CloudStreamForms.Core.BaseProviders.ShiroBaseProvider;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.MovieProviders
{
	class ShiroMovieProvider : BloatFreeMovieProvider
	{
		public ShiroBaseProvider shiroBase;
		public string Token => shiroBase.Token;
		public override string Name => shiroBase._name;
		public override bool HasMovie => true;
		public override bool HasAnimeMovie => true;
		public override bool HasTvSeries => false;
		public override bool NullMetadata => false;

		public ShiroMovieProvider(CloudStreamCore _core, string siteUrl, string name) : base(_core)
		{
			shiroBase = new ShiroBaseProvider(_core, siteUrl, name, true);
		}

		public override object StoreData(bool isMovie, TempThread tempThred)
		{
			if (!isMovie) return null;
			RealShiroItem?[] items = new RealShiroItem?[2] { null, null };
			bool returnNull = true;
			var bData = shiroBase.StoreData(tempThred, ToDown(ActiveMovie.title.name).Replace("  ", ""));
			foreach (var data in bData) {
				if (data.year != ActiveMovie.title.year.Substring(0, 4)) {
					continue;
				}
				if (data.synonyms.Contains(data.name) || ToDown(data.name) == ToDown(ActiveMovie.title.name) || ToDown(data.name) == ToDown(ActiveMovie.title.ogName)) {
					returnNull = false;
					items[data.isDub ? 1 : 0] = data;
				}
			}
			return returnNull ? null : items;
		}

		public override void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
		{
			foreach (var item in (RealShiroItem?[])metadata) {
				if (item != null) {
					shiroBase.LoadLink($"https://ani.api-web.site/anime-episode/slug/{item.Value.slug}-episode-1?token={Token}", normalEpisode, tempThred, item.Value.isDub, $"{item.Value.slug}-episode-1");
				}
			}
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/MovieProviders/TheMovieMovieBFProvider.cs
================================================
﻿using System;
using System.Collections.Generic;
using System.Linq;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.MovieProviders
{
	class TheMovieMovieBFProvider : BloatFreeMovieProvider
	{
		public override string Name => "TheMovie";
		public TheMovieMovieBFProvider(CloudStreamCore _core) : base(_core) { }

		//public override bool HasAnimeMovie => false;

		public override object StoreData(bool isMovie, TempThread tempThred)
		{
			try {
				var list = TheMovieHelper.SearchQuary(ActiveMovie.title.name, core);
				if (!GetThredActive(tempThred)) { return null; }; // COPY UPDATE PROGRESS
				MovieType mType = ActiveMovie.title.movieType;
				string compare = ToDown(ActiveMovie.title.name, true, "");
				var watchMovieSeasonsData = new Dictionary<int, string>();

				if (mType.IsMovie()) {
					//string mustContain = mType == MovieType.AnimeMovie ? "/anime-info/" : "/series/";
					string mustContain = isMovie ? "/movie/" : "/series/";
					TheMovieHelper.TheMovieTitle[] matching = list.Where(t => ToDown(t.name, true, "") == compare && t.season == -1 && t.href.Contains(mustContain)).ToArray();
					if (matching.Length > 0) {
						TheMovieHelper.TheMovieTitle title = matching[0];

						string d = DownloadString(title.href);
						int maxEp = TheMovieHelper.GetMaxEp(d, title.href);
						if (maxEp == 0 || maxEp == 1) {
							string rEp = title.href + "/" + (maxEp - 1); //+ "-episode-" + maxEp;
							watchMovieSeasonsData[-1] = rEp;
						}
					}
				}
				else {
					var episodes = list.Where(t => !t.isDub && t.season != -1 && ToDown(t.name, true, "") == compare && t.href.Contains("/series/")).ToList().OrderBy(t => t.season).ToArray();

					for (int i = 0; i < episodes.Length; i++) {
						watchMovieSeasonsData[episodes[i].season] = episodes[i].href;
					}
				}
				return watchMovieSeasonsData;
			}
			catch { return null; }
		}

		public override void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
		{
			try {
				var watchMovieSeasonsData = (Dictionary<int, string>)metadata;
				void GetFromUrl(string url)
				{
					string _url = url.Replace("/movie/", "/watch/").Replace("/series/", "/watch/");
					string d = DownloadString(_url, tempThred);
					if (!GetThredActive(tempThred)) { return; }; // COPY UPDATE PROGRESS
					AddEpisodesFromMirrors(tempThred, d, normalEpisode);
					LookForFembedInString(tempThred, normalEpisode, d);
				}

				if (isMovie) {
					if (watchMovieSeasonsData.ContainsKey(-1)) {
						GetFromUrl(watchMovieSeasonsData[-1]); //.Replace("/anime-info/", "/anime/"));
					}
				}
				else {
					if (watchMovieSeasonsData.ContainsKey(season)) {
						GetFromUrl(watchMovieSeasonsData[season] + "/" + (episode - 1));//.Replace("/anime-info/", "/anime/") + "-episode-" + episode);
					}
				}
			}
			catch (Exception _ex) {
				error("PROVIDER ERROR: " + _ex);
			}
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/MovieProviders/WatchTVBFProvider.cs
================================================
﻿using System;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.MovieProviders
{
	class WatchTVBFProvider : BloatFreeMovieProvider
	{
		public override string Name => "WatchTv";
		public override bool NullMetadata => true;
		public override bool HasMovie => false;
		public override bool HasAnimeMovie => false;
		public WatchTVBFProvider(CloudStreamCore _core) : base(_core) { }

		public override void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
		{
			try {
				string url = "https://www.tvseries.video/series/" + ToDown(ActiveMovie.title.name, replaceSpace: "-") + "/" + "season-" + season + "-episode-" + episode;

				string d = DownloadString(url);
				string vidId = FindHTML(d, " data-vid=\"", "\"");
				if (vidId != "") {
					d = DownloadString("https://www.tvseries.video" + vidId);
					AddEpisodesFromMirrors(tempThred, d, normalEpisode);
				}
			}
			catch (Exception _ex) {
				error("PROVIDER ERROR: " + _ex);
			}
		}
	}
}



================================================
FILE: CloudStreamElectron/Controllers/Core/MovieProviders/YesMoviesBFProvider.cs
================================================
﻿/*using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.MovieProviders
{
    class YesMoviesBFProvider : BloatFreeMovieProvider
    {
        public override string Name => "YesMovies";
        public YesMoviesBFProvider(CloudStreamCore _core) : base(_core) { }
        
        public override object StoreData(bool isMovie, TempThread tempThred)
        {
            return base.StoreData(isMovie, tempThred);
        }

        public override void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
        {
            base.LoadLink(metadata, episode, season, normalEpisode, isMovie, tempThred);
        }
    }
}
*/
using System;
using System.Collections.Generic;
using static CloudStreamForms.Core.BlotFreeProvider;
using static CloudStreamForms.Core.CloudStreamCore;

namespace CloudStreamForms.Core.MovieProviders
{
	class YesMoviesBFProvider : BloatFreeMovieProvider
	{
		public override string Name => "YesMovies";
		public YesMoviesBFProvider(CloudStreamCore _core) : base(_core) { }
		const string SiteUrl = "https://yesmovies.mom";

		public override object StoreData(bool isMovie, TempThread tempThred)
		{
			try {
				string rinput = ToDown(ActiveMovie.title.name, replaceSpace: "+");
				string yesmovies = $"{SiteUrl}/search/?keyword={rinput.Replace("+", "-")}";

				string d = DownloadString(yesmovies, tempThred);
				if (!GetThredActive(tempThred)) { return null; }; // COPY UPDATE PROGRESS
				int counter = 0;
				const string lookfor = "data-url=\"";
				var yesmoviessSeasonDatas = new List<YesmoviessSeasonData>();

				while ((d.Contains(lookfor)) && counter < 100) {
					counter++;
					string url = FindHTML(d, lookfor, "\"");
					string remove = "class=\"ml-mask jt\" title=\"";
					string title = FindHTML(d, remove, "\"");
					string movieUrl = SiteUrl + "/movie/" + FindHTML(d, $"<a href=\"{SiteUrl}/movie/", "\"");
					d = RemoveOne(d, remove);

					int seasonData = 1;
					for (int i = 0; i < 100; i++) {
						if (title.Contains(" - Season " + i)) {
							seasonData = i;
						}
					}
					string realtitle = title.Replace(" - Season " + seasonData, "");
					string _d = DownloadString(url, tempThred);
					if (!GetThredActive(tempThred)) { return null; }; // COPY UPDATE PROGRESS
					string imdbData = FindHTML(_d, "IMDb: ", "<").Replace("\n", "").Replace(" ", "").Replace("	", "");
					//  string year = FindHTML(_d, "<div class=\"jt-info\">", "<").Replace("\n", "").Replace(" ", "").Replace("	", "").Replace("	", "");

					string s1 = ActiveMovie.title.rating;
					string s2 = imdbData;
					if (s2.ToLower() == "n/a") {
						continue;
					}

					if (!s1.Contains(".")) { s1 += ".0"; }
					if (!s2.Contains(".")) { s2 += ".0"; }

					int i1 = int.Parse(s1.Replace(".", ""));
					int i2 = int.Parse(s2.Replace(".", ""));
					//activeMovie.title.year.Substring(0, 4) == year
					if (ToDown(ActiveMovie.title.name, replaceSpace: "") == ToDown(realtitle, replaceSpace: "") && (i1 == i2 || i1 == i2 - 1 || i1 == i2 + 1)) {
						yesmoviessSeasonDatas.Add(new YesmoviessSeasonData() { url = movieUrl, id = seasonData });
					}
				}
				return yesmoviessSeasonDatas;
			}
			catch (Exception) {
				return null;
			}
		}

		public override void LoadLink(object metadata, int episode, int season, int normalEpisode, bool isMovie, TempThread tempThred)
		{
			var yesmoviessSeasonDatas = (List<YesmoviessSeasonData>)metadata;
			for (int i = 0; i < yesmoviessSeasonDatas.Count; i++) {
				if (yesmoviessSeasonDatas[i].id == (isMovie ? 1 : season)) {
					string url = yesmoviessSeasonDatas[i].url;
					int _episode = normalEpisode + 1;
					string d = DownloadString(url.Replace("watching.html", "") + "watching.html");

					string movieId = FindHTML(d, "var movie_id = \'", "\'");
					if (movieId == "") return;

					d = DownloadString($"{SiteUrl}/ajax/v2_get_episodes/{movieId}");
					if (!GetThredActive(tempThred)) { return; }; // COPY UPDATE PROGRESS

					string episodeId = FindHTML(d, "title=\"Episode " + _episode + "\" class=\"btn-eps\" episode-id=\"", "\"");
					if (episodeId == "") return;
					d = DownloadString($"{SiteUrl}/ajax/load_embed/mov{episodeId}");

					if (!GetThredActive(tempThred)) { return; }; // COPY UPDATE PROGRESS

					string embedededUrl = FindHTML(d, "\"embed_url\":\"", "\"").Replace("\\", "") + "=EndAll";
					string __url = FindHTML(embedededUrl, "id=", "=EndAll");
					if (__url == "") return;
					embedededUrl = "https://video.opencdn.co/api/?id=" + __url;
					d = DownloadString(embedededUrl);

					if (!GetThredActive(tempThred)) { return; }; // COPY UPDATE PROGRESS
					string link = FindHTML(d, "\"link\":\"", "\"").Replace("\\", "").Replace("//", "https://").Replace("https:https:", "https:");
					d = DownloadString(link);

					if (!GetThredActive(tempThred)) { return; }; // COPY UPDATE PROGRESS

					string secondLink = FindHTML(d, "https://vidnode.net/download?id=", "\"");
					if (secondLink != "") {
						d = DownloadString("https://vidnode.net/download?id=" + secondLink);
						if (!GetThredActive(tempThred)) { return; }; // COPY UPDATE PROGRESS
						core.GetVidNode(d, normalEpisode);
					}
					LookForFembedInString(tempThred, normalEpisode, d);
				}
			}

		}
	}
}


================================================
FILE: CloudStreamElectron/Models/ErrorViewModel.cs
================================================
using System;

namespace CloudStreamElectron.Models
{
    public class ErrorViewModel
    {
        public string RequestId { get; set; }

        public bool ShowRequestId => !string.IsNullOrEmpty(RequestId);
    }
}



================================================
FILE: CloudStreamElectron/Properties/launchSettings.json
================================================
{
  "iisSettings": {
    "windowsAuthentication": false,
    "anonymousAuthentication": true,
    "iisExpress": {
      "applicationUrl": "http://localhost:56467",
      "sslPort": 44365
    }
  },
  "profiles": {
    "Electron.NET App": {
      "commandName": "Executable",
      "executablePath": "electronize",
      "commandLineArgs": "start",
      "workingDirectory": "."
    },

    "IIS Express": {
      "commandName": "IISExpress",
      "launchBrowser": true,
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development",
        "ASPNETCORE_HOSTINGSTARTUPASSEMBLIES": "Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation"
      }
    },
    "CloudStreamElectron": {
      "commandName": "Project",
      "launchBrowser": true,
      "applicationUrl": "https://localhost:5001;http://localhost:5000",
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development",
        "ASPNETCORE_HOSTINGSTARTUPASSEMBLIES": "Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation"
      }
    }
  }
}



================================================
FILE: CloudStreamElectron/Views/_ViewImports.cshtml
================================================
﻿@using CloudStreamElectron
@using CloudStreamElectron.Models
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers



================================================
FILE: CloudStreamElectron/Views/_ViewStart.cshtml
================================================
﻿@{
    Layout = "_Layout";
}



================================================
FILE: CloudStreamElectron/Views/Home/Index.cshtml
================================================
﻿@using static CloudStreamForms.Core.CloudStreamCore;
@using CloudStreamElectron.Controllers;
@using ElectronNET.API;
@using Newtonsoft.Json;

@{
	ViewData["Title"] = "CloudStream 2";
}
<script suppress-error="BL9992">
	var guid;

	function topFunction() {
		document.body.scrollTop = 0; // For Safari
		document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
	}
	/*
	function download(data, filename, type) {
		var file = new Blob([data], { type: type });
		if (window.navigator.msSaveOrOpenBlob) // IE10+
			window.navigator.msSaveOrOpenBlob(file, filename);
		else { // Others
			var a = document.createElement("a"),
				url = URL.createObjectURL(file);
			a.href = url;
			a.download = filename;
			document.body.appendChild(a);
			a.click();
			setTimeout(function () {
				document.body.removeChild(a);
				window.URL.revokeObjectURL(url);
			}, 0);
		}
	}
	*/
	function load() {
		document.title = 'CloudStream 2';
		var search = document.getElementById("SearchBar");

		search.focus();
		LoadGuid();
		//	LoadTop100(1, false, false);
	}

	function LoadTop100(start, isTop100, isAnime) {

		$.ajax({
			url: '/FetchTop100/',
			dataType: "json",
			type: "GET",
			contentType: 'application/x-www-form-urlencoded; charset=utf-8',   //replace /json to the urlenoded
			data: { start: start, isTop100: isTop100, isAnime: isAnime, guid: currentGuid },          // data is not json
			async: true,
			processData: true,  //important to use it as true
			cache: true,

			success: function (data) {
				var addGrid = document.getElementById("Top100Grid");

				var inner = "";
				for (var i = 0; i < data.length; i++) {
					var d = data[i];
					//transform: translateX(155px);
					/*
	<div class="grid-element showme" style=" position: absolute; overflow: hidden; scale: 0.99; z-index: 10; border-radius: 3px; transition: all 0.1s; ">
		<div style="position: absolute; z-index: 11;">
			<h4 style="margin: 8px;">${d.name} ${d.rating}</h4>

			<p style="margin: 0px; margin-right:8px;margin-left:8px">${d.descript}</p>
		</div>

		<img style="height: 213px; width: 200px; -webkit-filter: blur(10px) brightness(50%); scale: 1.7;" src="${d.img}">
	</div>*/
					inner += `
<div class= "showhim">
	<button class="grid-element hold-poster" onmouseup=\"{loadPage('?url=${d.id}&name=${d.name}')\}">
		<img style="height:213px; width:144px; border-radius: 3px; " src="${d.img}">
	</button>
</div>
					`;
				}
				addGrid.innerHTML = inner;
			},
			error: function (xhr) {
			}
		});
	}


	function copyText(text) {
		function selectElementText(element) {
			if (document.selection) {
				var range = document.body.createTextRange();
				range.moveToElementText(element);
				range.select();
			} else if (window.getSelection) {
				var range = document.createRange();
				range.selectNode(element);
				window.getSelection().removeAllRanges();
				window.getSelection().addRange(range);
			}
		}
		var element = document.createElement('DIV');
		element.textContent = text;
		document.body.appendChild(element);
		selectElementText(element);
		document.execCommand('copy');
		element.remove();
	}
	/*
	var txt = document.getElementById('txt');
	var btn = document.getElementById('btn');
	btn.addEventListener('click', function () {
		copyText(txt.value);
	})*/
</script>

<body onload="load()">
</body>
<div style="margin-left: 30px;">
	<div class="Row">

		<div style="height:50px; margin-top:20px;" class="Column">
			<img src="~/img/csLogoOnly.png" style="width:190px; margin-top:auto; margin-bottom:auto; margin-right:10px;" />
			<a class="headerBtt">Movies</a>
			<a class="headerBtt">Tv-Shows</a>
			<a class="headerBtt">Anime</a>
		</div>
		<div style="width:50%; height:100px;" class="Column">

			<input value="" placeholder="Search..." spellcheck="false" autocomplete="off" maxlength="80" id="SearchBar" onfocus="searchFocus(true)" onblur="onBlurSearch()" onchange="searchFunc()" input[type="search" ] onkeyup="searchFunc()" style="margin-left:0%;margin-right:0%;width:100%" />
			<div id="SearchResultsDIV" style=" width: 100%; background-color:#303030">
			</div>
		</div>

	</div>

	<div id="main" style="margin-top:10px;">
		<div class="text-center" id="MainDiv" style="padding-bottom: 40px;">


			<!--<div style=" width: 50%; margin-left: 25%; margin-right: 25%; position: absolute; transform: translateX(-3px); z-index: 10;">
				<div style="margin-right: 10px;">
					<div id="SearchResultsDIV" style="background-color: #303030; border-radius:5px;">
					</div>
				</div>
			</div>-->


			<div id="Top100Grid" style="margin-top:10px;" class="grid-container grid-container--fill">

			</div>
		</div>
	</div>
</div>

<script>

    function myFunction() {
        div = document.getElementById("OverlayPage");
    }
    (function () {
        /*
        //   const { ipcRenderer } = require("electron");
        alert("da");
        var search = document.getElementById("SearchBar");
        search.addEventListener("change", () => {
            alert("heelo2");

            // ipcRenderer.send("search", search.value);
        });
        search.addEventListener("keyup", (ui) => {
            alert("heelo");
            @{
                //isLoaded = true;
              //  core.QuickSearch("hello world");
            }

            /*
            $.ajax({
                url: '/Search/',
                dataType: "json",
                type: "GET",
                contentType: 'application/x-www-form-urlencoded; charset=utf-8',    //replace /json to the urlenoded
                data: { search: search.value },          // data is not json
                async: true,
                processData: true,                                                  //important to use it as true
                cache: false,

                success: function (data) {
                    alert(data);
                },
                error: function (xhr) {
                    alert('error');
                }
            });
            //  Electron.Dialog.ShowErrorBox("dada", ui);
            //  ipcRenderer.send("search", search.value);
        });*/

        //});*/
    });
</script>



================================================
FILE: CloudStreamElectron/Views/Home/Privacy.cshtml
================================================
﻿@{
    ViewData["Title"] = "Privacy Policy";

}
<h1>@ViewData["Title"]</h1>

<p>Use this page to detail your site's privacy policy.</p>

<button id="HelloBtt">Hello</button>

<script>
            (function(){
                const { ipcRenderer } = require("electron");

                document.getElementById("HelloBtt").addEventListener("click", () => {
                    ipcRenderer.send("hello");
                });


            }());
</script>



================================================
FILE: CloudStreamElectron/Views/Result/Index.cshtml
================================================
﻿@using static CloudStreamForms.Core.CloudStreamCore;
@using CloudStreamElectron.Controllers;
@using ElectronNET.API;
@using Newtonsoft.Json;

@{
	ViewData["Title"] = "CloudStream 2";
}


<script src="/js/download.min.js"></script>
<!--<script src="~/js/hls.js"></script>-->
<!--
<script src="/js/jquery.animate-colors-min.js"></script>-->
<!--
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>-->
<script>

	const VIEW_TIME_POS = "ViewHistoryTimePos";
	const VIEW_TIME_DUR = "ViewHistoryTimeDur";
	const NEXT_AIRING = "NextAiringEpisode";
	const BOOKMARK_DATA = "BookmarkData";
	const VIEW_HISTORY = "ViewHistory";

	function GetKeyPath(folder, name = "") {
		var _s = ":" + folder + "-";
		if (name != "") {
			_s += name + ":";
		}
		return _s;
	}

	function _SetKey(path, value) {
		localStorage.setItem(path, value);
	}

	function SetKey(folder, name, value) {
		var path = GetKeyPath(folder, name);
		_SetKey(path, value);
	}

	function _GetKey(path, defVal) {
		return localStorage.getItem(path);
	}

	function _RemoveKey(path) {
		localStorage.removeItem(path);
	}

	function RemoveKey(folder, name) {
		_RemoveKey(GetKeyPath(folder, name));
	}

	function GetKey(folder, name, defVal) {
		var path = GetKeyPath(folder, name);
		var k = _GetKey(path, defVal);
		if (k == null) {
			return defVal;
		}
		else {
			return k;
		}
	}

	var currentSeason = 0;
	var currentDelay = 5000;
	var movieType = -1;
	var isElec = isElectron();

	function isElectron() {
		// Renderer process
		if (typeof window !== 'undefined' && typeof window.process === 'object' && window.process.type === 'renderer') {
			return true;
		}

		// Main process
		if (typeof process !== 'undefined' && typeof process.versions === 'object' && !!process.versions.electron) {
			return true;
		}

		// Detect the user agent when the `nodeIntegration` option is set to true
		if (typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent.indexOf('Electron') >= 0) {
			return true;
		}

		return false;
	}

	function SelectSeason(season) {
		currentSeason = season;
		var ses = document.getElementById("SeasonSelectBtt");

		$("#AddGrid").show();
		$("#AddGrid").fadeTo(400, 0);

		if (ses != null) {
			ses.textContent = "Season " + season;
			//ses.innerHTML = `Season ${season} <img src="/img/dropdown.png" style="height:10px; width:10px; margin-left:10px;">`;
		}
		GetSeasons(season);
	}

	function ToggleLoading(load) {
		if (isFullLoading) {
			load = false;
		}
		$("#IsLoading").show();

		let sty = load ? "opacity:1;" : "opacity:0;";
		document.getElementById("IsLoading").style = sty;
	}

	var isFullLoading = false;

	function ToggleLoadingTime(loadTime) {
		isFullLoading = true;
		$("#IsLoadingDereminate").show();
		$("#IsLoading").hide();
		$("#IsLoadingDereminate").fadeTo(100, 1);
		$("#IsLoadingDereminate").width = '0%';
		$("#IsLoadingDereminate").animate({ width: '100%' }, loadTime, "");
		$("#IsLoadingDereminate").fadeTo(100, 0);
		
		isFullLoading = false;
		//$("#IsLoadingDereminate").animate({ width: '100%' }, loadTime, "");
		//	$("#IsLoadingDereminate").hide();

	}

	function SelectDub(_isDub) {
		isDub = _isDub;

		SelectDubVisual(_isDub);
		GetSeasons(lastSeason);
	}

	function SelectDubVisual(_isDub) {
		isDub = _isDub;
		var ses = document.getElementById("DubSelectBtt");
		if (ses != null) {
			ses.textContent = isDub ? "Dub" : "Sub";
		}
	}

	var currentTitleName = "";

	var totalLoadTime = 4000;

	function load() {
		ToggleLoading(true);
		document.title = 'CloudStream 2 - Loading...';

		var _guid = localStorage.getItem("guid");

		// INIT
		$.ajax({
			url: '/LoadTitle/',
			dataType: "json",
			type: "GET",
			contentType: 'application/x-www-form-urlencoded; charset=utf-8',    //replace /json to the urlenoded
			data: { _url: document.documentURI, guid: _guid },          // data is not json
			async: true,
			processData: true,                                                  //important to use it as true
			cache: false,

			success: function (data) {
				let title = data.title;
				document.title = 'CloudStream 2 - ' + title.name;

				currentGuid = data.Guid;

				function Fade(classN, text) {
					$("#" + classN).hide();
					//    $(classN).innerText = text;
					$("#" + classN).fadeIn(200);
					if (text != "") {
						document.getElementById(classN).innerText = text;
					}
				}

				let img = document.getElementById("mainPosterImg");
				img.src = data.title.hdPosterUrl;

				Fade("img-background", "");
				Fade("YearLabel", title.year);
				Fade("RatedLabel", "Rated: " + title.rating);
				Fade("MinLabel", title.runtime);
				Fade("TitleLabel", title.name);
				Fade("DescriptLabel", title.description);

				$("#LoadingAll").fadeTo(200, 1);

				currentTitleName = title.name;
				img.style = "height: 100%; width: 100%;";

				let genres = title.genres;
				movieType = data.title.movieType;
				div = document.getElementById("GenreTags");
				div.innerHTML = "";
				for (i = 0; i < genres.length; i++) {
					let ele = document.createElement("li");
					ele.style = "margin-top:0px; list-style:none; border-bottom: 0px solid hsla(0,0%,100%,.05); padding-bottom:0px;" // BORDER border-bottom: 1px
					//ele.id = "fff"
					//   ele.text = "<button id=\"fff\">Iron man</button>"
					//${data[i].url}
					ele.innerHTML = `<button class=\"genreBtt\" style=\"border-radius:5px;\">${genres[i]}</button>`//data[i].name
					//ele.innerHTML =  "<span style=\"cursor: pointer\" onclick=\"myFunction()\">" + data[i].name + "</span><span style=\"color:white; background-color:#303F9F; border-radius:5px; padding:2px; margin:2px; border: 20px;\">" + data[i].year + "</span>";
					//  ele.innerHTML = "<a href=\"javascript: alert('Hello World!'); \">Execute JavaScript</a>"
					//<li style=" margin-top:10px; list-style:none; border-bottom: 1px solid hsla(0,0%,100%,.05); padding-bottom:10px;"><!--!--> <span style="cursor:pointer">Iron Man</span><!--!--> <span style="color:white; background-color:#303F9F; border-radius:5px; padding:2px; margin:2px; border: 20px;  ">2008</span>
					// ele.innerHTML = "<span href=\"/Result?id=" + data[i].url  + "&guid=" + guid+ "\"> "+ data[i].name + " "+ data[i].extra + "</span>";
					//ele.innerHTML = " <li onclick=\"myFunction()\" style=\"margin-top:10px; list-style:none; border-bottom: 1px solid hsla(0,0%,100%,.05); padding-bottom:10px;\"><span style=\"cursor: pointer\">" + data[i].name + "</span><span style=\"color:white; background-color:#303F9F; border-radius:5px; padding:2px; margin:2px; border: 20px;\">" + data[i].year + "</span>"
					div.appendChild(ele);
				}

				//TODO ADD recomended
				let recStack = document.getElementById("RecStack");
				let stackInner = "";
				for (var i = 0; i < data.title.recomended.length; i++) {
					var rec = data.title.recomended[i];
					/*name;
					posterUrl
					url*/
					stackInner += `
						<button class="grid-element hold-poster" onmouseup=\"{loadPage('?url=${rec.url}&name=${rec.name}')\}">
							<img style="height:213px; width:144px; border-radius: 3px; margin:10px;" src="${rec.posterUrl}">
						</button>`;
				}
				recStack.innerHTML = stackInner;
				document.getElementById("RecTxt").textContent = "Recommendations";

				// ========================================= SEASONS =========================================

				let seasonDrop = document.getElementById("SeasonDropDown");
				seasonDrop.innerHTML = "";

				for (var i = 0; i < data.title.seasons; i++) {
					let ele = document.createElement("button");
					ele.setAttribute("onclick", `SelectSeason(${(i + 1)})`);// = "class=\"dropSel\" onclick=\"alert('hello')\"";
					ele.className = "dropSel";
					ele.style = " z-index: 10; !important";
					ele.innerText = "Season " + (i + 1);
					seasonDrop.appendChild(ele);
				}

				let seasonPicker = document.getElementById("SeasonPicker");
				if (data.title.seasons <= 1) {
					seasonPicker.remove();
					SelectSeason(1);
				}
				else {
					seasonPicker.style = "";
					SelectSeason(1);
				}

				if (movieType == 2) {
					ToggleLoading(false);
					ToggleLoadingTime(totalLoadTime);
				}

				for (var i = 0; i < 100; i++) {
					x = document.getElementsByClassName("loadingItem");
					if (x != null && x.length > 0) {
						x[0].className = "";
					}
					else {
						break;
					}
				}

			},
			error: function (xhr) {

			}
		});
	}
	function LoadLinksInstant(episode, season) {
		return LoadLinks(episode, season, 0);
	}

	function OpenUrl(url) {
		window.location.href = data;
	}

	function DownloadFile(data, filename, type) {
		let file = new Blob([data], { type: type });
		if (window.navigator.msSaveOrOpenBlob) { // IE10+
			alert("false");
			window.navigator.msSaveOrOpenBlob(file, filename);
		}
		else { // Others
			var a = document.createElement("a"),
				url = URL.createObjectURL(file);
			a.href = url;
			a.download = filename;
			document.body.appendChild(a);
			a.click();
			setTimeout(function () {
				document.body.removeChild(a);
				window.URL.revokeObjectURL(url);
			}, 0);
		}
	}

	var lastData;
	var lastMirror = 0;
	var lastSeason = 1;
	var lastEpisodeIndex = 0;
	var currentSeason;
	var isDub = true;
	var isMovie = false;

	function NextMirror() {
		lastMirror = lastMirror + 1;
		if (lastMirror >= lastData.links.length) {
			lastMirror = 0;
		}
		SelectMirror(lastMirror);
	}

	function MainDownload() {
		let baseLink = lastData.links[lastMirror];
		let url = baseLink.baseUrl;
		let name = baseLink.name;
		DownloadFile(url, currentSeason[lastEpisodeIndex - 1].name + " - " + name + ".mp4", "video/mp4");
	}

	function LoadBar(delay) {
		var holder = document.getElementById("LoadingHolder");

		holder.innerHTML = `
		<div class="OverlayPage" id="LoadingBarBg" style="background-color:var(--LoadingBg); position:fixed;">
			<div style="width: 60%; height:7px; margin: auto; top: 50%; background-color:var(--LoadingBarBg); margin-left:20%; margin-right:20%; position:fixed"></div>
			<div id="myBar" style="width: 0%; height:7px;  top: 50%; background-color:var(--LoadingBar); margin-left:20%; margin-right:20%; position:fixed"></div>
			<a style="margin: auto; position:fixed; text-align:center; font-size: 16px;text-align:center; width:100%;top:45%">Loading...</a>
		</div>
		`;
		$("#LoadingBarBg").hide();
		$("#LoadingBarBg").fadeIn(1000);
		$("#myBar").animate({ width: '60%' }, delay, "");
		setTimeout(() => {
			$("#LoadingBarBg").fadeOut(1000);
		}, delay - 1000);

		/*
		var elem = document.getElementById("myBar");
		var width = 0.0;
		var id = setInterval(frame, 20);
		function frame() {
			if (width >= 100) {
				clearInterval(id);
			} else {
				console.log(width);
				width += (100/(delay/20));
				elem.style.width = (width*0.6) + '%';
				//elem.innerHTML = width * 1 + '%';
			}
		}*/
	}

	function SelectMirror(mirror) {
		lastMirror = mirror;
		var holder = document.getElementById("VideoHolder");
		var inner = "";
		var link = lastData.links[mirror];
		var isM3u8 = link.typeName == "m3u8";
		var url = lastData.links[mirror].baseUrl;


		holder.innerHTML = `
		<div class="OverlayPage" id="OverlayPage" style="background-color:black; margin:0px; padding:0px; ">
			<video style="width:100%" data-poster="https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-HD.jpg" controls id="MainVideo" >
				<source src="${(isM3u8 ? "" : url)
			} " type="${(isM3u8 ? "application/vnd.apple.mpegurl" : "video/mp4")}">
	Your browser does not support HTML video.
			</video >
		<button  onclick=\"NextMirror()\" class="genreBtt" style="border-radius:5px; text-align:center; ">Next Mirror</button>
		<button  onclick=\"NextMirror()\" class="genreBtt" style="border-radius:5px; text-align:center; ">XStream 720p</button>
		<button  ${(isM3u8 ? "" : "onclick=\"MainDownload()\"")}class="genreBtt" style="border-radius:5px; text-align:center; ${(isM3u8 ? "opacity:0.1;" : "")}">Download</button>
		</div >
		`;
		/*		<button  ${(isM3u8 ? "" : "onclick=\"OpenUrl()\"" )}class="dropbtn" style="border-radius:5px; text-align:center; ${(isM3u8 ? "opacity:0.1;" : "")}">Open</button>*/


		var video = document.getElementById("MainVideo");
		if (isM3u8) {
			if (Hls.isSupported()) {
				var hls = new Hls();
				var m3u8Url = decodeURIComponent(url)
				hls.loadSource(m3u8Url);
				hls.attachMedia(video);
				hls.on(Hls.Events.MANIFEST_PARSED, function () {
					video.play();
				});
				document.title = url
			}
			else if (video.canPlayType('application/vnd.apple.mpegurl')) {
				video.src = url;
				video.addEventListener('canplay', function () {
					video.play();
				});
				video.volume = 0.3;
				document.title = url;
			}
		}
		else {

		}
		video.addEventListener('error', function (event) { NextMirror(); }, true);
	}

	function GetIdFromLoadedEpisode(episode) {
		if (episode < 1) episode = 1;
		return currentSeason[episode - 1].id;
	}

	function ToggleEpisode(episode) {
		/*
		var $contextMenu = $("#contextMenu");
		$contextMenu.hide();*/
		SetEpisode(episode, !GetKey(VIEW_HISTORY, GetIdFromLoadedEpisode(episode), false));
	}

	function SetEpisode(episode, setTo, update = true) {
		var id = GetIdFromLoadedEpisode(episode);
		if (setTo) {
			SetKey(VIEW_HISTORY, id, true);
		}
		else {
			RemoveKey(VIEW_HISTORY, id);
		}
		if (update) {
			LoadEpisodes(false);
		}
	}

	function PlayEpisode(episode, forceInApp = false, player = "vlc") {
		SetEpisode(episode, true);
		if (isElec && !forceInApp) {
			LoadVlc(episode, player, 0); // CHANGE POS TO SIMULATE ELC
		}
		else {
			return;/*
			lastEpisodeIndex = episode;
			SelectMirror(0);*/
		}
	}

	var episodeLinks = {};

	async function ShowMenu(data, episode, season, autoPlay) {

		lastData = data;

		if (autoPlay) {
			PlayEpisode(episode);
		}
		else {
			var buttons;
			if (isElec) {
				buttons = ["Play VLC", "Play MPV", "Copy Link", "Reload"]; // , "Play In App" "Play External App",
			}
			else {
				buttons = ["Copy Link", "Reload"]; // "Play",
			}
			var res = await DisplayActionSheet(isMovie ? currentTitleName : currentSeason[episode - 1].name, buttons);
			if (res != "Cancel") {
				if (res == "Play" || res == "Play In App") {
					PlayEpisode(episode, true);
				}
				else if (res == "Play External App") {
					PlayEpisode(episode, false);
				}
				else if (res == "Play VLC") {
					PlayEpisode(episode, false, "vlc");
				}
				else if (res == "Play MPV") {
					PlayEpisode(episode, false, "mpv");
				}
				else if (res == "Copy Link") {
					var allLinks = [];
					var allNames = [];
					for (var i = 0; i < data.links.length; i++) {
						allLinks.push(data.links[i].baseUrl);
						allNames.push(data.links[i].PublicName);
					}

					var link = await DisplayActionSheet("Copy Link", allNames, true);
					if (link >= 0) {
						navigator.clipboard.writeText(allLinks[link]);
					}
				}
				else if (res == "Reload") {
					LoadLinks(episode, season, currentDelay, false, true);
				}
			}
		}
	}


	//delay in ms
	function LoadLinks(episode, season, delay, autoPlay = true, reloadAllLinks = false) {
		var epId = GetIdFromLoadedEpisode(episode);

		if (!reloadAllLinks) {
			if (epId in episodeLinks) {
				ShowMenu(episodeLinks[epId], episode, season, autoPlay);
				return;
			}
		}

		//TODO ADD CHECK IF LINKS ARE LOADED
		ToggleBlur(true);
		if (delay > 0) {
			LoadBar(delay);
		}

		$.ajax({
			url: '/GetLoadLinks/',
			dataType: "json",
			type: "GET",
			contentType: 'application/x-www-form-urlencoded; charset=utf-8',    //replace /json to the urlenoded
			data: { episode: episode, season: season, delay: delay, guid: currentGuid, isDub: isDub, reloadAllLinks: reloadAllLinks },          // data is not json
			async: true,
			processData: true,                                                  //important to use it as true
			cache: false,

			success: async function (data) {
				ToggleBlur(false);
				if (data == "" || data == null) {

				}
				else {
					episodeLinks[epId] = data;
					ShowMenu(data, episode, season, autoPlay);
				}
			},
			error: function (xhr) {
				ToggleBlur(false);
			}
		});
	}

	function LoadVlc(episode, player, startTime) {
		$.ajax({
			url: '/LoadPlayer/',
			dataType: "json",
			type: "GET",
			contentType: 'application/x-www-form-urlencoded; charset=utf-8',    //replace /json to the urlenoded
			data: { episode: episode, player: player, guid: currentGuid },          // data is not json
			async: true,
			processData: true,                                                  //important to use it as true
			cache: false,

			success: function (data) {
			},
			error: function (xhr) {
			}
		});
	}

	function Sleep(ms) {
		return new Promise(resolve => setTimeout(resolve, ms));
	}


	var selectedButton = -1;

	function SelectButton(index) {
		selectedButton = index;
	}

	function ToggleBlur(blur) {
		var mainHolder = document.getElementById("InfoHolder");
		mainHolder.className = blur ? "blur-on" : "";
	}

	async function DisplayActionSheet(title, buttons, returnNumber = false) {
		selectedButton = -1;
		var holder = document.getElementById("SelectHolder");

		var buttonsHtml = "";
		for (var i = 0; i < buttons.length; i++) {
			buttonsHtml += `
			<button class="searchRes" onfocus=\"SelectButton(${i})\" style="text-align:center; height:50px">
				${buttons[i]}
			</button>
			`
		}


		holder.innerHTML = `
		<div class="OverlayPage" id="SelectBarBg" style="background-color:var(--LoadingBg); position: fixed; vertical-align:middle;">
			<h1>${title}</h1>
			<div style="margin: auto; width: 80%; max-height: 65%; scrollbar-width: thin; overflow-y: auto; overflow-x: hidden;">
				${buttonsHtml}
			</div>
			<div style="margin: auto; width: 80%; ">
				<button class="searchRes" onfocus="SelectButton(-2)" style="text-align:center; height:50px;">Cancel</button>
			</div>
		</div>
		`;
		$("#SelectBarBg").hide();
		$("#SelectBarBg").fadeIn(250);

		while (selectedButton == -1) {
			await Sleep(100);
		}

		$("#SelectBarBg").fadeOut(250);
		await Sleep(250);
		holder.innerHTML = "";

		if (returnNumber) {
			if (selectedButton == -2) {
				return -1;
			}
			return selectedButton;
		}
		else {
			if (selectedButton == -2) {
				return "Cancel";
			}
			return buttons[selectedButton];
		}
	}

	function LoadEpisodes(fadeIn = true) {
		var data = currentSeason;

		var season = lastSeason;
		var innerHtml = "";
		//	var _cal = GetKey(VIEW_HISTORY, data[0].id, false) ? "#303F9F" : "#a6a6a6";

		var grid = document.getElementById("AddGrid");
		for (var i = 0; i < data.length; i++) {
			var eId = data[i].id;

			var hasVisited = GetKey(VIEW_HISTORY, eId, false);
			var descriptColor = hasVisited ? "var(--DescriptVisited)" : "var(--DescriptNotVisited)";//"#303F9F" : "#a6a6a6";
			var mainColor = hasVisited ? "var(--EpisodeVisited)" : "var(--EpisodeNotVisited)";//"#829eff" : "#ffffff";
			if (!fadeIn) {
				$("#NameEp" + eId).css({ color: mainColor }, 250);
				$("#DescriptEp" + eId).css({ color: descriptColor }, 250);
				$("#RatingEp" + eId).css({ color: descriptColor }, 250);
				//	$('#DescriptEp' + eId).animate({ backgroundColor: mainColor, width: hasVisited ? '100%' : '60%'}, 500);
				//	$('#InfoDiv').fadeOut();//({ backgroundColor: _cal });

				/*
				$(`#DescriptEp_${eId}`).animate({ color: descriptColor });
				$(`#RatingEp_${eId}`).animate({ color: descriptColor });*/
			}
			else {
				var nameTitle = data[i].name;
				if (!isMovie) {
					nameTitle = (i + 1) + ". " + nameTitle;
				}
				var _height = 160;
				var _float = "width: 100%; float: left;";
				/*if (isMovie) {
					var _height = 400;
					_float = "width: 80%; margin-left:10%;";
				}*/
				var _min_height = 30;
				var _width = (_height - _min_height) * 1.78;


				var episode = i + 1;
				innerHtml += `
						<div class="click-poster grid-element" style="height:${_height - _min_height}px; width:${_width}px;" oncontextmenu=\"ToggleEpisode(${episode});\" onclick=\"LoadLinks(${(isMovie ? -1 : episode)},${season},${currentDelay},false);\" ">
							<img style="height:100%;border-radius:2px;" class="SelectEpisodeImg" src="${data[i].posterUrl}" />
							<div style="bottom:0px; position: absolute; text-align:center;background-color:rgba(0,0,0,0.3); width:100%; padding-top:10px; padding-bottom:10px;">
								<a  id="NameEp${eId}" class="EpisodeText" style="color:${mainColor};bottom:5px;right:0%; left:0%">${nameTitle}</a>
							</div>

							<!--<div style="transition: width 0.2s linear; transition: .5s ease; left: 50%; top: 50%; position: absolute; transform: translate(-50%, -50%); -ms-transform: translate(-50%, -50%); text-align: center;">
								<img src="/img/PlayBtt.png" onclick=\"LoadLinks(${(isMovie ? -1 : episode)},${season},${currentDelay},false);\" class="PlayButton" />
							</div>-->
						</div>
				`;
				/*`
			<div style = "${_float}" class="PlayEpisodes">
				<div style="width: 100%; margin-left:auto;
							 height:${_height}px;
							  font-size: 25px;
							  cursor: pointer;
							  line-height: 0.7;
							  color: white; ">
					<div style="margin: 10px; ">

						<div
							oncontextmenu=\"ToggleEpisode(${episode});\"
							style="
							height:${_height - _min_height}px;
							background-color:var(--EpisodeHolderBg);
							border-radius:5px;
							padding: 10px;
							overflow:hidden;"
							onclick=\"LoadLinks(${(isMovie ? -1 : episode)},${season},${currentDelay},false);\"
							>

							<div style="height:${_height - _min_height}px; width:${_width}px; float:left; position: relative; left: 0; top: 0;">
								<img style="height:100%;border-radius:2px;" class="SelectEpisodeImg" src="${data[i].posterUrl}" />
								<div style="transition: width 0.2s linear; transition: .5s ease; left: 50%; top: 50%; position: absolute; transform: translate(-50%, -50%); -ms-transform: translate(-50%, -50%); text-align: center;">
									<img src="/img/PlayBtt.png" onclick=\"LoadLinks(${(isMovie ? -1 : episode)},${season},${currentDelay});\" class="PlayButton" />
								</div>
							</div>
							<div style="margin-left:${_width}px; padding:10px; " >
								<h4 id="NameEp${eId}" class="EpisodeText" style=" font-weight:400; font-size:15px; padding-top:10px; color:${mainColor}; margin:2px;">
									${nameTitle}
								</h4>
								<h4 id="RatingEp${eId}" class="EpisodeText" style=" font-weight:400; font-size:15px; padding-top:10px; color:${descriptColor}; margin:2px;">
									★ ${data[i].rating}
								</h4>
								<h4 id="DescriptEp${eId}" class="EpisodeText" style=" font-weight:400; font-size:15px; padding-top:10px; color:${descriptColor}; margin:2px;line-height:1.2em;">
									${data[i].description}
								</h4>
							</div>
			</div></div></div></div > `;*/
			}
		}
		if (fadeIn) {
			grid.innerHTML = innerHtml;
			//$("#AddGrid").hide();
			$("#AddGrid").fadeTo(400, 1);
		}
	}

	function GetSeasons(season) {
					ToggleLoading(true);
		
		lastSeason = season;

		$.ajax({
			url: '/GetSeasons/',
			dataType: "json",
			type: "GET",
			contentType: 'application/x-www-form-urlencoded; charset=utf-8',    //replace /json to the urlenoded
			data: { season: season, guid: currentGuid, isDub: isDub },          // data is not json
			async: true,
			processData: true,                                                  //important to use it as true
			cache: false,

			success: function (_data) {
				ToggleLoading(false);
				var data = _data.Episodes;
				currentSeason = data;

				SelectDubVisual(_data.dubExists && isDub);
				var dubPicker = document.getElementById("DubPicker");

				if (movieType != 2) {
					dubPicker.style = "visibility:hidden;";
				}
				else {
					if (!_data.dubExists || !_data.subExists) {
						dubPicker.style = "";
					}
					else {
						dubPicker.style = "visibility:visible;";
					}
				}

				// ========================================= DUB/SUB =========================================
				var dubDrop = document.getElementById("DubDropDown");

				dubDrop.innerHTML = "";
				if (_data.dubExists) {
					var dubEle = document.createElement("button");
					dubEle.setAttribute("onclick", `SelectDub(true)`);
					dubEle.className = "dropSel";
					dubEle.style = " z-index: 10; !important";
					dubEle.innerText = "Dub"
					dubDrop.appendChild(dubEle);
				}
				if (_data.subExists) {
					var subEle = document.createElement("button");
					subEle.setAttribute("onclick", `SelectDub(false)`);
					subEle.className = "dropSel";
					subEle.style = " z-index: 10; !important";
					subEle.innerText = "Sub"
					dubDrop.appendChild(subEle);
				}

				//visibility:visible;


				isMovie = movieType == 3 || movieType == 0;
				document.getElementById("EpTxt").textContent = isMovie ? "Movie" : "Episodes";

				LoadEpisodes(true);
			},
			error: function (xhr) {

			}
		});
	}

	window.onload = load;

	//https://stackoverflow.com/questions/18666601/use-bootstrap-3-dropdown-menu-as-context-menu
	$(function () { // FIREFOX RIGHT CLICK

		var $contextMenu = $("#contextMenu");

		$("body").on("contextmenu", "", function (e) {
			$contextMenu.css({
				display: "block",
				left: e.pageX,
				top: e.pageY
			});
			return false;
		});

		$('html').click(function () {
			$contextMenu.hide();
		});

	});
</script>

<div style="float: right;
		position: absolute;
		width: 80%;
		padding-left: 10%;
		margin-left: -10px;
		margin-top: 4px;
		z-index: 10;
		height: 0px;
">
	<div style="float: right;
		width: 40%;
		margin-left: 10px;
		margin-right: 10px;
		height: 0px;" spellcheck="false">

		<input value="" placeholder="Search..." class="searchExpand" style="width:100%; margin:0px;" autocomplete="off" maxlength="80" id="SearchBar" onfocus="searchFocus(true)" onblur="onBlurSearch()" onchange="searchFunc()" input[type="search" ]="" onkeyup="searchFunc()">
		<div id="SearchResultsDIV" style=" width: 100%; background-color:#303030">
		</div>
	</div>
</div>


<div id="InfoHolder" style="		min-width: 1000px;
		margin: auto;
		width: 80%;
		position: relative;
		height: auto;
		min-height: 100% !important;

		background-color: var(--MainBg);
		border-radius: 10px;
	">


	<div class="" onmouseup="window.location = '/'" href="/" style="		cursor: pointer;
		text-decoration: none;
		width: auto;
		position: absolute;
		margin: 8px;
		z-index: 12
">
		<img src="~/img/outline_home_white_48dp.png" style="height:30px; float:left; position:relative; opacity:0.5" />
		<a style="		opacity: 0.5;
		position: relative;
		top:5px;
		left:10px;
		">Home</a>
	</div>

	<div>
		<div class="loadingBar" id="IsLoading"></div>
		<div id="IsLoadingDereminate" class="loadingBarDereminate" style="width: 0%; display:none; background-color:var(--LoadingBar); "></div>
	</div>

	<!--#FFFFFF03-->
	<div style="padding: 40px; padding-top:50px;">

		<div>
			<div style="  margin-left:10px; ">
				<div style="    height: 201px;
        width: 136.5px;
        float: left;
        margin-right:10px;
        background-color: #222
    " id="img-background" class="loadingItem">
					<img id="mainPosterImg" />
				</div>
				<div>
					<div style="height:30px;width:90%; padding:0px;" class="loadingItem">
						<h2 id="TitleLabel" style="text-wrap:none; margin-top:0px;"></h2>
					</div>
					<div id="InfoDiv" class="loadingItem" style="width:80%;  height:25px;">
						<a style="		color: var(--TitleRated);
		font-weight: 500;
		margin-right: 10px;
		font-size: 18px;" id="RatedLabel"></a>
						<a style="		color: var(--TitleYear);
		margin-left: 0px;" id="YearLabel"> </a>
						<a style="        color: #919191;
        margin-left: 6px;
        width: 100px;" id="MinLabel"> </a>
					</div>
					<div class="loadingItem" style=" height:auto;" id="DescriptHolder">
						<a style="		color: var(--TitleDescript);
		font-weight: 500;
		margin-top: 10px;
	" id="DescriptLabel"></a>
					</div>
					<div class="loadingItem" id="GenreTags" style="width:80%; margin-top:10px; height:50px;">

					</div>
				</div>

				<div style=" visibility:hidden;" class="dropdown" id="SeasonPicker">
					<button id="SeasonSelectBtt" class="genreBtt" style="border-radius:5px; float:left; text-align:center; width:105px;">Season 1</button>
					<div class="dropdown-content" id="SeasonDropDown" style="position: absolute; max-height: 220px; scrollbar-width: thin; overflow-y: auto; overflow-x: hidden;">

					</div>
				</div>
				<div style=" visibility:hidden;" class="dropdown" id="DubPicker">
					<button id="DubSelectBtt" class="genreBtt" style="border-radius:5px; float:left; text-align:center; width:105px;">Dub</button>
					<div class="dropdown-content" id="DubDropDown" style="position:absolute">

					</div>
				</div>
			</div>
		</div>

		<div class="loadingItem" id="ChangeItems" style="float:left; width:220px; margin-right:60%; margin-top:10px; margin-left:10px; height:auto; ">


			<!--
			<div style="float:left" class="dropdown">

				<button class="dropbtn" style="border-radius:5px;">Dub<img src="~/img/dropdown.png" style="height:10px; width:10px; margin-left:10px;" /></button>
				<div class="dropdown-content" style="width:70px">
					<button class="dropSel" style="width:70px">Dub</button>
					<button class="dropSel" style="width:70px">Sub</button>
				</div>
			 </div>-->
		</div>
	</div>

	<div style="opacity:0" id="LoadingAll">

		<h3 style="font-weight: 300; font-size: 20px;"><span id="EpTxt">Loading...</span></h3>

		<div class="grid-container grid-container--fill" style="width: 100%;
		margin: auto;
		float: left;
		position: relative;
		margin-top: 0px;
		margin-bottom:30px;
		display: table;
		clear: both;
		display: flex;
		flex-direction: row;
		justify-content: center;
		flex-wrap: wrap;
	" id="AddGrid">
		</div>

		<h3 style="font-weight: 300; font-size: 20px;"><span id="RecTxt">Loading...</span></h3>

		<div class="grid-container grid-container--fill" style="		width: 100%;
		margin: auto;
		position: relative;
		margin-top: 0px;
		margin-bottom: 30px;
		display: table;
		clear: both;
		display: flex;
		flex-direction: row;
		justify-content: center;
		flex-wrap: wrap;
	" id="RecStack">
		</div>
	</div>
</div>

<div id="LoadingHolder"></div>
<div id="VideoHolder"></div>
<div id="SelectHolder"></div>

<!--margin-left: auto; margin-right: auto; display: block; height:100%-->
<!--
<div class="OverlayPage" id="OverlayPage" style="background-color:black; margin:0px; padding:0px;">
	<video style="width:100%" data-poster="https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-HD.jpg" controls>
		<source src="https://storage.googleapis.com/skilful-vertex-287812/CWJIK5TODG44/23a_1599211411_116269.mp4" type="video/mp4">
		Your browser does not support HTML video.
	</video>
</div>
<!--

<div class="loadingItem"  id="ChangeItems" style="float:right; width:80%; margin-top:20px; height:30px; ">
			<button id="genreBtt">Season 2</button>
			<button id="genreBtt">Dub</button>
		</div>

<div>
	<h1 style="text-align:start; font-weight:bold">Iron man</h1>
	<a style="color: #4257d8; font-size:18px; font-weight:bold;">Rated 7.9</a>
	<a style="color: #afafaf; font-size:16px; padding:12px; text-align:center; ">2008</a>
	<a style="color: #afafaf;
		font-size: 16px;
		text-align: center;
	">126min</a>
	<h1 style="text-align:start; font-size:16px;">After being held captive in an Afghan cave, billionaire engineer Tony Stark creates a unique weaponized suit of armor to fight evil. </h1>

</div>
	-->



================================================
FILE: CloudStreamElectron/Views/Shared/_Layout.cshtml
================================================
﻿<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>@ViewData["Title"] - CloudStreamElectron</title>
	<!--<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />-->
	<!--<link rel="stylesheet" href="~/css/normalize.css" />-->
	<link rel="stylesheet" href="https://cdn.rawgit.com/mfd/f3d96ec7f0e8f034cc22ea73b3797b59/raw/856f1dbb8d807aabceb80b6d4f94b464df461b3e/gotham.css">
	<link rel="stylesheet" href="~/css/mainSite.css" />

	<script src="https://code.jquery.com/jquery-3.5.1.min.js"
			integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
			crossorigin="anonymous"></script>
	<!--<script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"
			integrity="sha256-eGE6blurk5sHj+rmkfsGYeKyZx3M4bG+ZlFyA7Kns7E="
			crossorigin="anonymous"></script>-->


	<!--
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script type='text/javascript' src='/js/jquery-ui.min.js'></script>-->
	<!--<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans" />-->
	<!--<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">-->
	<!-- <link rel="stylesheet" href="https://unpkg.com/placeholder-loading/dist/css/placeholder-loading.min.css">-->
	<!-- <link rel="stylesheet" href="~/css/site.css" />-->
</head>
<body class="bg" id="mainHolder" onmouseup="onReleaseSearch()">
	<!--
	<header>
		<nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3">
			<div class="container">
				<a class="navbar-brand" asp-area="" asp-controller="Home" asp-action="Index">CloudStreamElectron</a>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".navbar-collapse" aria-controls="navbarSupportedContent"
						aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="navbar-collapse collapse d-sm-inline-flex flex-sm-row-reverse">
					<ul class="navbar-nav flex-grow-1">
						<li class="nav-item">
							<a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="Index">Home</a>
						</li>
						<li class="nav-item">
							<a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>
	</header>
		-->
	<div class="container" style="		height: 100%; ">
		<main role="main" class="pb-3" style="height:100%">
			@RenderBody()
		</main>
	</div>
	<!--
	<footer class="border-top footer text-muted">
		<div class="container">
			&copy; 2020 - CloudStreamElectron - <a asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
		</div>
	</footer>-->
	<script src="~/lib/jquery/dist/jquery.min.js"></script>
	<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
	<script src="~/js/site.js" asp-append-version="true"></script>
	@RenderSection("Scripts", required: false)

	<script>
		var currentGuid = "";

		function loadPage(url) {
			document.location = "/Result" + url;
		}
		function LoadGuid() {
			var _guid = localStorage.getItem("guid");
			// INIT
			$.ajax({
				url: '/Setup/',
				dataType: "json",
				type: "GET",
				contentType: 'application/x-www-form-urlencoded; charset=utf-8',    //replace /json to the urlenoded
				data: { guid: _guid },          // data is not json
				async: false,
				processData: true,                                                  //important to use it as true
				cache: false,

				success: function (data) {
					currentGuid = data;
					localStorage.setItem("guid", currentGuid);
				},
				error: function (xhr) {
				}
			});
		}



		var isOnSearch = false;
		function onBlurSearch() {
			isOnSearch = false;
		}

		function onReleaseSearch() {
			if (!isOnSearch) {
				searchFocus(false);
			}
		}

		function searchFocus(isFocused) {
			isOnSearch = isFocused;
			var searchdiv = document.getElementById("SearchResultsDIV");
			var topGrid = document.getElementById("Top100Grid");
			searchdiv.style.visibility = isFocused ? "visible" : "collapse";
			if (topGrid != null) {
			topGrid.style.opacity = isFocused ? 0.5 : 1;
			}
		}

		// ================================================ SEARCH ================================================
		function searchFunc() {
			if (currentGuid == "") return;

			var search = document.getElementById("SearchBar");
			var searchdiv = document.getElementById("SearchResultsDIV");
			if (search.value.length > 0) {
				$.ajax({
					url: '/Search/',
					dataType: "json",
					type: "GET",
					contentType: 'application/x-www-form-urlencoded; charset=utf-8',   //replace /json to the urlenoded
					data: { search: search.value, guid: currentGuid },          // data is not json
					async: true,
					processData: true,  //important to use it as true
					cache: false,

					success: function (data) {
						searchdiv.innerHTML = "";
						var inner = "";
						for (i = 0; i < data.length; i++) {
							var extra = data[i].extra;

							inner += `
                    <button class="searchRes"  onmouseup=\"{loadPage('?url=${data[i].url}&name=${data[i].name}&year=${data[i].year}')\}">
						<img class="searchResImg" src='${data[i].posterUrl}'>
                        <div>
							<a style="color:#e6e6e6">${data[i].name} ${((extra == "" || extra == null) ? "" : " - " + extra)}</a>
							<div>
							    <a style="font-size:14px;color:#828282">${data[i].year}</a>
							</div>
                        </div>
                    </button>
                    `

							/*
							var ele = document.createElement("div");
							ele.className = "searchRes";
	
							//ele.style = "margin-top:0px; list-style:none; border-bottom: 0px solid hsla(0,0%,100%,.05); padding-bottom:0px;" // BORDER border-bottom: 1px
							//ele.id = "fff"
						 //   ele.text = "<button id=\"fff\">Iron man</button>"
							//${data[i].url}
							var extra = data[i].extra;
							//ele.innerHTML = `<button class=\"searchRes\" onfocus=\"{loadPage('?url=${data[i].url}&name=${data[i].name}&year=${data[i].year}&guid=${guid}')\}">${data[i].name} ${((extra == "" ||  extra == null) ? "" : " - " +  data[i].extra)}</button>`//data[i].name
							ele.innerHTML = `<a ">${data[i].name} ${((extra == "" ||  extra == null) ? "" : " - " +  data[i].extra)}</a>`//data[i].name
							ele.onfocus = "loadPage('?url=${data[i].url}&name=${data[i].name}&year=${data[i].year}&guid=${guid}')";
	
	
	
							//ele.innerHTML =  "<span style=\"cursor: pointer\" onclick=\"myFunction()\">" + data[i].name + "</span><span style=\"color:white; background-color:#303F9F; border-radius:5px; padding:2px; margin:2px; border: 20px;\">" + data[i].year + "</span>";
						  //  ele.innerHTML = "<a href=\"javascript: alert('Hello World!'); \">Execute JavaScript</a>"
							//<li style=" margin-top:10px; list-style:none; border-bottom: 1px solid hsla(0,0%,100%,.05); padding-bottom:10px;"><!--!--> <span style="cursor:pointer">Iron Man</span><!--!--> <span style="color:white; background-color:#303F9F; border-radius:5px; padding:2px; margin:2px; border: 20px;  ">2008</span>
						   // ele.innerHTML = "<span href=\"/Result?id=" + data[i].url  + "&guid=" + guid+ "\"> "+ data[i].name + " "+ data[i].extra + "</span>";
							//ele.innerHTML = " <li onclick=\"myFunction()\" style=\"margin-top:10px; list-style:none; border-bottom: 1px solid hsla(0,0%,100%,.05); padding-bottom:10px;\"><span style=\"cursor: pointer\">" + data[i].name + "</span><span style=\"color:white; background-color:#303F9F; border-radius:5px; padding:2px; margin:2px; border: 20px;\">" + data[i].year + "</span>"
							 div.appendChild(ele);*/
						}
						searchdiv.innerHTML = inner;
						searchdiv.focus();
					},
					error: function (xhr) {
					}
				});
			}
			else {
				searchdiv.innerHTML = "";
			}
		}
	</script>
</body>

</html>



================================================
FILE: CloudStreamElectron/Views/Shared/_ValidationScriptsPartial.cshtml
================================================
﻿<script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>



================================================
FILE: CloudStreamElectron/Views/Shared/Error.cshtml
================================================
﻿@model ErrorViewModel
@{
    ViewData["Title"] = "Error";
}

<h1 class="text-danger">Error.</h1>
<h2 class="text-danger">An error occurred while processing your request.</h2>

@if (Model.ShowRequestId)
{
    <p>
        <strong>Request ID:</strong> <code>@Model.RequestId</code>
    </p>
}

<h3>Development Mode</h3>
<p>
    Swapping to <strong>Development</strong> environment will display more detailed information about the error that occurred.
</p>
<p>
    <strong>The Development environment shouldn't be enabled for deployed applications.</strong>
    It can result in displaying sensitive information from exceptions to end users.
    For local debugging, enable the <strong>Development</strong> environment by setting the <strong>ASPNETCORE_ENVIRONMENT</strong> environment variable to <strong>Development</strong>
    and restarting the app.
</p>



================================================
FILE: CloudStreamElectron/wwwroot/css/mainSite.css
================================================
﻿
:root {
	--whiteBorder : #e6e6e6;
	--mainBlueBG: #111; /*0f1925;;*/
	--mainBlackBg: #13131b;
	--mainUTxt: #7d7d7d;
	--mainTxt: fbfbfc;
	--lightBlue: #829eff;
	--darkBlue: #303F9F;
	--mediumBlue: #3292f2;
	--bgColor: #111111;
	--grayTxt: #a6a6a6;
	--whiteTxt: #e6e6e6;
	/*CLOUDSTREAM COLORS*/
	--LoadingBg: #000000C0;
	--LoadingBar: #303e9f;
	--LoadingBarBg: #3c3c3c;
	--DescriptNotVisited: #a6a6a6;
	--DescriptVisited: #303F9F;
	--EpisodeVisited: #b5c7ff; /*#829eff;*/
	--EpisodeNotVisited: #ffffff;
	--EpisodeHolderBg: #191919;
	--MainBg: #151515;
	--TitleRated: #3e54e2;
	--TitleYear: #919191;
	--TitleDescript: #c7c7c7;
	--TitleMin: #919191;
	/*
    --blue: #007bff;
    --indigo: #6610f2;
    --purple: #6f42c1;
    --pink: #e83e8c;
    --red: #dc3545;
    --orange: #fd7e14;
    --yellow: #ffc107;
    --green: #28a745;
    --teal: #20c997;
    --cyan: #17a2b8;
    --white: #fff;
    --gray: #6c757d;
    --gray-dark: #343a40;
    --primary: #007bff;
    --secondary: #6c757d;
    --success: #28a745;
    --info: #17a2b8;
    --warning: #ffc107;
    --danger: #dc3545;
    --light: #f8f9fa;
    --dark: #343a40;
    --breakpoint-xs: 0;
    --breakpoint-sm: 576px;
    --breakpoint-md: 768px;
    --breakpoint-lg: 992px;
    --breakpoint-xl: 1200px;
    --font-family-sans-serif: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
    --font-family-monospace: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;*/
}

#contextMenu { /* FIREFOX RIGHT CLICK */
	position: absolute;
	display: none;
}

html, body {
	/* background-color: #111111;*/ /*#222222;*/
	color: #e6e6e6;
	font-family: GothamPro;
	font-size: 1em;
	height: 100%;
	scrollbar-width: thin /*thin*/;
}

/*::-webkit-scrollbar {
    display: none;
}*/

::-webkit-scrollbar {
	width: 8px;
	height: 8px;
}

::-webkit-scrollbar-button {
	width: 0px;
	height: 0px;
}

::-webkit-scrollbar-thumb {
	background: #6f6f6f;
	border: 0px solid;
}

	::-webkit-scrollbar-thumb:hover {
		background: #6f6f6f;
	}

	::-webkit-scrollbar-thumb:active {
		background: #5c5c5c;
	}

::-webkit-scrollbar-track {
	background: rgba(0, 0, 0, 0);
	border: 0px none #ffffff;
	border-radius: 53px;
}

::-webkit-scrollbar-corner {
	background: transparent;
}

a {
	color: #e6e6e6;
	font-weight: 700;
	font-size: 16px;
}

h1 {
	text-align: center;
	font-weight: 100;
}

h2 {
	font-weight: 400;
}

h4 {
	font-weight: 500;
}

a {
	font-weight: 400;
}

button {
	font-family: GothamPro;
}

input {
	font-family: GothamPro;
}

ul {
	list-style-type: none;
}

h3 {
	width: 96%;
	text-align: center;
	border-bottom: 2px solid #c0c0c010;
	line-height: 0.1em;
	margin-top: 20px;
	margin-bottom: 20px;
	margin: 2%;
}

	h3 span {
		background-color: var(--MainBg);
		padding: 0 10px;
	}


.headerBtt {
	background-color: #00000000;
	border-radius: 20px;
	padding: 5px;
	color: var(--mainUTxt);
	outline: none;
	border: none;
	cursor: pointer;
	margin-top: auto;
	margin-bottom: auto;
	transition: all 0.1s !important;
}

	.headerBtt:hover {
		color: var(--mainTxt);
	}

.OverlayPage {
	width: 100%;
	height: 100vh;
	position: absolute;
	top: 0;
	left: 0;
	background-color: #1212120F;
	z-index: 100;
}

.blur-on {
	/*	-webkit-filter: blur(5px);
	-moz-filter: blur(5px);
	-o-filter: blur(5px);
	-ms-filter: blur(5px);
	filter: blur(5px);*/
	-webkit-transition: all 1s linear;
	transition: all 1s linear;
	-moz-transition: all 1s linear;
	-webkit-transition: all 1s linear;
	-o-transition: all 1s linear;
}

.blur-off {
	-webkit-filter: blur(0px) !important;
	-moz-filter: blur(0px) !important;
	-o-filter: blur(0px) !important;
	-ms-filter: blur(0px) !important;
	filter: blur(0px) !important;
}

.showme {
	opacity: 0;
	display: none;
}

.showhim:hover .showme {
	opacity: 1;
	display: block;
}

.click-poster {
	cursor: pointer;
	margin: 6px;
	float: left;
	position: relative;
	left: 0;
	top: 0;
	color: #111;
	border: solid;
	box-shadow: 0px 8px 16px 0px rgba(0,0,0,1);
}

	.click-poster:hover {
		-webkit-transform: scale(0.99);
		scale: 0.99;
		/*opacity: 0.8;*/
		transition: opacity 0.05s linear;
		transition: scale 0.05s linear;
		transition: -webkit-transform 0.05s linear;
		/*
        border-radius: 0px;
        transition: border-color 0.05s linear;
        border-color: #e6e6e6;*/
	}

#img-background {
	background-color: #11131f; /*17181a;*/
	border: solid;
	border-color: transparent;
	background-repeat: no-repeat;
	background-size: cover;
	transition: background 0.7s linear;
	-webkit-transition: background 0.7s linear;
	height: 100vh;
	width: 100%;
	/*  border-radius: 5px;*/
	background-color: transparent;
	box-shadow: 0px 8px 16px 0px rgba(0,0,0,1);
}

	#img-background:hover {
		-webkit-transform: scale(0.99);
		scale: 0.99;
		/*opacity: 0.8;*/
		transition: opacity 0.05s linear;
		transition: scale 0.05s linear;
		transition: -webkit-transform 0.05s linear;
		/*
        border-radius: 0px;
        transition: border-color 0.05s linear;
        border-color: #e6e6e6;*/
	}

.bg {
	/* The image used */
	/* background-image: url("/img/mountBlur2.png");*/
	/*background-color: #111111;*/
	background-color: var(--mainBlueBG);
	/* Full height */
	height: 100%;
	/* Center and scale the image nicely */
	background-position: center;
	background-repeat: no-repeat;
	background-size: cover;
}

.grid-container {
	display: grid;
}

.grid-container--fill {
	grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
}

.Row {
	display: table;
	width: 100%; /*Optional*/
	table-layout: fixed; /*Optional*/
	border-spacing: 10px; /*Optional*/
}
.Column {
	display: table-cell;
}
#SearchBar {
	/*  backface-visibility: hidden;*/
	/*background-color: #22222222;*/
	/*background-color: #111111; */ /*#191919;*/
	/*color: #e6e6e6;*/
	background-color: #FFFFFF11;
	align-self: center;
	color: #e6e6e6;
	/* margin: 10px;*/
	/* border: solid;*/
	border-radius: 3px;
	border: solid;
	border-color: #e6e6e600;
	padding: 9px;
	margin-bottom: 2px;
	font-size: 16px;
	padding-left: 7px; /*35px; this is the offset of the text*/
	width: 50%;
	margin-left: 25%;
	margin-right: 25%;
	transition: border-radius 0.1s linear;
	-webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
	-moz-box-sizing: border-box; /* Firefox, other Gecko */
	box-sizing: border-box; /* Opera/IE 8+ */
	/*box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.3);*/
	transition: transform 0.1s linear;
}

	#SearchBar:focus {
		border-color: var(--whiteBorder);
	}

	#SearchBar:hover {
		/*
        border: solid;
        border-color: #e6e6e6;
        border-radius: 0px;*/
	}

.searchExpand {
	width: 90% !important;
	margin-left: 5% !important;
	transition: all 0.1s !important;
}

	.searchExpand:focus {
		width: 100% !important;
		margin-left: 0% !important;
		transition: all 0.1s !important;
	}


/*


    input:hover {
        border: thick;
        border-color:white;
        border-radius: 20px;
    }*/
/* input:hover {
         border-color: white;
        border-radius: 20px;
    }*/

::placeholder {
	color: gray;
	opacity: 1; /* Firefox */
}

:-ms-input-placeholder { /* Internet Explorer 10-11 */
	color: gray;
}

::-ms-input-placeholder { /* Microsoft Edge */
	color: gray;
}

#Top100Grid {
	transition: opacity 0.2s linear;
}

.genreBtt {
	backface-visibility: hidden;
	background-color: transparent;
	/*color: #e6e6e6;*/
	align-self: center;
	color: #e6e6e6;
	border-color: blue;
	background-color: #e6e6e611;
	margin: 1px;
	/* border: solid;*/
	border: solid;
	border-color: transparent;
	/*border-radius: 20px;*/
	width: auto;
	text-align: start;
	float: left;
	height: 40px;
	/*margin:0px;*/
	font-size: 16px;
	margin-right: 5px;
	transition: border-color 0.05s linear;
	-webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
	-moz-box-sizing: border-box; /* Firefox, other Gecko */
	box-sizing: border-box; /* Opera/IE 8+ */
	box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.5);
}

	.genreBtt:hover {
		border-radius: 0px;
		background-color: #e6e6e605;
		transition: background-color 0.05s linear;
		/*        transition: border-color 0.05s linear;
        border-color: #e6e6e6;*/
		/* transition: border-color 0.05s linear;*/
	}


.searchRes {
	cursor: pointer;
	/*
    background-color: #11111111;
    align-self: center;
    color: #e6e6e6;
    border-color: blue;
    border: solid;
    border-color: #e6e6e620;
    border-radius: 3px;
    padding: 9px;
    margin-bottom: 2px;
    font-size: 16px;
    padding-left: 7px; 
    width: 50%;
    margin-left: 25%;
    margin-right: 25%;*/
	/*
    width: 50%;
    margin-left: 25%;
    margin-right: 25%;*/
	width: 100%;
	backface-visibility: hidden;
	background-color: transparent;
	align-self: center;
	color: #e6e6e6;
	border-color: blue;
	background-color: #151515;
	margin-bottom: 2px;
	border: solid;
	border-color: transparent;
	border-radius: 0px;
	text-align: start;
	height: 70px;
	font-size: 16px;
	transition: border-color 0.05s linear;
	-webkit-box-sizing: border-box;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
	box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.3);
}

	.searchRes:hover {
		/* border-radius: 0px;
        transition: border-color 0.05s linear;
        border-color: #e6e6e6;*/
		/*-webkit-transform: scale(0.99);
		scale: 0.99;*/
		/* opacity: 0.8;*/
		background-color: #222;
		/*border-color:var(--whiteBorder);*/
		/*transition: opacity 0.05s linear;*/
		transition: scale 0.05s linear;
		transition: -webkit-transform 0.05s linear;
		/* transition: border-color 0.05s linear;*/
	}

	.searchRes:active {
		/*-webkit-transform: scale(0.99);
		scale: 0.99;*/
		/* opacity: 0.8;*/
		background-color: #111;
		transition: scale 0.05s linear;
		transition: -webkit-transform 0.05s linear;
	}
.searchResImg {
	height: 60px;
	width: 40px;
	border-radius: 0px;
	float: left;
	padding-right: 3px;
	scale: 1;
	transform: translatex(-6.1px);
}

.hold-poster {
	background-color: Transparent;
	background-repeat: no-repeat;
	border: none;
	cursor: pointer;
	outline: none;
}

	.hold-poster:hover {
		-webkit-transform: scale(0.99);
		scale: 0.99;
		opacity: 0.8;
		transition: opacity 0.05s linear;
		transition: scale 0.05s linear;
		transition: -webkit-transform 0.05s linear;
	}

#gridtype {
	display: grid;
	grid-template-columns: 0fr 1fr;
	list-style-type: none;
	grid-gap: 0px;
	position: relative;
	width: 50%;
	margin-left: auto;
	margin-right: auto;
}

.loadingBar {
	box-sizing: border-box;
	direction: ltr;
	position: relative;
	display: flex;
	flex-wrap: wrap;
	padding: 1px 2px;
	overflow: hidden;
	background-color: #161616; /*#303F9F #829eff;*/
	border-radius: 2px;
}

	.loadingBar::before {
		content: "";
		position: absolute;
		top: 0;
		right: 0;
		bottom: 0;
		left: 50%;
		z-index: 1;
		width: 500%;
		margin-left: -250%;
		-webkit-animation: phAnimation .8s linear infinite;
		animation: phAnimation .8s linear infinite;
		background: linear-gradient(90deg, hsla(0,0%,100%,0) 46%,#333 50%,hsla(0,0%,100%,0) 54%) 50% 50%;
	}

.loadingBarDereminate {
	box-sizing: border-box;
	direction: ltr;
	position: relative;
	display: flex;
	flex-wrap: wrap;
	padding: 1px 2px;
	overflow: hidden;
	background-color: #161616; 
	border-radius: 2px;
}

.loadingItem {
	box-sizing: border-box;
	direction: ltr;
	position: relative;
	display: flex;
	flex-wrap: wrap;
	/*padding: 3px 2px;*/
	overflow: hidden;
	margin-bottom: 10px;
	background-color: #222;
	border-radius: 2px;
}


	.loadingItem::before {
		content: "";
		position: absolute;
		top: 0;
		right: 0;
		bottom: 0;
		left: 50%;
		z-index: 1;
		width: 500%;
		margin-left: -250%;
		-webkit-animation: phAnimation .8s linear infinite;
		animation: phAnimation .8s linear infinite;
		background: linear-gradient(90deg, hsla(0,0%,100%,0) 46%,hsla(0,0%,100%,.35) 50%,hsla(0,0%,100%,0) 54%) 50% 50%;
	}

@-webkit-keyframes phAnimation {
	0% {
		transform: translate3d(-30%, 0, 0);
	}

	100% {
		transform: translate3d(30%, 0, 0);
	}
}

@keyframes phAnimation {
	0% {
		transform: translate3d(-30%, 0, 0);
	}

	100% {
		transform: translate3d(30%, 0, 0);
	}
}

/*VERY IMPORTANT OVERRIDES USER AGENT*/
:focus {
	outline-offset: 0px;
	outline: none;
}

.dropSel {
	cursor: pointer;
	background-color: transparent;
	/*color: #e6e6e6;*/
	align-self: center;
	color: #e6e6e6;
	/*background-color: #e6e6e611;*/
	/* border: solid;*/
	border: solid;
	border-color: transparent;
	/*border-radius: 20px;*/
	width: auto;
	height: 40px;
	width: 106px;
	text-align: center;
	/*margin:0px;*/
	font-size: 16px;
	margin-right: 5px;
	border-radius: 4px;
	transition: border-color 0.05s linear;
	-webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
	-moz-box-sizing: border-box; /* Firefox, other Gecko */
	box-sizing: border-box; /* Opera/IE 8+ */
}

	.dropSel:hover {
		background-color: #191919;
		transition: background-color 0.05s linear;
		/*        transition: border-color 0.05s linear;
        border-color: #e6e6e6;*/
	}


.dropbtn {
	background-color: transparent;
	/*color: #e6e6e6;*/
	align-self: center;
	color: #e6e6e6;
	background-color: #e6e6e611;
	margin: 1px;
	/* border: solid;*/
	border: solid;
	border-color: transparent;
	/*border-radius: 20px;*/
	width: auto;
	text-align: start;
	height: 40px;
	/*margin:0px;*/
	font-size: 16px;
	margin-right: 5px;
	transition: border-color 0.05s linear;
	-webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
	-moz-box-sizing: border-box; /* Firefox, other Gecko */
	box-sizing: border-box; /* Opera/IE 8+ */
}

	.dropbtn:hover {
		border-radius: 0px;
		background-color: #191919;
		transition: background-color 0.05s linear;
		/*        transition: border-color 0.05s linear;
        border-color: #e6e6e6;*/
	}


.dropdown {
	position: relative;
	display: inline-block;
}

.dropdown-content {
	display: none;
	position: center;
	align-self: center;
	border-radius: 5px;
	width: 106px;
	text-align: center;
	background-color: #222; /*#e6e6e611; */ /*background-color:#e6e6e611;*/
	/*min-width: 110px;*/
	box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.5);
	z-index: 1;
}

	.dropdown-content a {
		color: #e6e6e6;
		background-color: transparent;
		padding: 0px 0px;
		text-decoration: none;
		display: block;
	}

		.dropdown-content a:hover {
			border-radius: 9px;
			background-color: #222;
		}

.dropdown:hover .dropdown-content {
	display: block;
}

.EpisodeText {
	transition: color 0.2s linear;
}

.PlayEpisodes {
	background-color: transparent;
	transition: background-color 0.05s linear;
}

	.PlayEpisodes:hover {
		background-color: #333;
		box-shadow: 0 0 30px #000;
		transition: background-color 0.05s linear;
	}

.PlayButton {
	width: 45%;
	transition: width 0.2s linear;
}

	.PlayButton:hover {
		width: 50%;
		transition: width 0.2s linear;
	}

.SelectEpisodeImg {
	transition: width 0.2s linear;
}

	.SelectEpisodeImg:hover .overlay-effect {
		transition: width 0.2s linear;
	}


.overlay-effect {
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	right: 0;
	opacity: 0;
	transition: .5s ease;
	background-color: rgba(259, 67, 95, 0.7);
	overflow: hidden;
}

.sidenav {
	background-color: var(--mainBlackBg);
	height: 100%;
	width: 0;
	position: fixed;
	z-index: 1;
	top: 0;
	left: 0;
	overflow-x: hidden;
	transition: 0.5s;
	padding-top: 60px;
}

	.sidenav h4 {
		padding: 2px 2px 2px 32px;
	}

	.sidenav a {
		padding: 8px 8px 8px 10px;
		text-decoration: none;
		font-size: 15px;
		color: #FFF;
		display: block;
		transition: 0.3s;
		display: inline;
	}

	.sidenav img {
		width: 24px;
		margin-left: -10px;
		vertical-align: middle;
		/*filter: invert(90%)*/
	}

	.sidenav li {
		margin-top: 20px;
		margin-bottom: 20px;
		opacity: 0.6;
		transition: 0.3s;
		cursor:pointer;
	}
	 
	.sidenav li:hover {
		opacity:1;
	}

	 

/*

span {
    color: #e0e0e0;
    text-decoration: none;
    outline: none;
    transition: color .15s;
}

    span:hover, span:active {
        color: #FFFFFF;
    }

.btn-primary {
    color: #fff;
    background-color: #303F9F;
    border-color: transparent;
}

    .btn-primary:hover {
        color: #fff;
        background-color: #3c50d3;
        border-color: #fff;
    }*/



================================================
FILE: CloudStreamElectron/wwwroot/css/site.css
================================================
﻿ 

/*
     

a.navbar-brand {
  white-space: normal;
  text-align: center;
  word-break: break-all;
}
 
a {
  color: #0366d6;
}

.btn-primary {
  color: #fff;
  background-color: #1b6ec2;
  border-color: #1861ac;
}

.nav-pills .nav-link.active, .nav-pills .show > .nav-link {
  color: #fff;
  background-color: #1b6ec2;
  border-color: #1861ac;
}
 
html {
    font-size: 14px;
}
@media (min-width: 768px) {
  html {
    font-size: 16px;
  }
}

.border-top {
  border-top: 1px solid #e5e5e5;
}
.border-bottom {
  border-bottom: 1px solid #e5e5e5;
}

.box-shadow {
  box-shadow: 0 .25rem .75rem rgba(0, 0, 0, .05);
}

button.accept-policy {
  font-size: 1rem;
  line-height: inherit;
}
 
html {
    position: relative;
    min-height: 100%;
    background-color: #111111;
}

body {
   margin-bottom: 60px;
}
.footer {
  position: absolute;
  bottom: 0;
  width: 100%;
  white-space: nowrap;
  line-height: 60px;  
}
*/


================================================
FILE: CloudStreamElectron/wwwroot/js/jquery.animate-colors-min.js
================================================
﻿/*
 Color animation 1.6.0
 http://www.bitstorm.org/jquery/color-animation/
 Copyright 2011, 2013 Edwin Martin
 Released under the MIT and GPL licenses.
*/
'use strict';(function(d){function h(a,b,e){var c="rgb"+(d.support.rgba?"a":"")+"("+parseInt(a[0]+e*(b[0]-a[0]),10)+","+parseInt(a[1]+e*(b[1]-a[1]),10)+","+parseInt(a[2]+e*(b[2]-a[2]),10);d.support.rgba&&(c+=","+(a&&b?parseFloat(a[3]+e*(b[3]-a[3])):1));return c+")"}function f(a){var b;return(b=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/.exec(a))?[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),1]:(b=/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])/.exec(a))?[17*parseInt(b[1],16),17*parseInt(b[2],
16),17*parseInt(b[3],16),1]:(b=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(a))?[parseInt(b[1]),parseInt(b[2]),parseInt(b[3]),1]:(b=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9\.]*)\s*\)/.exec(a))?[parseInt(b[1],10),parseInt(b[2],10),parseInt(b[3],10),parseFloat(b[4])]:l[a]}d.extend(!0,d,{support:{rgba:function(){var a=d("script:first"),b=a.css("color"),e=!1;if(/^rgba/.test(b))e=!0;else try{e=b!=a.css("color","rgba(0, 0, 0, 0.5)").css("color"),
a.css("color",b)}catch(c){}return e}()}});var k="color backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor outlineColor".split(" ");d.each(k,function(a,b){d.Tween.propHooks[b]={get:function(a){return d(a.elem).css(b)},set:function(a){var c=a.elem.style,g=f(d(a.elem).css(b)),m=f(a.end);a.run=function(a){c[b]=h(g,m,a)}}}});d.Tween.propHooks.borderColor={set:function(a){var b=a.elem.style,e=[],c=k.slice(2,6);d.each(c,function(b,c){e[c]=f(d(a.elem).css(c))});var g=f(a.end);
a.run=function(a){d.each(c,function(d,c){b[c]=h(e[c],g,a)})}}};var l={aqua:[0,255,255,1],azure:[240,255,255,1],beige:[245,245,220,1],black:[0,0,0,1],blue:[0,0,255,1],brown:[165,42,42,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgrey:[169,169,169,1],darkgreen:[0,100,0,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkviolet:[148,0,211,1],fuchsia:[255,
0,255,1],gold:[255,215,0,1],green:[0,128,0,1],indigo:[75,0,130,1],khaki:[240,230,140,1],lightblue:[173,216,230,1],lightcyan:[224,255,255,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],magenta:[255,0,255,1],maroon:[128,0,0,1],navy:[0,0,128,1],olive:[128,128,0,1],orange:[255,165,0,1],pink:[255,192,203,1],purple:[128,0,128,1],violet:[128,0,128,1],red:[255,0,0,1],silver:[192,192,192,1],white:[255,255,255,1],yellow:[255,255,
0,1],transparent:[255,255,255,0]}})(jQuery);



================================================
FILE: CloudStreamElectron/wwwroot/js/site.js
================================================
﻿// Please see documentation at https://docs.microsoft.com/aspnet/core/client-side/bundling-and-minification
// for details on configuring this project to bundle and minify static web assets.

// Write your JavaScript code.



================================================
FILE: CloudStreamElectron/wwwroot/lib/bootstrap/LICENSE
================================================
The MIT License (MIT)

Copyright (c) 2011-2018 Twitter, Inc.
Copyright (c) 2011-2018 The Bootstrap Authors

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.



================================================
FILE: CloudStreamElectron/wwwroot/lib/jquery/LICENSE.txt
================================================
Copyright JS Foundation and other contributors, https://js.foundation/

This software consists of voluntary contributions made by many
individuals. For exact contribution history, see the revision history
available at https://github.com/jquery/jquery

The following license applies to all parts of this software except as
documented below:

====

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

====

All files located in the node_modules and external directories are
externally maintained libraries used by this software which have their
own licenses; we recommend you read them, as their terms may differ from
the terms above.



================================================
FILE: CloudStreamElectron/wwwroot/lib/jquery-validation/LICENSE.md
================================================
The MIT License (MIT)
=====================

Copyright Jörn Zaefferer

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.



================================================
FILE: CloudStreamElectron/wwwroot/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js
================================================
// Unobtrusive validation support library for jQuery and jQuery Validate
// Copyright (c) .NET Foundation. All rights reserved.
// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.
// @version v3.2.11

/*jslint white: true, browser: true, onevar: true, undef: true, nomen: true, eqeqeq: true, plusplus: true, bitwise: true, regexp: true, newcap: true, immed: true, strict: false */
/*global document: false, jQuery: false */

(function (factory) {
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define("jquery.validate.unobtrusive", ['jquery-validation'], factory);
    } else if (typeof module === 'object' && module.exports) {
        // CommonJS-like environments that support module.exports     
        module.exports = factory(require('jquery-validation'));
    } else {
        // Browser global
        jQuery.validator.unobtrusive = factory(jQuery);
    }
}(function ($) {
    var $jQval = $.validator,
        adapters,
        data_validation = "unobtrusiveValidation";

    function setValidationValues(options, ruleName, value) {
        options.rules[ruleName] = value;
        if (options.message) {
            options.messages[ruleName] = options.message;
        }
    }

    function splitAndTrim(value) {
        return value.replace(/^\s+|\s+$/g, "").split(/\s*,\s*/g);
    }

    function escapeAttributeValue(value) {
        // As mentioned on http://api.jquery.com/category/selectors/
        return value.replace(/([!"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])/g, "\\$1");
    }

    function getModelPrefix(fieldName) {
        return fieldName.substr(0, fieldName.lastIndexOf(".") + 1);
    }

    function appendModelPrefix(value, prefix) {
        if (value.indexOf("*.") === 0) {
            value = value.replace("*.", prefix);
        }
        return value;
    }

    function onError(error, inputElement) {  // 'this' is the form element
        var container = $(this).find("[data-valmsg-for='" + escapeAttributeValue(inputElement[0].name) + "']"),
            replaceAttrValue = container.attr("data-valmsg-replace"),
            replace = replaceAttrValue ? $.parseJSON(replaceAttrValue) !== false : null;

        container.removeClass("field-validation-valid").addClass("field-validation-error");
        error.data("unobtrusiveContainer", container);

        if (replace) {
            container.empty();
            error.removeClass("input-validation-error").appendTo(container);
        }
        else {
            error.hide();
        }
    }

    function onErrors(event, validator) {  // 'this' is the form element
        var container = $(this).find("[data-valmsg-summary=true]"),
            list = container.find("ul");

        if (list && list.length && validator.errorList.length) {
            list.empty();
            container.addClass("validation-summary-errors").removeClass("validation-summary-valid");

            $.each(validator.errorList, function () {
                $("<li />").html(this.message).appendTo(list);
            });
        }
    }

    function onSuccess(error) {  // 'this' is the form element
        var container = error.data("unobtrusiveContainer");

        if (container) {
            var replaceAttrValue = container.attr("data-valmsg-replace"),
                replace = replaceAttrValue ? $.parseJSON(replaceAttrValue) : null;

            container.addClass("field-validation-valid").removeClass("field-validation-error");
            error.removeData("unobtrusiveContainer");

            if (replace) {
                container.empty();
            }
        }
    }

    function onReset(event) {  // 'this' is the form element
        var $form = $(this),
            key = '__jquery_unobtrusive_validation_form_reset';
        if ($form.data(key)) {
            return;
        }
        // Set a flag that indicates we're currently resetting the form.
        $form.data(key, true);
        try {
            $form.data("validator").resetForm();
        } finally {
            $form.removeData(key);
        }

        $form.find(".validation-summary-errors")
            .addClass("validation-summary-valid")
            .removeClass("validation-summary-errors");
        $form.find(".field-validation-error")
            .addClass("field-validation-valid")
            .removeClass("field-validation-error")
            .removeData("unobtrusiveContainer")
            .find(">*")  // If we were using valmsg-replace, get the underlying error
            .removeData("unobtrusiveContainer");
    }

    function validationInfo(form) {
        var $form = $(form),
            result = $form.data(data_validation),
            onResetProxy = $.proxy(onReset, form),
            defaultOptions = $jQval.unobtrusive.options || {},
            execInContext = function (name, args) {
                var func = defaultOptions[name];
                func && $.isFunction(func) && func.apply(form, args);
            };

        if (!result) {
            result = {
                options: {  // options structure passed to jQuery Validate's validate() method
                    errorClass: defaultOptions.errorClass || "input-validation-error",
                    errorElement: defaultOptions.errorElement || "span",
                    errorPlacement: function () {
                        onError.apply(form, arguments);
                        execInContext("errorPlacement", arguments);
                    },
                    invalidHandler: function () {
                        onErrors.apply(form, arguments);
                        execInContext("invalidHandler", arguments);
                    },
                    messages: {},
                    rules: {},
                    success: function () {
                        onSuccess.apply(form, arguments);
                        execInContext("success", arguments);
                    }
                },
                attachValidation: function () {
                    $form
                        .off("reset." + data_validation, onResetProxy)
                        .on("reset." + data_validation, onResetProxy)
                        .validate(this.options);
                },
                validate: function () {  // a validation function that is called by unobtrusive Ajax
                    $form.validate();
                    return $form.valid();
                }
            };
            $form.data(data_validation, result);
        }

        return result;
    }

    $jQval.unobtrusive = {
        adapters: [],

        parseElement: function (element, skipAttach) {
            /// <summary>
            /// Parses a single HTML element for unobtrusive validation attributes.
            /// </summary>
            /// <param name="element" domElement="true">The HTML element to be parsed.</param>
            /// <param name="skipAttach" type="Boolean">[Optional] true to skip attaching the
            /// validation to the form. If parsing just this single element, you should specify true.
            /// If parsing several elements, you should specify false, and manually attach the validation
            /// to the form when you are finished. The default is false.</param>
            var $element = $(element),
                form = $element.parents("form")[0],
                valInfo, rules, messages;

            if (!form) {  // Cannot do client-side validation without a form
                return;
            }

            valInfo = validationInfo(form);
            valInfo.options.rules[element.name] = rules = {};
            valInfo.options.messages[element.name] = messages = {};

            $.each(this.adapters, function () {
                var prefix = "data-val-" + this.name,
                    message = $element.attr(prefix),
                    paramValues = {};

                if (message !== undefined) {  // Compare against undefined, because an empty message is legal (and falsy)
                    prefix += "-";

                    $.each(this.params, function () {
                        paramValues[this] = $element.attr(prefix + this);
                    });

                    this.adapt({
                        element: element,
                        form: form,
                        message: message,
                        params: paramValues,
                        rules: rules,
                        messages: messages
                    });
                }
            });

            $.extend(rules, { "__dummy__": true });

            if (!skipAttach) {
                valInfo.attachValidation();
            }
        },

        parse: function (selector) {
            /// <summary>
            /// Parses all the HTML elements in the specified selector. It looks for input elements decorated
            /// with the [data-val=true] attribute value and enables validation according to the data-val-*
            /// attribute values.
            /// </summary>
            /// <param name="selector" type="String">Any valid jQuery selector.</param>

            // $forms includes all forms in selector's DOM hierarchy (parent, children and self) that have at least one
            // element with data-val=true
            var $selector = $(selector),
                $forms = $selector.parents()
                    .addBack()
                    .filter("form")
                    .add($selector.find("form"))
                    .has("[data-val=true]");

            $selector.find("[data-val=true]").each(function () {
                $jQval.unobtrusive.parseElement(this, true);
            });

            $forms.each(function () {
                var info = validationInfo(this);
                if (info) {
                    info.attachValidation();
                }
            });
        }
    };

    adapters = $jQval.unobtrusive.adapters;

    adapters.add = function (adapterName, params, fn) {
        /// <summary>Adds a new adapter to convert unobtrusive HTML into a jQuery Validate validation.</summary>
        /// <param name="adapterName" type="String">The name of the adapter to be added. This matches the name used
        /// in the data-val-nnnn HTML attribute (where nnnn is the adapter name).</param>
        /// <param name="params" type="Array" optional="true">[Optional] An array of parameter names (strings) that will
        /// be extracted from the data-val-nnnn-mmmm HTML attributes (where nnnn is the adapter name, and
        /// mmmm is the parameter name).</param>
        /// <param name="fn" type="Function">The function to call, which adapts the values from the HTML
        /// attributes into jQuery Validate rules and/or messages.</param>
        /// <returns type="jQuery.validator.unobtrusive.adapters" />
        if (!fn) {  // Called with no params, just a function
            fn = params;
            params = [];
        }
        this.push({ name: adapterName, params: params, adapt: fn });
        return this;
    };

    adapters.addBool = function (adapterName, ruleName) {
        /// <summary>Adds a new adapter to convert unobtrusive HTML into a jQuery Validate validation, where
        /// the jQuery Validate validation rule has no parameter values.</summary>
        /// <param name="adapterName" type="String">The name of the adapter to be added. This matches the name used
        /// in the data-val-nnnn HTML attribute (where nnnn is the adapter name).</param>
        /// <param name="ruleName" type="String" optional="true">[Optional] The name of the jQuery Validate rule. If not provided, the value
        /// of adapterName will be used instead.</param>
        /// <returns type="jQuery.validator.unobtrusive.adapters" />
        return this.add(adapterName, function (options) {
            setValidationValues(options, ruleName || adapterName, true);
        });
    };

    adapters.addMinMax = function (adapterName, minRuleName, maxRuleName, minMaxRuleName, minAttribute, maxAttribute) {
        /// <summary>Adds a new adapter to convert unobtrusive HTML into a jQuery Validate validation, where
        /// the jQuery Validate validation has three potential rules (one for min-only, one for max-only, and
        /// one for min-and-max). The HTML parameters are expected to be named -min and -max.</summary>
        /// <param name="adapterName" type="String">The name of the adapter to be added. This matches the name used
        /// in the data-val-nnnn HTML attribute (where nnnn is the adapter name).</param>
        /// <param name="minRuleName" type="String">The name of the jQuery Validate rule to be used when you only
        /// have a minimum value.</param>
        /// <param name="maxRuleName" type="String">The name of the jQuery Validate rule to be used when you only
        /// have a maximum value.</param>
        /// <param name="minMaxRuleName" type="String">The name of the jQuery Validate rule to be used when you
        /// have both a minimum and maximum value.</param>
        /// <param name="minAttribute" type="String" optional="true">[Optional] The name of the HTML attribute that
        /// contains the minimum value. The default is "min".</param>
        /// <param name="maxAttribute" type="String" optional="true">[Optional] The name of the HTML attribute that
        /// contains the maximum value. The default is "max".</param>
        /// <returns type="jQuery.validator.unobtrusive.adapters" />
        return this.add(adapterName, [minAttribute || "min", maxAttribute || "max"], function (options) {
            var min = options.params.min,
                max = options.params.max;

            if (min && max) {
                setValidationValues(options, minMaxRuleName, [min, max]);
            }
            else if (min) {
                setValidationValues(options, minRuleName, min);
            }
            else if (max) {
                setValidationValues(options, maxRuleName, max);
            }
        });
    };

    adapters.addSingleVal = function (adapterName, attribute, ruleName) {
        /// <summary>Adds a new adapter to convert unobtrusive HTML into a jQuery Validate validation, where
        /// the jQuery Validate validation rule has a single value.</summary>
        /// <param name="adapterName" type="String">The name of the adapter to be added. This matches the name used
        /// in the data-val-nnnn HTML attribute(where nnnn is the adapter name).</param>
        /// <param name="attribute" type="String">[Optional] The name of the HTML attribute that contains the value.
        /// The default is "val".</param>
        /// <param name="ruleName" type="String" optional="true">[Optional] The name of the jQuery Validate rule. If not provided, the value
        /// of adapterName will be used instead.</param>
        /// <returns type="jQuery.validator.unobtrusive.adapters" />
        return this.add(adapterName, [attribute || "val"], function (options) {
            setValidationValues(options, ruleName || adapterName, options.params[attribute]);
        });
    };

    $jQval.addMethod("__dummy__", function (value, element, params) {
        return true;
    });

    $jQval.addMethod("regex", function (value, element, params) {
        var match;
        if (this.optional(element)) {
            return true;
        }

        match = new RegExp(params).exec(value);
        return (match && (match.index === 0) && (match[0].length === value.length));
    });

    $jQval.addMethod("nonalphamin", function (value, element, nonalphamin) {
        var match;
        if (nonalphamin) {
            match = value.match(/\W/g);
            match = match && match.length >= nonalphamin;
        }
        return match;
    });

    if ($jQval.methods.extension) {
        adapters.addSingleVal("accept", "mimtype");
        adapters.addSingleVal("extension", "extension");
    } else {
        // for backward compatibility, when the 'extension' validation method does not exist, such as with versions
        // of JQuery Validation plugin prior to 1.10, we should use the 'accept' method for
        // validating the extension, and ignore mime-type validations as they are not supported.
        adapters.addSingleVal("extension", "extension", "accept");
    }

    adapters.addSingleVal("regex", "pattern");
    adapters.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url");
    adapters.addMinMax("length", "minlength", "maxlength", "rangelength").addMinMax("range", "min", "max", "range");
    adapters.addMinMax("minlength", "minlength").addMinMax("maxlength", "minlength", "maxlength");
    adapters.add("equalto", ["other"], function (options) {
        var prefix = getModelPrefix(options.element.name),
            other = options.params.other,
            fullOtherName = appendModelPrefix(other, prefix),
            element = $(options.form).find(":input").filter("[name='" + escapeAttributeValue(fullOtherName) + "']")[0];

        setValidationValues(options, "equalTo", element);
    });
    adapters.add("required", function (options) {
        // jQuery Validate equates "required" with "mandatory" for checkbox elements
        if (options.element.tagName.toUpperCase() !== "INPUT" || options.element.type.toUpperCase() !== "CHECKBOX") {
            setValidationValues(options, "required", true);
        }
    });
    adapters.add("remote", ["url", "type", "additionalfields"], function (options) {
        var value = {
            url: options.params.url,
            type: options.params.type || "GET",
            data: {}
        },
            prefix = getModelPrefix(options.element.name);

        $.each(splitAndTrim(options.params.additionalfields || options.element.name), function (i, fieldName) {
            var paramName = appendModelPrefix(fieldName, prefix);
            value.data[paramName] = function () {
                var field = $(options.form).find(":input").filter("[name='" + escapeAttributeValue(paramName) + "']");
                // For checkboxes and radio buttons, only pick up values from checked fields.
                if (field.is(":checkbox")) {
                    return field.filter(":checked").val() || field.filter(":hidden").val() || '';
                }
                else if (field.is(":radio")) {
                    return field.filter(":checked").val() || '';
                }
                return field.val();
            };
        });

        setValidationValues(options, "remote", value);
    });
    adapters.add("password", ["min", "nonalphamin", "regex"], function (options) {
        if (options.params.min) {
            setValidationValues(options, "minlength", options.params.min);
        }
        if (options.params.nonalphamin) {
            setValidationValues(options, "nonalphamin", options.params.nonalphamin);
        }
        if (options.params.regex) {
            setValidationValues(options, "regex", options.params.regex);
        }
    });
    adapters.add("fileextensions", ["extensions"], function (options) {
        setValidationValues(options, "extension", options.params.extensions);
    });

    $(function () {
        $jQval.unobtrusive.parse(document);
    });

    return $jQval.unobtrusive;
}));



================================================
FILE: CloudStreamElectron/wwwroot/lib/jquery-validation-unobtrusive/LICENSE.txt
================================================
Copyright (c) .NET Foundation. All rights reserved.

Licensed under the Apache License, Version 2.0 (the "License"); you may not use
these files except in compliance with the License. You may obtain a copy of the
License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed
under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the License for the
specific language governing permissions and limitations under the License.



================================================
FILE: CloudStreamElectron/.config/dotnet-tools.json
================================================
{
  "version": 1,
  "isRoot": true,
  "tools": {
    "dotnet-ef": {
      "version": "3.1.5",
      "commands": [
        "dotnet-ef"
      ]
    }
  }
}

